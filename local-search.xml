<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/index/"/>
    <url>/2021/01/10/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>查询某网站某数据的简单实现 | 水风车的博客</title><meta name="keywords" content="Python,云函数,爬虫"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="用 Python 爬虫获取网站数据。"><meta property="og:type" content="article"><meta property="og:title" content="查询某网站某数据的简单实现"><meta property="og:url" content="https://blog.shuifengche.top/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="用 Python 爬虫获取网站数据。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><meta property="article:published_time" content="2020-11-04T13:40:17.000Z"><meta property="article:modified_time" content="2020-11-04T13:43:06.644Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="Python"><meta property="article:tag" content="云函数"><meta property="article:tag" content="爬虫"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2020-11-04 21:43:06'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0"><span class="toc-number">1.</span> <span class="toc-text">查询某网站某数据的简单实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%A8-Python-%E8%8E%B7%E5%8F%96%E6%9F%90%E6%96%B0%E9%97%BB%E7%BD%91%E7%AB%99%E9%80%89%E7%A5%A8%E6%95%B0%E6%8D%AE"><span class="toc-number">1.0.1.</span> <span class="toc-text">用 Python 获取某新闻网站选票数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Alfred-workflow-%E5%BF%AB%E6%8D%B7%E8%BF%90%E8%A1%8C%E5%B9%B6%E8%8E%B7%E5%8F%96%E7%BB%93%E6%9E%9C"><span class="toc-number">1.0.2.</span> <span class="toc-text">使用 Alfred workflow 快捷运行并获取结果</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Server%E9%85%B1-%E5%AE%9E%E7%8E%B0%E5%BE%AE%E4%BF%A1%E6%9C%8D%E5%8A%A1%E5%8F%B7%E9%80%9A%E7%9F%A5"><span class="toc-number">1.0.3.</span> <span class="toc-text">使用 Server酱 实现微信服务号通知</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%85%BE%E8%AE%AF%E4%BA%91%E5%87%BD%E6%95%B0%E5%AE%9E%E7%8E%B0%E5%AE%9A%E6%97%B6%E6%9F%A5%E8%AF%A2%E5%92%8C%E5%8F%98%E5%8A%A8%E6%8F%90%E9%86%92%EF%BC%88%E5%A4%B1%E8%B4%A5%E5%B0%9D%E8%AF%95%EF%BC%89"><span class="toc-number">1.0.4.</span> <span class="toc-text">腾讯云函数实现定时查询和变动提醒（失败尝试）</span></a></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">查询某网站某数据的简单实现</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2020-11-04T13:40:17.000Z" title="undefined 2020-11-04 21:40:17">2020-11-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>4分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="查询某网站某数据的简单实现"><a href="#查询某网站某数据的简单实现" class="headerlink" title="查询某网站某数据的简单实现"></a>查询某网站某数据的简单实现</h1><blockquote><p>今天美国大选，为了实时获取懂王和睡王的选票数量，我决定写一个简单的 Python 爬虫。</p></blockquote><h3 id="用-Python-获取某新闻网站选票数据"><a href="#用-Python-获取某新闻网站选票数据" class="headerlink" title="用 Python 获取某新闻网站选票数据"></a>用 Python 获取某新闻网站选票数据</h3><p>这里要用到 requests 和 bs4 包，具体代码如下：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取该网站 html 的字节码</span></span><br><span class="line">r = requests.get(<span class="string">&quot;https://www.foxnews.com/elections/2020/general-results&quot;</span>)</span><br><span class="line">text = r.text<span class="comment"># bytes-&gt;str</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用 BeautifulSoup 把该 html 文本转变为复杂的树型结构，便于后续提取特定网页元素</span></span><br><span class="line">soup = BeautifulSoup(text, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取选票数据，这里需要在浏览器中审查元素，使用目标数据的具体 class 等信息进行提取</span></span><br><span class="line">biden = soup.select(<span class="string">&#x27;.count&#x27;</span>)[<span class="number">0</span>].text</span><br><span class="line">trump = soup.select(<span class="string">&#x27;.count&#x27;</span>)[<span class="number">1</span>].text</span><br><span class="line"></span><br><span class="line">print(<span class="string">&quot;当前选票 拜登 &quot;</span> + biden + <span class="string">&#x27; : 川普 &#x27;</span> + trump)</span><br></pre></td></tr></table></figure><h3 id="使用-Alfred-workflow-快捷运行并获取结果"><a href="#使用-Alfred-workflow-快捷运行并获取结果" class="headerlink" title="使用 Alfred workflow 快捷运行并获取结果"></a>使用 Alfred workflow 快捷运行并获取结果</h3><p>macOS 上的著名的小黑帽——Alfred，前两天才开始使用。<br>同类型的还有国产的 utools，UI 更美观，已提供的功能插件也很丰富，但是开发插件需要前端知识，不太适合我这种前端小白。</p><p>workflow：</p><ul><li>设置启动热键。</li><li>执行上面特定的 py 文件。</li><li>执行结果通过 macOS 通知推送。</li></ul><h3 id="使用-Server酱-实现微信服务号通知"><a href="#使用-Server酱-实现微信服务号通知" class="headerlink" title="使用 Server酱 实现微信服务号通知"></a>使用 Server酱 实现微信服务号通知</h3><p>1、打开网站 <a target="_blank" rel="noopener" href="http://sc.ftqq.com/">Server酱</a>，使用 Github 进行注册。<br>2、绑定自己的微信账号。<br>3、查看自己的 SCKey。</p><p>用 Server酱 实现通知也很简单，只需要执行以代码即可：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">requests.get(<span class="string">&quot;https://sc.ftqq.com/[你自己的SCkey].send?text=[blablablabla]&quot;</span>)</span><br></pre></td></tr></table></figure><p>Server酱可以接受两个参数：</p><ul><li>text：消息标题，最长为256，必填。</li><li>desp：消息内容，最长64Kb，可空，支持MarkDown。</li></ul><p>把要推送的信息放在 text 或者 desp 里即可。</p><h3 id="腾讯云函数实现定时查询和变动提醒（失败尝试）"><a href="#腾讯云函数实现定时查询和变动提醒（失败尝试）" class="headerlink" title="腾讯云函数实现定时查询和变动提醒（失败尝试）"></a>腾讯云函数实现定时查询和变动提醒（失败尝试）</h3><p>上面的部分仅能够快速执行代码并获取通知，每隔一会儿我就试一次，在接受过好多次「拜登 238：川普 213」之后，我决定让它每五分钟爬一次，数据有变化再提醒我。</p><p>有以下几种选择：</p><ul><li>在自己的电脑上设置定时任务，需要一直开机+联网，不太现实。</li><li>在自己的服务器上设置定时任务。效果应该很好，不过我的服务器已经到期了。</li><li>选择某些云服务商提供的云函数。</li></ul><p>我采用了腾讯云函数，看了看每日免费调用次数是妥妥的够用。<br>（一直在用腾讯云函数进行每日的 WPS 自动签到）</p><p>下面是完整的云函数文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf8 -*-</span></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main_handler</span>(<span class="params">arg1,arg2</span>):</span></span><br><span class="line">    r = requests.get(<span class="string">&quot;https://www.foxnews.com/elections/2020/general-results&quot;</span>)</span><br><span class="line">    text = r.text</span><br><span class="line">    soup = BeautifulSoup(text, <span class="string">&quot;html.parser&quot;</span>)</span><br><span class="line">    biden = soup.select(<span class="string">&#x27;.count&#x27;</span>)[<span class="number">0</span>].text</span><br><span class="line">    trump = soup.select(<span class="string">&#x27;.count&#x27;</span>)[<span class="number">1</span>].text</span><br><span class="line">    b = <span class="number">0</span></span><br><span class="line">    t = <span class="number">0</span></span><br><span class="line">    <span class="keyword">with</span> open(<span class="string">&#x27;data.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():</span><br><span class="line">            line = line.split(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">            b = int(line[<span class="number">0</span>])</span><br><span class="line">            t = int(line[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">if</span> b != biden <span class="keyword">or</span> t != trump:</span><br><span class="line">        txt = <span class="string">&quot;https://sc.ftqq.com/[我的SCKey].send?text=拜登&quot;</span> + biden + <span class="string">&quot;川普&quot;</span> + trump</span><br><span class="line">        requests.get(txt)</span><br><span class="line">        <span class="keyword">with</span> open(<span class="string">&#x27;data.txt&#x27;</span>,<span class="string">&#x27;w&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">            f.write(str(biden) + <span class="string">&#x27; &#x27;</span> + str(trump))</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;yes&quot;</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;no&quot;</span></span><br></pre></td></tr></table></figure><p>1、使用一个 <code>data.txt</code>  保存数据，只有发现数据更新时才会调用 Server酱推送提醒。<br>2、腾讯云函数内置了 requests 包，但没有 bs4 包，需要自己生成本地文件打包上传。</p><p>测试代码时报错，发现 <code>data.txt</code> 文件为只读。</p><p>到这里才发现一个重大问题：<strong>腾讯云函数环境内部没有可以长期存储的可读写空间！！</strong></p><p>查了一下官方文档：</p><blockquote><p>Q：环境内有可写空间吗？</p></blockquote><blockquote><p>A：有。云函数在执行过程中，都拥有一块500MB的临时磁盘空间 <code>/tmp</code>，用户可以在执行代码时对该空间进行一些读写操作，也可以创建子目录，但这部分数据在函数执行完成后不会保留。</p></blockquote><blockquote><p>说明：</p><ul><li>实例间的临时空间互相隔离，不共享，即每个实例均有独立的临时空间。</li><li>运行环境内除 <code>/tmp</code> 目录下，_<strong>其他均限制为只读</strong>_。</li></ul></blockquote><p>而后我又尝试了同类产品阿里函数计算，依然不允许对文件进行写操作。</p><p>基本上要放弃了。<br>发现可以通过七牛云的对象存储进行「曲线救国」（真折腾人啊）。<br>有空了试一试。（为什么云函数这么多限制啊……还是自己的服务器好）</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/">https://blog.shuifengche.top/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Python/">Python</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E5%87%BD%E6%95%B0/">云函数</a><a class="post-meta__tags" href="/tags/%E7%88%AC%E8%99%AB/">爬虫</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="next-post pull-full"><a href="/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/"><img class="next-cover" src="http://cdn.shuifengche.top/timg.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">全平台同步，很难吗？</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/index/"/>
    <url>/2021/01/10/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>全平台同步，很难吗？ | 水风车的博客</title><meta name="keywords" content="系统,macOS,云同步"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="全平台同步经验分享。"><meta property="og:type" content="article"><meta property="og:title" content="全平台同步，很难吗？"><meta property="og:url" content="https://blog.shuifengche.top/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="全平台同步经验分享。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/timg.jpeg"><meta property="article:published_time" content="2020-07-04T04:00:00.000Z"><meta property="article:modified_time" content="2020-07-04T03:58:40.001Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="系统"><meta property="article:tag" content="macOS"><meta property="article:tag" content="云同步"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/timg.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2020-07-04 11:58:40'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F"><span class="toc-number">1.</span> <span class="toc-text">全平台同步，很难吗？</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%B7%E5%9B%A0%EF%BC%9A%E5%AE%89%E5%8D%93%E4%B8%8E%E8%8B%B9%E6%9E%9C%E7%94%9F%E6%80%81%E7%9A%84%E5%86%B2%E7%AA%81"><span class="toc-number">1.1.</span> <span class="toc-text">起因：安卓与苹果生态的冲突</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%B8%8E%E6%96%B9%E6%A1%88%E5%88%86%E6%9E%90"><span class="toc-number">1.2.</span> <span class="toc-text">问题与方案分析</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B7%E4%BD%93%E8%A7%A3%E5%86%B3"><span class="toc-number">1.3.</span> <span class="toc-text">具体解决</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E6%97%A5%E5%8E%86"><span class="toc-number">1.3.1.</span> <span class="toc-text">1、日历</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%A4%87%E5%BF%98%E5%BD%95-%E4%BE%BF%E7%AD%BE"><span class="toc-number">1.3.2.</span> <span class="toc-text">2、备忘录&#x2F;便签</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%BE%85%E5%8A%9E-%E6%8F%90%E9%86%92%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.3.3.</span> <span class="toc-text">3、待办&#x2F;提醒事项</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%96%87%E6%A1%A3-%E8%B5%84%E6%BA%90"><span class="toc-number">1.3.4.</span> <span class="toc-text">4、文档&#x2F;资源</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%AA%E6%9D%A5%E4%BA%A7%E5%93%81%E9%80%89%E6%8B%A9"><span class="toc-number">1.4.</span> <span class="toc-text">未来产品选择</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/timg.jpeg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">全平台同步，很难吗？</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2020-07-04T04:00:00.000Z" title="undefined 2020-07-04 12:00:00">2020-07-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.5k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>4分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="全平台同步，很难吗？"><a href="#全平台同步，很难吗？" class="headerlink" title="全平台同步，很难吗？"></a>全平台同步，很难吗？</h1><p><a name="uhE9P"></a></p><h2 id="起因：安卓与苹果生态的冲突"><a href="#起因：安卓与苹果生态的冲突" class="headerlink" title="起因：安卓与苹果生态的冲突"></a>起因：安卓与苹果生态的冲突</h2><p><br />作为一个苹果全家桶用户，前几日把所有设备都更新到开发者测试版，而后 iOS 上的一些软件出现闪退 bug，一直未修复，同时因为小 6s 也时日不多了，我决定先换回安卓一段时间。<br /><br><br />在信号、续航、可玩性性有了大幅提高的体验的同时，我也丢失了以往的便捷，主要有以下两点：<br />1、日历提醒。<br />小米日历app并没有导入 cal 的功能，更不用说，我要求的同步 iCloud 日历的功能了。<br />2、备忘录/便签。<br />在更早些时间，我使用锤子便签。它有安卓端、iOS端以及网页端，能够满足我的需求，但迫于对锤子科技公司的不信任（怕它倒闭，突然关闭云服务），我只好换回了苹果自带的备忘录。<br />然而现在，我换到安卓之后，随手记录的 app 没了。<br /></p><p><a name="U20WD"></a></p><h2 id="问题与方案分析"><a href="#问题与方案分析" class="headerlink" title="问题与方案分析"></a>问题与方案分析</h2><p><br />主要问题在于，不同平台的软件有各自的独立性。<br />解决 A 与 B 冲突问题的办法：<br />1、A、B 之间某一方或者双方提供兼容服务。<br />2、A 与 C 兼容，B 与 C 兼容。C 可能是第三方平台，也可能是某一标准、协议。<br /></p><p><a name="sdT6v"></a></p><h2 id="具体解决"><a href="#具体解决" class="headerlink" title="具体解决"></a>具体解决</h2><p><a name="CHY5c"></a></p><h3 id="1、日历"><a href="#1、日历" class="headerlink" title="1、日历"></a>1、日历</h3><p><br />以 Gmail、Outlook 为代表的邮件服务商有全平台的客户端，一般都支持通讯录、日程、邮件的同步。<br />但 Gmail 国内无法使用，同时在我的日常使用中，微软产品的访问速度很慢，尤其是网页端 Outlook。<br /><br><br />因此我最终选择了 QQ 邮箱。<br />QQ 邮箱有通讯录、日程、邮件、备忘录四种功能。<br /><br><br />iPhone/iPad：<br />在系统设置的邮件中增加 QQ 邮箱账户，选择 STMP 服务，可以自动把 QQ 邮箱中的邮件、备忘录同步到系统邮件 app 和备忘录 app中。<br />同时，再添加 QQ 邮箱的 CALDAV 服务，可以自动把 QQ 邮箱中的日程、提醒事项同步到系统日历 app、提醒事项 app 中。<br /><br><br />macOS：<br />在系统偏好设置中的互联网账户功能一栏，增加 QQ 邮箱账户，可以自动同步邮件、日程、备忘录、通讯录。<br /><br><br />安卓（MIUI）：<br />在邮件 app 中添加 QQ 邮箱，可以自动同步邮件、通讯录、日程。<br /><br><br />Win10：<br />我没有设备尝试，不过应该与上面几个的方法一样。<br /><br><br />这样就能够实现日历的全平台的同步，该日历的具体数据实际上存储在 QQ 邮箱的服务器上，每个终端设备都可以接入该数据，读取和写入。<br /></p><p><a name="NYPlA"></a></p><h3 id="2、备忘录-便签"><a href="#2、备忘录-便签" class="headerlink" title="2、备忘录/便签"></a>2、备忘录/便签</h3><p><br />我并没有找到完美的方案。<br />以下是几种仍有缺点的解决办法：<br />a、锤子便签<br />有安卓、iOS、网页端，没有 Win/Mac 客户端，不过可以用 PWA 代替，但是随时担心锤子云服务倒闭。<br />b、WPS便签<br />有安卓、网页端，没有 iOS/Win/Mac 客户端，虽然 WPS 内嵌了便签和日历，但还是比不上独立 app。<br />c、苹果备忘录<br />苹果全家桶使用很好，网页端速度慢，Win/安卓基本无法使用。<br />d、QQ 邮箱记事本<br />内嵌在 QQ 邮箱 app 中，支持安卓、iOS以及网页端，可以直接接入苹果备忘录 app。<br />致命缺点：苹果备忘录中的待办清单与 QQ 邮箱中的待办清单不兼容。<br /></p><p><a name="LZUuR"></a></p><h3 id="3、待办-提醒事项"><a href="#3、待办-提醒事项" class="headerlink" title="3、待办/提醒事项"></a>3、待办/提醒事项</h3><p><br />微软待办，免费，全平台，可直接通过 Outlook 账户接入苹果的提醒事项 app，功能对我来说够用。<br />滴答清单也不错，免费版凑合，付费有点贵。<br /></p><p><a name="qQFLw"></a></p><h3 id="4、文档-资源"><a href="#4、文档-资源" class="headerlink" title="4、文档/资源"></a>4、文档/资源</h3><p><br />WPS、iCloud/坚果云以及百度网盘。<br /><br><br />我最喜欢的是 WPS 的<del>白嫖会员</del>全平台云同步功能，其实 WPS 就像一个文档功能增强、文件格式减少的坚果云。<br />我把我所有学习生活中用到的文档、表格、ppt 以及 pdf 都存放在 WPS 的云空间里，我可以在我任何设备上直接下载并打开这些文件，iPad 上还可以进行 pdf 批注。<br /><br><br />把 WPS 能处理的文件去掉之后，基本就没啥了。<br />代码、md、压缩包之类的直接用 iCloud 就同步了，因为又开始用安卓了，所以这部分内容换成坚果云同步了，也没剩多少东西了，免费版够用。<br /><br><br />百度网盘则存放一些必要的备份，以及平时要看的网课视频。我一个常年白嫖用户，也就在线看视频这个功能还能正常使用吧。<br /></p><p><a name="Td4Y7"></a></p><h2 id="未来产品选择"><a href="#未来产品选择" class="headerlink" title="未来产品选择"></a>未来产品选择</h2><p><br />仅仅是把手机从 iPhone 换成安卓我就遇到这么多问题，以后最好还是不要被生态绑架吧。<br />其实谷歌、微软的产品很多都能打破终端设备的壁垒，奈何一个用不了，一个速度慢。<br />我还有点希望腾讯或者阿里能搞出一个类似的产品呢，最好是那种同一账号但相互独立的产品，比如XX日历、XX待办、XX地图、XX照片。国内的巨头们似乎都有做，但做的不全，有时候还把一个个独立的产品做得太商业化了。<br />跑题了。<br /><br><br />未来产品的选择：<br />软件大厂服务器全平台同步 &gt; 软件小厂服务器全平台同步 &gt; 手机厂商同步但独占 app &gt; 不同步但可导入导出本地 app &gt; 同步但不支持导入导出 app &gt; 不同步且不支持导入导出 app<br /><br><br />数据云存储与可导入导出真的很重要，我曾经因为换记账 app 导致原来的数据全部丢失。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/">https://blog.shuifengche.top/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%B3%BB%E7%BB%9F/">系统</a><a class="post-meta__tags" href="/tags/macOS/">macOS</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E5%90%8C%E6%AD%A5/">云同步</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/timg.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/11/04/%E6%9F%A5%E8%AF%A2%E6%9F%90%E7%BD%91%E7%AB%99%E6%9F%90%E6%95%B0%E6%8D%AE%E7%9A%84%E7%AE%80%E5%8D%95%E5%AE%9E%E7%8E%B0/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">查询某网站某数据的简单实现</div></div></a></div><div class="next-post pull-right"><a href="/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/"><img class="next-cover" src="http://cdn.shuifengche.top/pnp.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">P、NP与NPC问题的一些思考</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/09/07/Win-to-go踩坑之旅/" title="Win to go踩坑之旅"><img class="cover" src="http://cdn.shuifengche.top/wintogo.jpeg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-07</div><div class="title">Win to go踩坑之旅</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/index/"/>
    <url>/2021/01/10/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>P、NP与NPC问题的一些思考 | 水风车的博客</title><meta name="keywords" content="NP问题,计算数学,算法"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="最近在这方面遇到了三个问题。"><meta property="og:type" content="article"><meta property="og:title" content="P、NP与NPC问题的一些思考"><meta property="og:url" content="https://blog.shuifengche.top/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="最近在这方面遇到了三个问题。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/pnp.jpg"><meta property="article:published_time" content="2020-05-30T07:20:00.000Z"><meta property="article:modified_time" content="2020-05-30T07:41:21.804Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="NP问题"><meta property="article:tag" content="计算数学"><meta property="article:tag" content="算法"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/pnp.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2020-05-30 15:41:21'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#P%E3%80%81NP%E4%B8%8ENPC%E9%97%AE%E9%A2%98%E7%9A%84%E4%B8%80%E4%BA%9B%E6%80%9D%E8%80%83"><span class="toc-number">1.</span> <span class="toc-text">P、NP与NPC问题的一些思考</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%8F%E4%BE%BF%E8%AF%B4%E7%82%B9"><span class="toc-number">1.1.</span> <span class="toc-text">随便说点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89%E7%A7%8D%E9%97%AE%E9%A2%98%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-number">1.2.</span> <span class="toc-text">三种问题的定义</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.</span> <span class="toc-text">我遇到的问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98-1%EF%BC%9A%E5%BD%92%E7%BA%A6%E7%9A%84%E6%96%B9%E5%90%91%E4%B8%8E-NPC-%E9%97%AE%E9%A2%98%E7%9A%84%E8%AF%81%E6%98%8E"><span class="toc-number">1.3.1.</span> <span class="toc-text">问题 1：归约的方向与 NPC 问题的证明</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98-2%EF%BC%9A%E4%BC%AA%E6%9C%80%E5%A4%A7%E5%9B%A2%E4%B8%8E%E6%9C%80%E5%A4%A7%E5%9B%A2%E9%97%AE%E9%A2%98%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">1.3.2.</span> <span class="toc-text">问题 2：伪最大团与最大团问题的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98-3%EF%BC%9A%E4%BC%AA%E5%A4%9A%E9%A1%B9%E5%BC%8F%E6%97%B6%E9%97%B4"><span class="toc-number">1.3.3.</span> <span class="toc-text">问题 3：伪多项式时间</span></a></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/pnp.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">P、NP与NPC问题的一些思考</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2020-05-30T07:20:00.000Z" title="undefined 2020-05-30 15:20:00">2020-05-30</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="P、NP与NPC问题的一些思考"><a href="#P、NP与NPC问题的一些思考" class="headerlink" title="P、NP与NPC问题的一些思考"></a>P、NP与NPC问题的一些思考</h1><h2 id="随便说点"><a href="#随便说点" class="headerlink" title="随便说点"></a>随便说点</h2><p><br />好久没写文章了，眼看今年就快过去一半了。<br />上次发的博客还是凑数的课程实验报告，笑。<br />今年上半年因为疫情原因，在家呆了好几个月，这学期学校也不准备开学了。<br />在学校，尤其是机房、教学楼和图书馆，有学习的氛围，周围的人都在学习，你会不由自主地也沉迷学习中。<br />然而在家就不一样了，效率完全看个人自控能力，像我这种控制不住就刷上b站知乎了的，这个学期的学习质量堪忧。唯一有点长处的是，这学期认真的记了笔记，放在了语雀上。<br />以后笔记都在语雀上了，服务器上的笔记网站就要关掉了。<br />服务器的乐趣就是折腾，我也折腾过不少，现在看来服务器对我还不是刚需。所以今年到期后可能就不再租了，同时博客应该会挂在 coding 或者 github pages 上，访问速度可能会有所下降，不过影响不大，反正大部分访问量都是我自己。<br /><br><br />跑题了，拐回来。<br />我为什么会选择写 P、NP、NPC 问题呢？<br />因为最近算法课学到了这里，而且这里有一些「未解之谜」，最重要的是，我连着好长时间搞不懂其中的一些问题，经过了长时间讨论分析，最终有点领悟，下面就记录一下我的理解吧。<br /></p><h2 id="三种问题的定义"><a href="#三种问题的定义" class="headerlink" title="三种问题的定义"></a>三种问题的定义</h2><blockquote><p>摘自我自己的笔记</p></blockquote><p><br />P 问题：<br />对于一个问题，如果存在解决问题的多项式时间代价的算法，那么该问题称为 P 问题。</p><p>NP 问题：<br />如果一个问题的解在多项式时间内可以验证，则称为 NP 问题。可验证的意思是：非确定性地猜测该问题的任意一个解，在多项式时间内能够检测这个解是不是该问题的解。</p><p>NP 难问题：<br />如果对于任意的 NP 问题 Q，Q 都能多项式时间归约到问题 P，则称 P 为 NP 难问题。</p><p>NPC 问题：<br />一个问题既是 NP 问题，又是 NP 难问题，则它被称为 NP 完全问题。</p><h2 id="我遇到的问题"><a href="#我遇到的问题" class="headerlink" title="我遇到的问题"></a>我遇到的问题</h2><h3 id="问题-1：归约的方向与-NPC-问题的证明"><a href="#问题-1：归约的方向与-NPC-问题的证明" class="headerlink" title="问题 1：归约的方向与 NPC 问题的证明"></a>问题 1：归约的方向与 NPC 问题的证明</h3><p><br />我一直感觉归约的方向有点反直觉。<br />或者说，我是因为看了教材上给的例子之后才觉得反直觉。<br /><br><br />是这样一个例子（简化说明）：<br />划分问题：一个特殊问题<br />背包问题：一个一般问题<br />划分问题是背包问题的一个特例（或者说，把背包问题的某些参数确定后，就变成了划分问题）。<br />已知划分问题是 NPC 问题，证明背包问题也是 NPC 问题。<br /><br><br />要证明一个问题 B 是 NPC 问题，做法就是：</p><ul><li>证明问题 B 是一个 NP 问题。<ul><li>按照定义证明即可</li></ul></li><li>证明一个 NPC 问题 A 能够归约到问题 B（问题 A 的难度小于等于问题 B）</li></ul><p><br />教材上说，把背包问题的某些参数确定后，就变成了划分问题，由此得到了「划分问题到背包问题的一个归约」。</p><p>看到这里我就有点懵了，我好像看不懂这中间的关系了，具体理清思路后是这样的：<br />1、A 问题归约到 B 问题，说明 A 问题的难度不高于 B 问题。<br />2、特殊问题比一般问题简单，所以特殊问题可以归约到一般问题。<br />3、这个问题里的归约是什么：是一般问题特殊化的过程。</p><p>我之前搞不懂，为什么「一般问题的特殊化」是一个「从特殊问题到一般问题的归约」？一直觉得这很反直觉，很矛盾。<br />后来才理解到，<strong>一般问题的特殊化的实质是：构造了一个从特殊问题的参数到一般问题参数的映射，这个映射正是从特殊到一般进行归约所需要的。</strong></p><p>最后。<br />三色问题是四色问题的特例吗？是的。<br />所以三色问题其实比四色问题简单？对。<br />如何把三色问题归约到四色问题？把四色问题特殊化为三色问题即可。</p><h3 id="问题-2：伪最大团与最大团问题的区别"><a href="#问题-2：伪最大团与最大团问题的区别" class="headerlink" title="问题 2：伪最大团与最大团问题的区别"></a>问题 2：伪最大团与最大团问题的区别</h3><p><br />伪最大团问题：<br />输入是图 G，有一个常数 k，问图 G 中是否存在大小为 k 的团？<br />最大团问题：<br />输入是图 G 和参数 k，问图 G 中是否存在大小为 k 的团？</p><p>这两个问题的区别在于，前者的 k 是常数，后者是参数（输入、变量）。<br />结论告诉我：<br />1、伪最大团问题是具有多项式时间的解法，因此是 P 问题。<br />2、最大团问题，暂时没有人找到多项式时间算法，所以只是 NP 问题。</p><p>我使用暴力算法： n 个顶点中任选 k 个顶点，并遍历这 k 个顶点可能形成的所有边，总的时间复杂度是 $C(n,k)*\frac{k(k-1)}{2}$。</p><p>就是这个式子让我疑惑了。<br />我一看，左边组合数，分解后是阶乘，多项式，右边也是多项式。<br />诶？这不就是多项式时间吗？<br /></p><p>不仅这两个问题的解相同，我又看到了书上的定理「最大团优化问题在多项式时间可解，当且仅当最大团判定问题在多项式时间可解」，我居然证明出了这个被称为 NPC 问题的最大团优化问题是一个 P 问题？！</p><p>理性让我知道自己肯定错了，这么简单的步骤还想破解世界难题？<br />终于在与同学的一番讨论后我才明白错误的地方：<br />阶乘！<br />我把 O(n!) 当成了多项式时间了！</p><p>而后再看暴力算法时间复杂度的式子，左边组合数分解后是阶乘除以阶乘，化简得到的是 n^k。<br />这个式子，对于伪最大团问题来说，k 是常数，所以是多项式时间；但对于最大团问题来说，k 是输入，它的规模是 O(n)，所以这个式子其实是 O(n^n)，不是多项式时间。</p><p>由此这个问题的疑惑变解开了。</p><p>由此引出下一个问题：</p><h3 id="问题-3：伪多项式时间"><a href="#问题-3：伪多项式时间" class="headerlink" title="问题 3：伪多项式时间"></a>问题 3：伪多项式时间</h3><p><br />有些问题的输入很特殊，你能很明确的确定输入的规模：n 个顶点，n 个数字<br />之类的。对于这些问题，多项式时间复杂度很好确定。<br />但对于那些多个输入的问题，或者说输入是一张图，信息很多，变量也很多，那你如何确定一个关于这些变量的式子是不是多项式时间呢？<br />比如，输入有 n、k，我给的式子是 O(nk)、O(n^k)、O(k^2+n^2)等等，由于第二个问题已经讨论过，所以这几个还是比较好回答的。<br />但如果是更复杂的输入，似乎教材中并未给出清晰明确的「多项式时间」的定义。</p><p>由此引出一个概念：<br />伪多项式时间。</p><p>如果一个问题的 input size（输入规模或输入大小）为 x，某个解决这个问题的算法的最坏时间复杂度为O(x^k)，其中 x^k 表示 x 的 k 次方，此处 k 为已知常数，那么这个算法可以成为多项式时间算法。<br /><br><br />什么是 input size？<br />这个问题所有输入用二进制表示下的位数。<br /><br><br />经典的伪多项式时间的问题：背包问题、素数判定问题。<br /></p><blockquote><p>知乎上看到这样一个解释：<br>算法的时间复杂度是输入数据的多项式表达，但却是输入数据长度的指数时间表达。</p></blockquote><p><br />举个例子，<br />一问题的输入是一个整数 n，这个整数 n 的大小没有限制，也就是说可能不只是32位、64位等。<br />解决这个问题的算法的时间复杂度假设为 O(n^3)。<br />这个问题的输入规模 x = logn（即 n 对应于二进制下的 bit 位数）。<br />由此得到时间复杂度为 O(2^{3x})，这是一个指数型的代价，则该算法的代价实际上伪多项式时间。<br /><br><br />而对比数组排序问题，每个数都是整数，<br />每次增加一个数，只增加 32 比特，所以原输入规模 x = 32n，<br />这个问题的算法就是多项式时间的。<br /><br><br />分析出来的区别：数据规模。<br /></p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/">https://blog.shuifengche.top/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/NP%E9%97%AE%E9%A2%98/">NP问题</a><a class="post-meta__tags" href="/tags/%E8%AE%A1%E7%AE%97%E6%95%B0%E5%AD%A6/">计算数学</a><a class="post-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/pnp.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/07/04/%E5%85%A8%E5%B9%B3%E5%8F%B0%E5%90%8C%E6%AD%A5%EF%BC%8C%E5%BE%88%E9%9A%BE%E5%90%97%EF%BC%9F/"><img class="prev-cover" src="http://cdn.shuifengche.top/timg.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">全平台同步，很难吗？</div></div></a></div><div class="next-post pull-right"><a href="/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/"><img class="next-cover" src="http://cdn.shuifengche.top/i386.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PA4-异常中断与IO</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/10/03/大数的加法与乘法/" title="大数的加法与乘法"><img class="cover" src="http://cdn.shuifengche.top/jiafa.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-10-03</div><div class="title">大数的加法与乘法</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/index/"/>
    <url>/2021/01/10/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PA4-异常中断与IO | 水风车的博客</title><meta name="keywords" content="PA,i386,异常与中断,IO"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="PA 2019秋季实验系列之PA 4"><meta property="og:type" content="article"><meta property="og:title" content="PA4-异常中断与IO"><meta property="og:url" content="https://blog.shuifengche.top/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="PA 2019秋季实验系列之PA 4"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/i386.png"><meta property="article:published_time" content="2020-01-20T14:59:43.000Z"><meta property="article:modified_time" content="2020-01-20T16:05:43.275Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="PA"><meta property="article:tag" content="i386"><meta property="article:tag" content="异常与中断"><meta property="article:tag" content="IO"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/i386.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2020-01-21 00:05:43'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO"><span class="toc-number">1.</span> <span class="toc-text">PA4 异常中断与IO</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PA4-1-%E5%BC%82%E5%B8%B8%E5%92%8C%E4%B8%AD%E6%96%AD%E7%9A%84%E5%93%8D%E5%BA%94"><span class="toc-number">1.1.</span> <span class="toc-text">PA4-1 异常和中断的响应</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E9%98%B6%E6%AE%B5%EF%BC%9A%E7%A1%AC%E4%BB%B6"><span class="toc-number">1.1.1.</span> <span class="toc-text">第一阶段：硬件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E9%98%B6%E6%AE%B5%EF%BC%9A%E8%BD%AF%E4%BB%B6-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F"><span class="toc-number">1.1.2.</span> <span class="toc-text">第二阶段：软件(操作系统)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%A4%E7%A7%8D%E5%93%8D%E5%BA%94"><span class="toc-number">1.1.3.</span> <span class="toc-text">两种响应</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E8%8A%82%E4%BB%BB%E5%8A%A1"><span class="toc-number">1.1.4.</span> <span class="toc-text">本节任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PA4-2-%E5%A4%96%E8%AE%BE%E4%B8%8EIO"><span class="toc-number">1.2.</span> <span class="toc-text">PA4-2 外设与IO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#IO%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.1.</span> <span class="toc-text">IO的两种方式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E8%8A%82%E4%BB%BB%E5%8A%A1-1"><span class="toc-number">1.2.2.</span> <span class="toc-text">本节任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PA4-3-%E5%8F%AF%E9%80%89%E4%BB%BB%E5%8A%A1%EF%BC%9A%E6%B8%B8%E6%88%8F%E7%A7%BB%E6%A4%8D"><span class="toc-number">1.3.</span> <span class="toc-text">PA4-3 可选任务：游戏移植</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E8%8A%82%E4%BB%BB%E5%8A%A1-2"><span class="toc-number">1.3.1.</span> <span class="toc-text">本节任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PA%E5%AE%8C%E7%BB%93%E7%9A%84%E6%9C%80%E5%90%8E"><span class="toc-number">1.4.</span> <span class="toc-text">PA完结的最后</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/i386.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">PA4-异常中断与IO</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2020-01-20T14:59:43.000Z" title="undefined 2020-01-20 22:59:43">2020-01-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E9%AA%8C/">实验</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>3分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="PA4-异常中断与IO"><a href="#PA4-异常中断与IO" class="headerlink" title="PA4 异常中断与IO"></a>PA4 异常中断与IO</h1><blockquote><p>本章涉及的知识点已整理在我的笔记系统中<a target="_blank" rel="noopener" href="https://book.shuifengche.top/">我的笔记</a> </p><p>我的笔记–计算机系统–第七章 异常控制流</p></blockquote><h2 id="PA4-1-异常和中断的响应"><a href="#PA4-1-异常和中断的响应" class="headerlink" title="PA4-1 异常和中断的响应"></a>PA4-1 异常和中断的响应</h2><p>异常和中断的的处理：</p><h3 id="第一阶段：硬件"><a href="#第一阶段：硬件" class="headerlink" title="第一阶段：硬件"></a>第一阶段：硬件</h3><p>1、保护断点和程序状态：把EFLAGS、CS、EIP的值push进栈</p><p>2、关中断：外部中断需要关中断，即清空IF位，内部异常则不需要。</p><p>3、识别异常和中断事件并转到相应的处理程序执行：根据指令或硬件给的异常和中断的类型号，查询中断描述符表，找到对应的处理程序的地址并跳转执行。</p><p>此处的中断描述符表与之前PA3的段表、页表类似。</p><h3 id="第二阶段：软件-操作系统"><a href="#第二阶段：软件-操作系统" class="headerlink" title="第二阶段：软件(操作系统)"></a>第二阶段：软件(操作系统)</h3><p>1、保护现场：执行pusha指令，保存所有寄存器的值</p><p>2、处理异常或中断</p><p>3、处理结束，使用popa恢复现场</p><p>4、通过iret恢复断点和程序状态，并返回原程序继续执行</p><h3 id="两种响应"><a href="#两种响应" class="headerlink" title="两种响应"></a>两种响应</h3><ul><li>内部异常</li></ul><p>以<code>int 0x**</code>的形式执行，程序遇到这条指令时就会进行上述两个阶段的处理。</p><ul><li>外部中断</li></ul><p>使用专门的引脚，每执行完一条指令后都去检查引脚是否有中断事件，如果有，就会进行上述两个阶段的处理。</p><h3 id="本节任务"><a href="#本节任务" class="headerlink" title="本节任务"></a>本节任务</h3><p>1、实现lidt、cli、sti、int、pusha、popa、iret指令。</p><p>2、实现raise_intr函数，根据异常中断类型号完成第一阶段硬件处理的模拟。</p><h2 id="PA4-2-外设与IO"><a href="#PA4-2-外设与IO" class="headerlink" title="PA4-2 外设与IO"></a>PA4-2 外设与IO</h2><blockquote><p>向一台完整的计算机设备迈出最后一步！</p></blockquote><h3 id="IO的两种方式"><a href="#IO的两种方式" class="headerlink" title="IO的两种方式"></a>IO的两种方式</h3><ul><li>端口映射模拟</li></ul><p>IA-32共定义了65536个8位的IO端口，CPU通过专门的IO指令in和out来对一个端口进行读和写。</p><p>通过对某一特定端口的读写，完成CPU和某些特定外设之间的数据交换。</p><p>比如本实验中的串口、硬盘、键盘灯设备。</p><ul><li>内存映射模拟</li></ul><p>将一部分物理内存映射到IO设备空间中，使得CPU可以通过普通的访存指令来访问设备。</p><p>具体的例子是VGA内部的显存，映射到某一确定的物理地址空间，CPU修改该物理地址空间，相当于修改显存内容。</p><h3 id="本节任务-1"><a href="#本节任务-1" class="headerlink" title="本节任务"></a>本节任务</h3><p>本节主要用于理解外部设备与cpu的数据传输，大部分功能已完成。</p><p>1、实现in、out指令。</p><p>2、实现串口打印函数。</p><p>3、修改loader，改为从硬盘读取用户程序。</p><p>4、完成显存的恒等映射（映射：即一些页表）</p><h2 id="PA4-3-可选任务：游戏移植"><a href="#PA4-3-可选任务：游戏移植" class="headerlink" title="PA4-3 可选任务：游戏移植"></a>PA4-3 可选任务：游戏移植</h2><p>从PA1的PA4，我们一步步地实现并完善了这个虚拟机框架。</p><p>最后一步，我们可以在这个虚拟机框架里运行游戏了。</p><ul><li><p>打字小游戏</p></li><li><p>仙剑奇侠传</p></li><li><p>彩蛋</p></li></ul><h3 id="本节任务-2"><a href="#本节任务-2" class="headerlink" title="本节任务"></a>本节任务</h3><p>重写SDL库的API，主要有以下几个内容：</p><p>1、时钟相关</p><ul><li>返回当前时间的函数</li><li>延迟若干毫秒时间的函数</li></ul><p>可以使用记录了时钟中断次数的变量实现上面两个函数</p><p>2、键盘相关</p><ul><li>记录按键状态的函数</li><li>寻找上一个释放的按键的函数</li></ul><p>3、显示相关</p><p>4、简易文件系统</p><ul><li>fs_open()</li><li>fs_read()</li><li>fs_lseek()</li><li>fs_close()</li></ul><p>很遗憾，我的PA之旅停留在最后的打字小游戏。</p><p>程序运行了很久，画面中才显示出打字小游戏的界面，左上角写着“1 FPS”，第一行一个字母“Q”就卡在那里，不再下落。</p><h2 id="PA完结的最后"><a href="#PA完结的最后" class="headerlink" title="PA完结的最后"></a>PA完结的最后</h2><p>这是我这学期的PA实验的第四篇文章，也是最后一篇。</p><p>开始只是记录了一些实验中写的函数，后来则是概括性的总结实验内容。</p><p>一个学期，整个PA之旅走下来，遇到过数不清的bug。</p><p>在3-2时，缺页。不管怎么改都缺页。用了一些“不好的技巧”避开了缺页的问题，坚持通过了3-2。</p><p>在4-1时，段错误。不管怎么改都段错误，问了好多人，都没遇到我这个问题。在不断地修改的过程中，居然成功地解决并理解了之前3-2遇到的问题。而这个段错误，也因为发现一个低级错误而告终。</p><p>我一路挺到最后的游戏，面对仙剑奇侠传却放弃了。</p><p>我现在在码字，这个12点截止，我注定无法去完成这个游戏的移植了。</p><p>但这个PA之旅，我依旧收获不少。</p><p>每一次运行程序，都会有贴心的教诲(大致是下面的意思)：</p><p>1、程序绝不会错误执行，如果有问题，一定是代码写的不对。</p><p>2、没有执行过的程序永远是错的。</p><p>最后，用PA手册开篇的一个醒目的标志结尾：</p><p><strong>“Don’t panic.”</strong></p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/">https://blog.shuifengche.top/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PA/">PA</a><a class="post-meta__tags" href="/tags/i386/">i386</a><a class="post-meta__tags" href="/tags/%E5%BC%82%E5%B8%B8%E4%B8%8E%E4%B8%AD%E6%96%AD/">异常与中断</a><a class="post-meta__tags" href="/tags/IO/">IO</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/i386.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/05/30/P-NP%E5%92%8CNPC%E9%97%AE%E9%A2%98/"><img class="prev-cover" src="http://cdn.shuifengche.top/pnp.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">P、NP与NPC问题的一些思考</div></div></a></div><div class="next-post pull-right"><a href="/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"><img class="next-cover" src="http://cdn.shuifengche.top/i386.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PA3-存储管理</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/11/19/PA2-程序的执行/" title="PA2 程序的执行"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-19</div><div class="title">PA2 程序的执行</div></div></a></div><div><a href="/2019/09/21/PA1-数据的表示存取和运算/" title="PA1 数据的表示存取和运算"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-21</div><div class="title">PA1 数据的表示存取和运算</div></div></a></div><div><a href="/2020/01/20/PA3-存储管理/" title="PA3-存储管理"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-20</div><div class="title">PA3-存储管理</div></div></a></div><div><a href="/2019/09/23/Datalab-实验1/" title="Datalab 实验1"><img class="cover" src="http://cdn.shuifengche.top/csapp.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-23</div><div class="title">Datalab 实验1</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/index/"/>
    <url>/2021/01/10/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PA3-存储管理 | 水风车的博客</title><meta name="keywords" content="PA,分段模式,分页模式,Cache"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="PA 2019秋季实验系列之PA 3"><meta property="og:type" content="article"><meta property="og:title" content="PA3-存储管理"><meta property="og:url" content="https://blog.shuifengche.top/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="PA 2019秋季实验系列之PA 3"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/i386.png"><meta property="article:published_time" content="2020-01-20T13:41:05.000Z"><meta property="article:modified_time" content="2020-01-20T15:29:21.155Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="PA"><meta property="article:tag" content="分段模式"><meta property="article:tag" content="分页模式"><meta property="article:tag" content="Cache"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/i386.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2020-01-20 23:29:21'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86"><span class="toc-number">1.</span> <span class="toc-text">PA3 存储管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PA3-1-Cache%E7%9A%84%E6%A8%A1%E6%8B%9F"><span class="toc-number">1.1.</span> <span class="toc-text">PA3-1 Cache的模拟</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9A%E4%B8%BB%E5%AD%98%E8%AE%BF%E9%97%AE%E9%80%9F%E5%BA%A6%E6%85%A2"><span class="toc-number">1.1.1.</span> <span class="toc-text">问题：主存访问速度慢</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%EF%BC%9A%E5%BC%95%E5%85%A5Cache"><span class="toc-number">1.1.2.</span> <span class="toc-text">解决：引入Cache</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%86%E8%8A%82%EF%BC%9ACache%E7%9A%84%E6%9E%84%E9%80%A0"><span class="toc-number">1.1.3.</span> <span class="toc-text">细节：Cache的构造</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%E8%BF%87%E7%A8%8B"><span class="toc-number">1.1.4.</span> <span class="toc-text">总结过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E8%8A%82%E4%BB%BB%E5%8A%A1"><span class="toc-number">1.1.5.</span> <span class="toc-text">本节任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PA3-2-%E4%BF%9D%E6%8A%A4%E6%A8%A1%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">PA3-2 保护模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98"><span class="toc-number">1.2.1.</span> <span class="toc-text">问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3"><span class="toc-number">1.2.2.</span> <span class="toc-text">解决</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%E8%BF%87%E7%A8%8B-1"><span class="toc-number">1.2.3.</span> <span class="toc-text">总结过程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E8%8A%82%E4%BB%BB%E5%8A%A1-1"><span class="toc-number">1.2.4.</span> <span class="toc-text">本节任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PA3-3-%E8%99%9A%E6%8B%9F%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.3.</span> <span class="toc-text">PA3-3 虚拟地址转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-number">1.3.1.</span> <span class="toc-text">问题：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%EF%BC%9A%E5%88%86%E9%A1%B5%E6%9C%BA%E5%88%B6"><span class="toc-number">1.3.2.</span> <span class="toc-text">解决：分页机制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%AC%E8%8A%82%E4%BB%BB%E5%8A%A1-2"><span class="toc-number">1.3.3.</span> <span class="toc-text">本节任务</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">1.4.</span> <span class="toc-text">总结</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/i386.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">PA3-存储管理</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2020-01-20T13:41:05.000Z" title="undefined 2020-01-20 21:41:05">2020-01-20</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E9%AA%8C/">实验</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>5分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="PA3-存储管理"><a href="#PA3-存储管理" class="headerlink" title="PA3 存储管理"></a>PA3 存储管理</h1><blockquote><p>本章涉及的知识点已整理在我的笔记系统中<a target="_blank" rel="noopener" href="https://book.shuifengche.top/">我的笔记</a> </p><p>我的笔记–计算机系统基础–第六章 层次结构存储系统</p></blockquote><p>通过之前的PA2实验，我们创造了一台能够进行各种复杂运算的机器，它的计算能力与当今世界所有计算机等价，仅仅是速度上有些差距。</p><p>为了实现更快的计算速度，本章我们引入Cache；</p><p>为了使得程序和数据得到保护，引入了分段保护机制；</p><p>为了使多个程序之前互不干扰，又产生虚拟地址空间的概念。</p><h2 id="PA3-1-Cache的模拟"><a href="#PA3-1-Cache的模拟" class="headerlink" title="PA3-1 Cache的模拟"></a>PA3-1 Cache的模拟</h2><h3 id="问题：主存访问速度慢"><a href="#问题：主存访问速度慢" class="headerlink" title="问题：主存访问速度慢"></a>问题：主存访问速度慢</h3><p>对于一个存储硬件，它的读写速度与总大小、总造价有一定关系。</p><p>DRAM器件：读写速度一般，价格低，空间大</p><p>SRAM器件：读写速度很快，价格高，空间小</p><p>之前的实验中，代码和数据都是存放在DRAM中，每次都要对DRAM器件进行读写，浪费了大量时间</p><h3 id="解决：引入Cache"><a href="#解决：引入Cache" class="headerlink" title="解决：引入Cache"></a>解决：引入Cache</h3><p>引入Cache（SRAM器件）：</p><p>空间小，用来存放一些经常性的频繁使用的代码和数据。</p><p>每次要读写数据，先看Cache中有没有，有的话直接对Cache进行操作，速度很快；没有的话再去读写主存。</p><p>Cache利用的是<strong>程序访问的局部性</strong>：</p><ul><li>时间局部性：访问过的数据、代码在一段时间内可能再次使用</li><li>空间局部性：访问过的数据、代码的相邻部分</li></ul><h3 id="细节：Cache的构造"><a href="#细节：Cache的构造" class="headerlink" title="细节：Cache的构造"></a>细节：Cache的构造</h3><p>1、要实现Cache，我们需要建立一个cache与主存的映射关系，有三种方式：</p><ul><li>直接映射</li><li>全相联映射</li><li>组相联映射</li></ul><p>2、映射到的位置已满，删去哪个？</p><ul><li>先进先出</li><li>最近最少用</li><li>最不经常用</li><li>随机替换</li></ul><p>3、写入操作时，Cache与主存不一致怎么办？</p><ul><li>全写法</li><li>回写法</li></ul><p>4、写操作时Cache缺失怎么处理？</p><ul><li>写分配法</li><li>非写分配法</li></ul><p>主要就是以上四个问题。</p><p>每个问题中的每种方法各有优劣，根据需求选择。</p><p>本实验中选择：</p><p>组相连映射法、随机替换、全写法、非写分配法</p><h3 id="总结过程"><a href="#总结过程" class="headerlink" title="总结过程"></a>总结过程</h3><p>我们创建了一个与主存对应的Cache存储器。</p><p>要对某个地址进行读操作时，先看Cache中有没有这个地址对应的区块，若有，直接从该块中取出数据；若没有，再去主存中把对应区块搬入Cache，再次读取Cache中该区块的数据。</p><p>要对某个地址进行写操作时，先看Cache中有没有这个地址对应的区块，若有，修改该区块中该地址的值，设置脏位，等待该区块被替换或者程序结束时再覆盖主存的值(此处是回写法)；若没有，先修改主存对应的数据，再把主存中对应区块搬入Cache。</p><h3 id="本节任务"><a href="#本节任务" class="headerlink" title="本节任务"></a>本节任务</h3><p>定义一个Cache，并实现它的读写函数。</p><h2 id="PA3-2-保护模式"><a href="#PA3-2-保护模式" class="headerlink" title="PA3-2 保护模式"></a>PA3-2 保护模式</h2><h3 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h3><p>在3-2之前，我们所有的寻址都是程序直接用物理地址进行访问的，不管是代码、数据、堆栈，都混在一起。</p><p>现代计算机采用保护模式，把这些不同的区域分开，称为“分段机制”。</p><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><p>把所有代码数据分成不同的段：</p><p>代码段(CS)、数据访问(DS)、堆栈访问(SS)、特殊类型访问(ES)…</p><p>每一个段都对应了一个段寄存器，里面存储了该段的首地址。</p><p>程序给出一个指令的地址，不再是物理地址，而是相对于指令（代码段）的偏移地址。</p><p>即：物理地址=段首地址+段内偏移量</p><h3 id="总结过程-1"><a href="#总结过程-1" class="headerlink" title="总结过程"></a>总结过程</h3><p>程序刚开始时，初始化全局段描述符：</p><p>里面存储了所有段的段选择符和段首地址。</p><p>对于程序内的每次寻址，我们都会根据段选择符在段表中找到对应段的段首地址，取出段首地址，加上段内偏移量，就得到了最终要访问的物理地址。</p><h3 id="本节任务-1"><a href="#本节任务-1" class="headerlink" title="本节任务"></a>本节任务</h3><p>1、实现lgdt、ljmp、特殊mov指令。</p><p>2、实现段转换函数、装载段寄存器函数。</p><h2 id="PA3-3-虚拟地址转换"><a href="#PA3-3-虚拟地址转换" class="headerlink" title="PA3-3 虚拟地址转换"></a>PA3-3 虚拟地址转换</h2><h3 id="问题："><a href="#问题：" class="headerlink" title="问题："></a>问题：</h3><p>1、程序员在编程的时候，不知道在实际的机器中哪些空间可以用，哪些不能用。</p><p>2、如果程序员编写时使用物理地址，那他编写的多个程序不能同时在一台机器上运行。</p><p>。。。</p><p>总之就是，为了减少麻烦，我们应该实现一种机制，使得程序员在编程时，无需在意程序具体的物理地址，而是假装自己的程序就从某一固定的内存位置开始，空间不限。</p><p>至于这个程序在机器上实际运行的内存空间，交给机器自行分配。</p><p>所以，我们要实现一个编程时的虚拟地址空间到机器实际运行的物理地址空间的映射。</p><h3 id="解决：分页机制"><a href="#解决：分页机制" class="headerlink" title="解决：分页机制"></a>解决：分页机制</h3><p>此处涉及三个不同的地址的概念</p><p>逻辑地址、线性地址、物理地址</p><p>在PA3-2中，通过分段机制，我们实现了从逻辑地址到线性地址的转化，这里我们将通过分页机制，实现从线性地址到物理地址的转化。</p><p>分页机制：</p><p>从用虚拟存储技术的计算机中，每一个进程都拥有自己独立的虚拟地址空间，主存地址空间和虚拟地址空间都被分成大小相等的页面，虚拟页和物理页。</p><p>虚拟页与物理页之间存在一一对应的关系，这种映射关系由页表维护。</p><p>采用了两级页表方式。</p><p>32位的线性地址由三个字段组成：10位页目录索引、10位页表索引、12位页内偏移量</p><p>转换过程：</p><p>先根据控制寄存器CR3中给出的页目录表首地址，找到页目录表，由10位页目录索引找到对应的页目录项，根据页目录项中的20位基地址指出的页表首地址找到对应页表，再根据线性地址中间的页表索引找到页表中的页表项，最后将页表项中的20位基地址和线性地址中12位页内偏移量相加得到32位物理地址。</p><h3 id="本节任务-2"><a href="#本节任务-2" class="headerlink" title="本节任务"></a>本节任务</h3><p>1、实现page_translate()函数。</p><p>2、修改loader()函数完成用户进程空间的分配。</p><h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>PA3实现了存储管理。</p><p>用户进程给出一个32位<strong>逻辑地址</strong>和一个16位段选择符，</p><p>先通过<strong>分段机制</strong>，在段表中找出对应的段首地址，加上逻辑地址就得到<strong>线性地址</strong>。</p><p>接着通过<strong>分页机制</strong>，根据线性地址高10位、中间10位，在页目录表中找到对应的页，在页中找到对应的页表项，在页表项中找出该页对应的物理页号，加上线性地址的低12位便得到最终的<strong>物理地址</strong>。</p><p>接着通过<strong>Cache机制</strong>，在Cache中找出该物理地址对应的块，若命中，则读取、写入（全写或回写）；若不命中，则把主存中的部分搬入Cache，再读取，或先写入主存，再搬入Cache。</p><p>至此，便实现了读写功能。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/">https://blog.shuifengche.top/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PA/">PA</a><a class="post-meta__tags" href="/tags/%E5%88%86%E6%AE%B5%E6%A8%A1%E5%BC%8F/">分段模式</a><a class="post-meta__tags" href="/tags/%E5%88%86%E9%A1%B5%E6%A8%A1%E5%BC%8F/">分页模式</a><a class="post-meta__tags" href="/tags/Cache/">Cache</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/i386.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/01/20/PA4-%E5%BC%82%E5%B8%B8%E4%B8%AD%E6%96%AD%E4%B8%8EIO/"><img class="prev-cover" src="http://cdn.shuifengche.top/i386.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PA4-异常中断与IO</div></div></a></div><div class="next-post pull-right"><a href="/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">用终端自动化部署hexo，编程解决豆瓣插件bug</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/09/21/PA1-数据的表示存取和运算/" title="PA1 数据的表示存取和运算"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-21</div><div class="title">PA1 数据的表示存取和运算</div></div></a></div><div><a href="/2019/11/19/PA2-程序的执行/" title="PA2 程序的执行"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-19</div><div class="title">PA2 程序的执行</div></div></a></div><div><a href="/2020/01/20/PA4-异常中断与IO/" title="PA4-异常中断与IO"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-20</div><div class="title">PA4-异常中断与IO</div></div></a></div><div><a href="/2019/09/23/Datalab-实验1/" title="Datalab 实验1"><img class="cover" src="http://cdn.shuifengche.top/csapp.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-23</div><div class="title">Datalab 实验1</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/index/"/>
    <url>/2021/01/10/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>用终端自动化部署hexo，编程解决豆瓣插件bug | 水风车的博客</title><meta name="keywords" content="终端,c++,自动化"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="如题。"><meta property="og:type" content="article"><meta property="og:title" content="用终端自动化部署hexo，编程解决豆瓣插件bug"><meta property="og:url" content="https://blog.shuifengche.top/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="如题。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><meta property="article:published_time" content="2019-12-08T03:55:43.000Z"><meta property="article:modified_time" content="2019-12-26T08:03:07.108Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="终端"><meta property="article:tag" content="c++"><meta property="article:tag" content="自动化"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-26 16:03:07'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">遇到的问题：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%9B%B4%E6%96%B0hexo%E6%97%B6%E6%8C%87%E4%BB%A4%E5%A4%AA%E5%A4%9A"><span class="toc-number">1.0.1.</span> <span class="toc-text">1:更新hexo时指令太多</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-hexo%E2%80%94douban%E6%8F%92%E4%BB%B6%E5%B0%8Fbug"><span class="toc-number">1.0.2.</span> <span class="toc-text">2:hexo—douban插件小bug</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3"><span class="toc-number">2.</span> <span class="toc-text">解决</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#hexo"><span class="toc-number">2.0.1.</span> <span class="toc-text">hexo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#douban"><span class="toc-number">2.0.2.</span> <span class="toc-text">douban</span></a></li></ol></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">用终端自动化部署hexo，编程解决豆瓣插件bug</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-12-08T03:55:43.000Z" title="undefined 2019-12-08 11:55:43">2019-12-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%98%E8%85%BE/">折腾</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">824</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>2分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="遇到的问题："><a href="#遇到的问题：" class="headerlink" title="遇到的问题："></a>遇到的问题：</h2><h4 id="1-更新hexo时指令太多"><a href="#1-更新hexo时指令太多" class="headerlink" title="1:更新hexo时指令太多"></a>1:更新hexo时指令太多</h4><p>自从使用了hexo搭建博客，每次更新网站都需要<code>hexo clean</code> <code>hexo g</code> <code>hexo d</code> 三连，着实麻烦，如果能够连续执行这几个指令就好了，在网上一查正好找到了解决方案。</p><h4 id="2-hexo—douban插件小bug"><a href="#2-hexo—douban插件小bug" class="headerlink" title="2:hexo—douban插件小bug"></a>2:hexo—douban插件小bug</h4><blockquote><p>在新版本中似乎已经解决</p></blockquote><p>该插件生成的页面在iOS、macOS平台的浏览器中被“防盗链”了，导致无法显示书籍、电影的封面。</p><p>在issues里面有人建议在生成的index.html文件中head部分增加<code>&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot;&gt;</code> 这一行代码，实测有效。</p><p>但总不能每次生成后都一个个打开文件去添加吧，太麻烦了，今天突然想到可以直接用c++读写文件的操作来实现自动添加。</p><h2 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h2><h4 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h4><p>在mac下创建一个<code>.sh</code> 文件（win平台有类似的其他文件），在这个文件中，一行一行地添加你想要顺序执行的语句，如下：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /Users/root/blog  # 进入hexo本地目录</span><br><span class="line">hexo clean  </span><br><span class="line">hexo g -d</span><br></pre></td></tr></table></figure><p>保存，关闭，使用chmod指令给这个文件增加“可执行”权限后即可。</p><p>大功告成。</p><p>在你想要更新网站时，只需把上面的这个文件拖入终端，按下回车，它会自动执行里面的每一行命令。</p><h4 id="douban"><a href="#douban" class="headerlink" title="douban"></a>douban</h4><p>学了那么久的c++，平时解决实际问题却用的很少，今天终于派上用场了。</p><p>使用fstream读写文件。</p><p>代码如下：</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;sstream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">string</span> str;</span><br><span class="line">    ifstream fin;</span><br><span class="line">    fin.open(<span class="string">&quot;/Users/root/blog/public/books/index.html&quot;</span>, ios::in);</span><br><span class="line">    <span class="built_in">stringstream</span> buf;</span><br><span class="line">    buf &lt;&lt; fin.rdbuf();</span><br><span class="line">    str = buf.str();<span class="comment">//读出该文件内所有内容，存储在str中</span></span><br><span class="line">    fin.close();</span><br><span class="line">    str.insert(<span class="number">59</span>,<span class="string">&quot;&lt;meta name=\&quot;referrer\&quot; content=\&quot;no-referrer\&quot;&gt;&quot;</span>);<span class="comment">//在str的对应位置（head部分的开头），插入修复的代码</span></span><br><span class="line">    <span class="function">ofstream <span class="title">fout</span><span class="params">(<span class="string">&quot;/Users/root/blog/public/books/index.html&quot;</span>, ios::trunc)</span></span>;</span><br><span class="line">    fout &lt;&lt; str;<span class="comment">//trunc表示覆盖写入原文件</span></span><br><span class="line">    fout.close();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这一段代码跑完，就会在特定文件的特定位置插入特定字符串，正是我们需要做的。</p><p>使用gcc工具生成可执行文件，或者直接使用开发环境已经生成的可执行文件，放在一个合适的位置（比如说放在sh脚本同一个文件夹下面）</p><p>注意，豆瓣插件会生成books、movies、games三个页面，所有修改上面的代码，最后得到三个可执行文件，分别是<code>hexo_movies</code> 、<code>hexo_books</code> 、<code>hexo_games</code> </p><p>接下来，只需要把sh文件内容修改为：</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cd /Users/root/blog</span><br><span class="line">hexo clean</span><br><span class="line">hexo g    </span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入hexo本地目录，clean、g。hexo g操作中应包含hexo douban操作</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> 这时生成的电影书籍游戏页面文件中，是缺少&lt;meta name=\&quot;referrer\&quot; content=\&quot;no-referrer\&quot;&gt;这行代码的</span></span><br><span class="line">cd /Users/root/sh # 进入存放三个可执行文件的文件夹</span><br><span class="line">./hexo_movies</span><br><span class="line">./hexo_games</span><br><span class="line">./hexo_books      # 执行这个三个程序</span><br><span class="line">cd /Users/root/blog  # 返回hexo目录</span><br><span class="line">hexo deploy # 部署。注意这里不能用hexo d，因为hexo deploy和hexo douban名字冲突了。</span><br></pre></td></tr></table></figure><p>大功告成。</p><p>以后更新，只需要把这个sh文件拖入终端，按下回车。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/">https://blog.shuifengche.top/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%BB%88%E7%AB%AF/">终端</a><a class="post-meta__tags" href="/tags/c/">c++</a><a class="post-meta__tags" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96/">自动化</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/01/20/PA3-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86/"><img class="prev-cover" src="http://cdn.shuifengche.top/i386.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PA3-存储管理</div></div></a></div><div class="next-post pull-right"><a href="/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/"><img class="next-cover" src="http://cdn.shuifengche.top/gitbook.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">gitbook部署到服务器</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/index/"/>
    <url>/2021/01/10/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>gitbook部署到服务器 | 水风车的博客</title><meta name="keywords" content="git,gitbook,笔记"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="用gitbook搭建属于自己的笔记系统"><meta property="og:type" content="article"><meta property="og:title" content="gitbook部署到服务器"><meta property="og:url" content="https://blog.shuifengche.top/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="用gitbook搭建属于自己的笔记系统"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/gitbook.png"><meta property="article:published_time" content="2019-11-22T12:56:23.000Z"><meta property="article:modified_time" content="2019-12-23T00:55:48.274Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="git"><meta property="article:tag" content="gitbook"><meta property="article:tag" content="笔记"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/gitbook.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-23 08:55:48'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#gitbook%E6%9C%AC%E5%9C%B0%E9%83%A8%E7%BD%B2"><span class="toc-number">2.</span> <span class="toc-text">gitbook本地部署</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%8C%E5%AE%89%E8%A3%85gitbook%E7%9A%84%E4%B8%8B%E8%BD%BD%E5%B7%A5%E5%85%B7"><span class="toc-number">2.1.</span> <span class="toc-text">第一步，安装gitbook的下载工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%8C%E9%80%89%E6%8B%A9%E4%B8%80%E4%B8%AA%E7%A9%BA%E6%96%87%E4%BB%B6%E5%A4%B9%E5%B9%B6%E5%88%9D%E5%A7%8B%E5%8C%96gitbook"><span class="toc-number">2.2.</span> <span class="toc-text">第二步，选择一个空文件夹并初始化gitbook</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%8C%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AAbook-json%E6%96%87%E4%BB%B6%EF%BC%8C%E5%B9%B6%E5%A1%AB%E5%85%A5%EF%BC%9A"><span class="toc-number">2.3.</span> <span class="toc-text">第三步，创建一个book.json文件，并填入：</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%AE%8C%E6%88%90"><span class="toc-number">2.4.</span> <span class="toc-text">安装完成</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%8A%8A%E4%B8%80%E4%B8%AA%E7%89%B9%E5%AE%9A%E7%9B%AE%E5%BD%95git-push%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%8C%87%E5%AE%9A%E7%9B%AE%E5%BD%95"><span class="toc-number">3.</span> <span class="toc-text">把一个特定目录git push到服务器指定目录</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%8C%E5%9C%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%87%8C%E5%88%9B%E5%BB%BAgit%E4%BB%93%E5%BA%93"><span class="toc-number">3.1.</span> <span class="toc-text">第一步，在服务器里创建git仓库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%8C%E8%AE%BE%E7%BD%AEpost-receive%E9%92%A9%E5%AD%90"><span class="toc-number">3.2.</span> <span class="toc-text">第二步，设置post-receive钩子</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%8C%E5%9C%A8%E6%9C%AC%E5%9C%B0%E5%88%9B%E5%BB%BAgit"><span class="toc-number">3.3.</span> <span class="toc-text">第三步，在本地创建git</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E9%81%87%E5%88%B0%E7%9A%84%E5%9D%91"><span class="toc-number">3.4.</span> <span class="toc-text">我遇到的坑</span></a></li></ol></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/gitbook.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">gitbook部署到服务器</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-11-22T12:56:23.000Z" title="undefined 2019-11-22 20:56:23">2019-11-22</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%98%E8%85%BE/">折腾</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.8k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote><p>注：此文章发布于2019年11月22日，最初“我的文档”采用gitbook实现，而后由于需要记更多的笔记（一个gitbook更适合用作一本书），因此于2019年12月更换为vuepress，目前采用dew主题。 <a target="_blank" rel="noopener" href="https://book.shuifengche.top/">欢迎访问</a></p></blockquote><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近一直想把自己的笔记放在网上，能够公网访问的那种。</p><p>用了几家类似功能的产品：</p><ul><li>看云：</li></ul><p>看云提供服务器，可以绑定到自己的http域名上，访问速度也还可以，缺点是看云的编辑器用着难受，还有就是免费版没有“自动发布”功能，想发布就要要去网页版，而且还巨慢，发布十几分钟了网页才更新。</p><ul><li>语雀</li></ul><p>语雀提供的是一个在线文档阅读的方式，可以通过<code>www.yuque.com/username</code>这个链接直接查看自己的公开文档，相当于语雀是平台，你是平台的作者，没什么大的缺点，手机端页面显示效果不那么好。</p><ul><li>gitbook</li></ul><p>我最后选择了这个，本地版，可以自动生成静态网页（有点像hexo），然后我把生成的网页代码push到服务器里。</p><h1 id="gitbook本地部署"><a href="#gitbook本地部署" class="headerlink" title="gitbook本地部署"></a>gitbook本地部署</h1><h2 id="第一步，安装gitbook的下载工具"><a href="#第一步，安装gitbook的下载工具" class="headerlink" title="第一步，安装gitbook的下载工具"></a>第一步，安装gitbook的下载工具</h2><p><code>cnpm install gitbook-cli -g</code></p><h2 id="第二步，选择一个空文件夹并初始化gitbook"><a href="#第二步，选择一个空文件夹并初始化gitbook" class="headerlink" title="第二步，选择一个空文件夹并初始化gitbook"></a>第二步，选择一个空文件夹并初始化gitbook</h2><p><code>gitbook init</code></p><p>这个过程极其漫长，即使是npm淘宝源也很慢</p><p>最后居然只生成两个文件……（应该是偷偷全局安装了gitbook吧）</p><h2 id="第三步，创建一个book-json文件，并填入："><a href="#第三步，创建一个book-json文件，并填入：" class="headerlink" title="第三步，创建一个book.json文件，并填入："></a>第三步，创建一个<code>book.json</code>文件，并填入：</h2><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;水风车的gitbook&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;author&quot;</span>: <span class="string">&quot;水风车&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;description&quot;</span>: <span class="string">&quot;select * from learn&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;language&quot;</span>: <span class="string">&quot;zh-hans&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;gitbook&quot;</span>: <span class="string">&quot;3.2.3&quot;</span>,</span><br><span class="line">    <span class="attr">&quot;styles&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;website&quot;</span>: <span class="string">&quot;./styles/website.css&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;structure&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;readme&quot;</span>: <span class="string">&quot;README.md&quot;</span></span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;links&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;sidebar&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;我的博客&quot;</span>: <span class="string">&quot;https://blog.shuifengche.top&quot;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">&quot;plugins&quot;</span>: [</span><br><span class="line">        <span class="string">&quot;-sharing&quot;</span>,</span><br><span class="line">        <span class="string">&quot;splitter&quot;</span>,</span><br><span class="line">        <span class="string">&quot;expandable-chapters-small&quot;</span>,</span><br><span class="line">        <span class="string">&quot;anchors&quot;</span>,</span><br><span class="line"></span><br><span class="line">        <span class="string">&quot;github&quot;</span>,</span><br><span class="line">        <span class="string">&quot;donate&quot;</span>,</span><br><span class="line">        <span class="string">&quot;sharing-plus&quot;</span>,</span><br><span class="line">        <span class="string">&quot;anchor-navigation-ex&quot;</span>,</span><br><span class="line">        <span class="string">&quot;favicon&quot;</span></span><br><span class="line">    ],</span><br><span class="line">    <span class="attr">&quot;pluginsConfig&quot;</span>: &#123;</span><br><span class="line">        <span class="attr">&quot;github&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;url&quot;</span>: <span class="string">&quot;https://github.com/shuifengche&quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;donate&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;alipay&quot;</span>: <span class="string">&quot;./source/images/donate.png&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;button&quot;</span>: <span class="string">&quot;赞赏&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;alipayText&quot;</span>: <span class="string">&quot; &quot;</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;sharing&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;douban&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;facebook&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;google&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;hatenaBookmark&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;instapaper&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;line&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;linkedin&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;messenger&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;pocket&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;qq&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;qzone&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;stumbleupon&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;twitter&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;viber&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;vk&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;weibo&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="attr">&quot;whatsapp&quot;</span>: <span class="literal">false</span>,</span><br><span class="line">            <span class="attr">&quot;all&quot;</span>: [</span><br><span class="line">                <span class="string">&quot;google&quot;</span>, <span class="string">&quot;facebook&quot;</span>, <span class="string">&quot;weibo&quot;</span>, <span class="string">&quot;twitter&quot;</span>,</span><br><span class="line">                <span class="string">&quot;qq&quot;</span>, <span class="string">&quot;qzone&quot;</span>, <span class="string">&quot;linkedin&quot;</span>, <span class="string">&quot;pocket&quot;</span></span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;anchor-navigation-ex&quot;</span>: &#123;</span><br><span class="line">            <span class="attr">&quot;showLevel&quot;</span>: <span class="literal">false</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">&quot;favicon&quot;</span>:&#123;</span><br><span class="line">            <span class="attr">&quot;shortcut&quot;</span>: <span class="string">&quot;./source/images/favicon.jpg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;bookmark&quot;</span>: <span class="string">&quot;./source/images/favicon.jpg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;appleTouch&quot;</span>: <span class="string">&quot;./source/images/apple-touch-icon.jpg&quot;</span>,</span><br><span class="line">            <span class="attr">&quot;appleTouchMore&quot;</span>: &#123;</span><br><span class="line">                <span class="attr">&quot;120x120&quot;</span>: <span class="string">&quot;./source/images/apple-touch-icon.jpg&quot;</span>,</span><br><span class="line">                <span class="attr">&quot;180x180&quot;</span>: <span class="string">&quot;./source/images/apple-touch-icon.jpg&quot;</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>里面的具体内容自己改一下，我也是在网上找到的别人的这张表。</p><p>里面有一些插件的说明，gitbook的插件安装需要把插件信息填在上面的文件里面，然后执行<code>gitbook install ./</code></p><h2 id="安装完成"><a href="#安装完成" class="headerlink" title="安装完成"></a>安装完成</h2><p>每次都执行<code>gitbook build</code> ，然后生成的<code>_book</code> 就是对应的网页文件夹。</p><p>下面要做的就是把这个特定的文件夹git push到服务器指定目录里。</p><h1 id="把一个特定目录git-push到服务器指定目录"><a href="#把一个特定目录git-push到服务器指定目录" class="headerlink" title="把一个特定目录git push到服务器指定目录"></a>把一个特定目录git push到服务器指定目录</h1><p>这个过程我折腾了好久，中间遇到一大堆坑，我先说最终的正确操作吧！</p><h2 id="第一步，在服务器里创建git仓库"><a href="#第一步，在服务器里创建git仓库" class="headerlink" title="第一步，在服务器里创建git仓库"></a>第一步，在服务器里创建git仓库</h2><p>在<code>/home/git</code> 里面（任意目录都可以），执行<code>git init --bare book.git</code> ，注意这个<code>--bare</code> 不能省，否则：</p><p>加上bare，<code>/home/git/book.git</code> 就是最终的目录，如果不加bare，就成了<code>/home/git/book.git/.git</code> 是最终目录了。</p><h2 id="第二步，设置post-receive钩子"><a href="#第二步，设置post-receive钩子" class="headerlink" title="第二步，设置post-receive钩子"></a>第二步，设置post-receive钩子</h2><p>钩子的用处：</p><p>git push之后，服务器里book.git应该只保存git记录，没有实际的文件（在现在不会用git的我看来是这样……），钩子可以把push上去的记录变成实际的文件输出到指定目录里面。</p><p>总之就是，没它，你找不着push的文件。</p><p>方法：</p><p>进入<code>book.git/hooks</code> 文件夹，创建一个新的文件<code>post-receive</code> ，内容如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># DIR后面换成你想要的输出文件目录</span><br><span class="line">DIR&#x3D;&#x2F;www&#x2F;wwwroot&#x2F;www.shuifengche.top&#x2F;book</span><br><span class="line">git --work-tree&#x3D;$&#123;DIR&#125; clean -fd</span><br><span class="line"># 直接强制检出</span><br><span class="line">git --work-tree&#x3D;$&#123;DIR&#125; checkout --force</span><br></pre></td></tr></table></figure><p>然后把该文件的权限设置为777（为了减少麻烦，我都开了最高权限，可能会不安全）</p><h2 id="第三步，在本地创建git"><a href="#第三步，在本地创建git" class="headerlink" title="第三步，在本地创建git"></a>第三步，在本地创建git</h2><p>进入在自己想要保存在服务器上的那个文件夹里，</p><p>比如我的gitbook文件夹，里面是<code>SUMMARY.md</code> 、<code>_book</code> 、<code>book.json</code> 、<code>README.md</code> 等等</p><p>这里要注意，虽然<code>_book</code> 文件夹才是真正的gitbook网站文件夹，但不要只push这个文件夹（意思是不要在这里面生成git），理由是：</p><p>gitbook build的操作，会清空<code>_book</code> 文件夹并重新生成，如果你只上传它，那么每次build之后，git没了，又要重新配置。所以干脆把整个gitbook文件夹全部git push上去。</p><p>在gitbook文件夹里执行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">git init&#x2F;&#x2F;给gitbook文件夹创建一个git环境</span><br><span class="line"></span><br><span class="line">git remote add origin ssh:&#x2F;&#x2F;root@xx.xx.xxx.xxx:abcd&#x2F;home&#x2F;git&#x2F;book.git</span><br><span class="line">&#x2F;&#x2F;设置远程服务器地址，root是服务器用户名，abcd是端口（默认22，可以不写）</span><br><span class="line">&#x2F;&#x2F;后面是第一步里面的git文件夹</span><br><span class="line"></span><br><span class="line">git add .&#x2F;&#x2F;注意这个点，意思是add文件夹内所有文件</span><br><span class="line"></span><br><span class="line">git commit -m &#39;asdhgfakgf&#39;&#x2F;&#x2F;随便写个commit，最好别省这一步，我也不知道为啥</span><br><span class="line"></span><br><span class="line">git push&#x2F;&#x2F;这时候提示你添加一个--set-upstream，按照提示做就行了</span><br></pre></td></tr></table></figure><p>Everything up-to-date!</p><p>终于搞定了……</p><h2 id="我遇到的坑"><a href="#我遇到的坑" class="headerlink" title="我遇到的坑"></a>我遇到的坑</h2><p>在不断尝试的过程中，这里改一下，那里改一下，网上的debug方案各不相同，有些报错还找不到解决方法。</p><p>1、没有权限。各种报错提示你报错，一定要确保用户有post-receive文件的读写权限，一定要确保目标目录能写入。</p><p>2、多个本地git要push同一个服务器git，我现在还不知道怎么实现，所以它的报错我都不管，直接删除服务器git重来一遍。</p><p>3、服务器git创建时没有加bare，最终的结果是post-receive无效，指定目录一直没文件。</p><p>……</p><p>总之，有bug，查攻略，没攻略，推倒重来。</p><p>这个把gitbook文件夹部署到服务器上的过程，即把本地任意一个工作目录push到服务器的指定目录的过程，以后应该是要经常用的，到那时我可能就会明白这么多坑的具体原因了。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/">https://blog.shuifengche.top/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/git/">git</a><a class="post-meta__tags" href="/tags/gitbook/">gitbook</a><a class="post-meta__tags" href="/tags/%E7%AC%94%E8%AE%B0/">笔记</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/gitbook.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/12/08/%E7%94%A8%E7%BB%88%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2hexo%EF%BC%8C%E7%BC%96%E7%A8%8B%E8%A7%A3%E5%86%B3%E8%B1%86%E7%93%A3%E6%8F%92%E4%BB%B6bug/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">用终端自动化部署hexo，编程解决豆瓣插件bug</div></div></a></div><div class="next-post pull-right"><a href="/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/"><img class="next-cover" src="http://cdn.shuifengche.top/i386.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PA2 程序的执行</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/09/21/PA1-数据的表示存取和运算/" title="PA1 数据的表示存取和运算"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-21</div><div class="title">PA1 数据的表示存取和运算</div></div></a></div><div><a href="/2019/10/15/水风车的博客2-0/" title="水风车的博客2.0"><img class="cover" src="http://cdn.shuifengche.top/blog2.jpeg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-10-15</div><div class="title">水风车的博客2.0</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/index/"/>
    <url>/2021/01/10/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PA2 程序的执行 | 水风车的博客</title><meta name="keywords" content="PA,ELF,汇编语言,i386,正则表达式,词法分析"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="PA 2019秋季实验系列之PA 2"><meta property="og:type" content="article"><meta property="og:title" content="PA2 程序的执行"><meta property="og:url" content="https://blog.shuifengche.top/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="PA 2019秋季实验系列之PA 2"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/i386.png"><meta property="article:published_time" content="2019-11-18T16:15:54.000Z"><meta property="article:modified_time" content="2019-12-12T06:32:25.248Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="PA"><meta property="article:tag" content="ELF"><meta property="article:tag" content="汇编语言"><meta property="article:tag" content="i386"><meta property="article:tag" content="正则表达式"><meta property="article:tag" content="词法分析"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/i386.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-12 14:32:25'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#pa2-1-%E6%8C%87%E4%BB%A4%E8%A7%A3%E7%A0%81%E4%B8%8E%E6%89%A7%E8%A1%8C"><span class="toc-number">1.</span> <span class="toc-text">pa2-1 指令解码与执行</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BF%85%E5%A4%87%E6%9D%90%E6%96%99"><span class="toc-number">1.1.1.</span> <span class="toc-text">必备材料</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8E%9F%E7%90%86%E8%AF%B4%E6%98%8E"><span class="toc-number">1.1.2.</span> <span class="toc-text">原理说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B"><span class="toc-number">1.2.</span> <span class="toc-text">开始</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99%EF%BC%9A"><span class="toc-number">1.2.1.</span> <span class="toc-text">函数命名规则：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AAmov%E5%87%BD%E6%95%B0"><span class="toc-number">1.2.2.</span> <span class="toc-text">第一个mov函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E5%8C%96"><span class="toc-number">1.2.3.</span> <span class="toc-text">简化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9D%9F"><span class="toc-number">1.2.4.</span> <span class="toc-text">结束</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pa2-2"><span class="toc-number">2.</span> <span class="toc-text">pa2-2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-1"><span class="toc-number">2.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8E%9F%E7%90%86"><span class="toc-number">2.2.</span> <span class="toc-text">原理</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#load%E5%87%BD%E6%95%B0%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">2.3.</span> <span class="toc-text">load函数的作用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#pa2-3-%E5%AE%8C%E5%96%84%E8%B0%83%E8%AF%95%E5%99%A8-%E9%80%89"><span class="toc-number">3.</span> <span class="toc-text">pa2-3 完善调试器(选)</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80-2"><span class="toc-number">3.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90-%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.2.</span> <span class="toc-text">词法分析-正则表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E7%9A%84%E6%96%B9%E6%B3%95%E6%B1%82%E8%A7%A3%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">3.3.</span> <span class="toc-text">递归的方法求解表达式</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">4.</span> <span class="toc-text">最后</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/i386.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">PA2 程序的执行</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-11-18T16:15:54.000Z" title="undefined 2019-11-19 00:15:54">2019-11-19</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E9%AA%8C/">实验</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">2.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>9分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h1 id="pa2-1-指令解码与执行"><a href="#pa2-1-指令解码与执行" class="headerlink" title="pa2-1 指令解码与执行"></a>pa2-1 指令解码与执行</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>经历了基本没有学习的十一假期后，pa2-1来了，它的说明文档有30多页，老师的PPT课件有100多页……足以见得这次的实验都多重要。<br>经过了pa2-1的磨炼，我已经充分认识到这门课的强大，老师提供给你的一个完整的模拟计算机的代码框架，你要做的只是给这身躯体变得有血有肉，但能够完成任务的前提是：你差不得懂得整个代码框架的运作机制，或者是每一个实现部分的框架运行机制，在此基础上，你才能少犯错，少出bug。</p><h3 id="必备材料"><a href="#必备材料" class="headerlink" title="必备材料"></a>必备材料</h3><ul><li>NJUics 2019 PA实验手册</li><li>Intel的i386手册</li><li>i386手册的勘误表</li><li>pa整个工程代码</li></ul><h3 id="原理说明"><a href="#原理说明" class="headerlink" title="原理说明"></a>原理说明</h3><p>pa2-1要实现==所有==汇编指令的翻译和实现，也就是说，给你一行十六进制的汇编操作指令，你需要根据它的opcode判断出这是i386手册中的哪一个汇编指令，并且你要用c语言实现这个操作。</p><p>比如下面这行指令：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">8b 94 83 00 11 00 00 8b 45 f4</span><br></pre></td></tr></table></figure><ul><li>读取8b，这就是opcode。</li><li>去i386手册查一查，这个0x8b对应的汇编操作是MOV Gv,Ev。</li><li>根据i386的规则能够知道意思是把Ev这个源操作数MOV到Gv这个目的操作数里。</li><li>自己用C语言编写一个mov_E2G的函数。</li><li>Gv、Ev具体是什么呢？这就要去看0x8b后面的94、83、00……了</li></ul><p>总之就是，读取一个opcode之后，根据这个opcode对应的汇编指令，去它后面读取相应长度的数，获取源操作数、目的操作数的具体信息，然后实现这个操作。</p><p>最终目标是：实现==所有==汇编指令，大概至多256个。</p><h2 id="开始"><a href="#开始" class="headerlink" title="开始"></a>开始</h2><h3 id="函数命名规则："><a href="#函数命名规则：" class="headerlink" title="函数命名规则："></a>函数命名规则：</h3><ul><li>i：立即数</li><li>r：寄存器地址</li><li>rm：寄存器地址或内存地址</li><li>m：内存地址</li><li>b：8位</li><li>w：16位</li><li>l：32位</li><li>v：16或32位</li><li>bv：源操作数8位，目的操作数16或32位</li></ul><h3 id="第一个mov函数"><a href="#第一个mov函数" class="headerlink" title="第一个mov函数"></a>第一个mov函数</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//把一个i（立即数）传给一个r（寄存器），b表示i和r都是8位。</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mov_i2r_b</span><span class="params">(<span class="keyword">uint32_t</span> eip, <span class="keyword">uint8_t</span> opcode)</span> </span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">        OPERAND imm, r;<span class="comment">// 创建源操作数和目的操作数局部变量</span></span><br><span class="line">      <span class="comment">//OPERAND是一个结构体，里面有val、type、addr、data_size成员，可以进行读、写操作    </span></span><br><span class="line">  </span><br><span class="line">        imm.type = OPR_IMM; <span class="comment">// 配置源操作数类型</span></span><br><span class="line">      imm.addr = eip + <span class="number">1</span>; <span class="comment">// 配置源操作数地址</span></span><br><span class="line">      imm.data_size = <span class="number">8</span>;<span class="comment">// 配置源操作数长度</span></span><br><span class="line">  </span><br><span class="line">        r.data_size = <span class="number">8</span>;<span class="comment">// 配置目的操作数类型</span></span><br><span class="line">        r.type = OPR_REG; <span class="comment">// 配置目的操作数类型</span></span><br><span class="line">      r.addr = opcode &amp; <span class="number">0x7</span>;<span class="comment">// 配置目的操作数类型</span></span><br><span class="line">  </span><br><span class="line">        operand_read(&amp;imm); <span class="comment">// 读源操作数的值</span></span><br><span class="line">      r.val = imm.val; <span class="comment">// 将源操作数的值赋给目的操作数</span></span><br><span class="line">      operand_write(&amp;r);<span class="comment">// 写入目的操作数，完成 mov 动作</span></span><br><span class="line">  </span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;    <span class="comment">// 返回指令长度</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>这是我们写的第一个函数的例子。</p><p>思路就是，获取源操作数、目的操作数的信息（是寄存器就获取它的名字，是内存地址就获取它的地址，是立即数就获取它的值），然后通过不断地读、写内存地址的方式实现这个函数。</p><p>以后的每一个函数都要这样（至少最终是这样。下面讲如何偷懒）</p><h3 id="简化"><a href="#简化" class="headerlink" title="简化"></a>简化</h3><p>由于这256个指令中有大量的指令是==具有相同功能但操作数类型不同==的函数，</p><p>比如：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">mov_i2r_b();</span><br><span class="line">mov_i2r_w();</span><br><span class="line">mov_i2r_v();</span><br><span class="line">mov_i2r_bv();</span><br><span class="line"></span><br><span class="line">mov_rm2r_b();</span><br><span class="line">mov_rm2r_w();</span><br><span class="line">mov_rm2r_v();</span><br><span class="line">mov_rm2r_bv();</span><br><span class="line"></span><br><span class="line">mov_r2rm_b();</span><br><span class="line">mov_r2rm_w();</span><br><span class="line">mov_r2rm_v();</span><br><span class="line">mov_r2rm_bv();</span><br></pre></td></tr></table></figure><p>这些指令只是源操作数、目的操作数不同，功能相同，最终的代码一定是极度相似的，所以老师给我们提供了==宏定义展开==的偷懒方法，实际上就是把重复的没必要多次写的部分代码用宏定义的方式提前写好，最终只需要完成最后的“功能”即可，不用再考虑怎么获取源操作数、目的操作数的信息了。</p><p>方法很强，具体实现有点麻烦，不讨论了。</p><p>总之，只需要写下面的代码可以了：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">instr_execute_2op</span><span class="params">()</span> </span></span><br><span class="line"><span class="function"></span>&#123; </span><br><span class="line">        operand_read(&amp;opr_src); </span><br><span class="line">        opr_dest.val = opr_src.val; </span><br><span class="line">        operand_write(&amp;opr_dest);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p>这一节就是很麻烦，但不难。</p><p>绝大多数指令都能够用老师的偷懒宏定义的方式解决，写一个函数体，相当于写出七八个函数了。</p><p>有个别的汇编指令无法用这种方式，比如push、pop、ret、call。</p><p>这四个指令是最容易出bug的，来来回回改了好几处bug，一定要好好看i386手册上面每一个指令的伪代码。</p><p>还有还有，i386上关于jcc的部分内容有错误，老师给了勘误手册。</p><p>写这篇文章的时候已经是pa2-3结束的时候，2-1的好多内容都记不太清楚了……不多说了。</p><h1 id="pa2-2"><a href="#pa2-2" class="headerlink" title="pa2-2"></a>pa2-2</h1><h2 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h2><p>这一节实验只需要两步。</p><ul><li>修改Makefile文件中的一行，把程序执行时指令存放的实际地址从30000改为100000。</li><li>补充完成程序的装载过程（只需添加两行代码）</li></ul><h2 id="原理"><a href="#原理" class="headerlink" title="原理"></a>原理</h2><p>pa实验中的一个程序的可执行文件（ELF文件），它的存储空间是从0x0到MAX_SIZE。</p><p>从0x0到0x30000是testcase的ELF File数据，从0x30000开始之后是kernel模拟的装载指令的部分，从0x100000开始之后是pa2-2编写的装载load函数生成的数据存放的位置。</p><p>也就是说，从0x30000开始运行程序，用的是系统的load函数；换到0x100000后，用的是我们自己编写的load函数。</p><h2 id="load函数的作用"><a href="#load函数的作用" class="headerlink" title="load函数的作用"></a>load函数的作用</h2><p>读取并分析ELF文件，根据ELF文件的内容运行程序。</p><p>具体是：</p><p>读入位于 ELF 文件最开始位置(偏移量为 0)处的 ELF 头，并根据其中的值 e_phoff 定位程序头表在 ELF 文件中的位置。</p><p>顺序扫描程序头表中的每一个表项，遇到需要装载的表项时，根据表项描述的内容将相应的数据拷贝 到内存相应位置。 </p><h1 id="pa2-3-完善调试器-选"><a href="#pa2-3-完善调试器-选" class="headerlink" title="pa2-3 完善调试器(选)"></a>pa2-3 完善调试器(选)</h1><h2 id="前言-2"><a href="#前言-2" class="headerlink" title="前言"></a>前言</h2><p>整个pa项目的nemu有一个控制器monitor，平时测试程序都在用它，它有一些指令：</p><ul><li>si：单步执行</li><li>ni：单步执行（这两个区别是一个进入函数，另一个直接跳下一步）</li><li>info r：显示所有寄存器+eip里面存的值</li><li>p：计算一个表达式</li><li>……</li></ul><p>总之和gdb有点类似，只不过这个调试器是编写框架的人自己写的简易版。</p><p>pa2-3的目的就是为了给这个monitor增加p指令的功能。</p><p>即实现==计算表达式==的功能。</p><p>##原理</p><p>随便一个表达式：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">-0xc0100000</span> &amp;&amp; <span class="number">5</span> +  ($eax +<span class="number">5</span>)*<span class="number">4</span> - *(  $ebp +<span class="number">8</span>)+ number +main</span><br></pre></td></tr></table></figure><p>这个表达式里面出现了以下类型的字符串：</p><ul><li>十六进制数</li><li>不限制长度的空格</li><li>逻辑运算符号：&amp;&amp; || != ==</li><li>+-*/</li><li>十进制数字number</li><li>左右括号()</li><li>符号main（函数名、变量名）</li></ul><p>还有一点，这里面开头的“-”并不是减号，而是负号，第二个*也不是乘号，而是指针解引用的标志。</p><p>如何求出这个表达式的值呢？</p><h2 id="词法分析-正则表达式"><a href="#词法分析-正则表达式" class="headerlink" title="词法分析-正则表达式"></a>词法分析-正则表达式</h2><p>首先，用正则表达式去匹配不同类型的字符串，它们之前有优先级，匹配完成后存储在一个tokens数组里面，每一个token有一个type变量和一个str变量。</p><p>比如说4+7*(3-1)，它的词法分析结果就是：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">数字、4；</span><br><span class="line">加号、略；</span><br><span class="line">数字、7；</span><br><span class="line">乘号、略；</span><br><span class="line">左括号、略；</span><br><span class="line">数字、3；</span><br><span class="line">减号、略；</span><br><span class="line">数字、1；</span><br><span class="line">右括号、略。</span><br></pre></td></tr></table></figure><p>略的意思是type的类型已经可以确定这是什么数据了，没必要再存一个str了。</p><p>匹配完成之后，我们要考虑乘号、减号的特殊用法：指针解引用、负号。</p><p>你会发现，当乘号、减号意指乘法、减法时，它前面只能是数字、十六进制数、寄存器、符号。</p><p>由此可以遍历一遍token表，把乘号、减号的特殊含义找出来。</p><h2 id="递归的方法求解表达式"><a href="#递归的方法求解表达式" class="headerlink" title="递归的方法求解表达式"></a>递归的方法求解表达式</h2><p>之前学过的处理表达式的思路是，把中缀表达式改为后缀，然后按顺序用栈去计算。</p><p>这里老师给了一种新的思路。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">solve(expr)</span><br><span class="line">&#123;</span><br><span class="line">        <span class="comment">//把expr拆解成expr1、op、expr2</span></span><br><span class="line">        val1=solve(expr1);</span><br><span class="line">        val2=solve(expr2);</span><br><span class="line">        <span class="keyword">return</span> val1 op val2；</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//比如</span></span><br><span class="line">solve(<span class="number">6</span>+(<span class="number">9</span><span class="number">-5</span>)+<span class="number">7</span>*<span class="number">8</span>)</span><br><span class="line">  =solve(<span class="number">6</span>+(<span class="number">9</span><span class="number">-5</span>))+solve(<span class="number">7</span>*<span class="number">8</span>)</span><br><span class="line">    =solve(<span class="number">6</span>)+solve((<span class="number">9</span><span class="number">-5</span>))+solve(<span class="number">7</span>*<span class="number">8</span>)</span><br><span class="line">  =……;</span><br></pre></td></tr></table></figure><p>大概的代码如下：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">eval(p, q) </span><br><span class="line">&#123; </span><br><span class="line">      <span class="keyword">if</span>(p &gt; q) </span><br><span class="line">    &#123;</span><br><span class="line">                <span class="comment">/* Bad expression */</span> </span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(p == q) </span><br><span class="line">    &#123;<span class="comment">//p==q，说明这个字符串只剩下一个token了，根据它的类型很好处理。</span></span><br><span class="line">      <span class="comment">//数字就返回它的数值，寄存器就返回寄存器的值，符号名就去找到ELF文件里面对应的符号地址</span></span><br><span class="line">                <span class="comment">/* Single token.</span></span><br><span class="line"><span class="comment">                * For now this token should be a number. </span></span><br><span class="line"><span class="comment">                * Return the value of the number.</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(check_parentheses(p, q) == <span class="literal">true</span>) </span><br><span class="line">    &#123;<span class="comment">//如何字符串被括号包围，那么扔掉括号</span></span><br><span class="line">                <span class="comment">/* The expression is surrounded by a matched pair of parentheses. </span></span><br><span class="line"><span class="comment">                * If that is the case, just throw away the parentheses.</span></span><br><span class="line"><span class="comment">                */</span></span><br><span class="line">                <span class="keyword">return</span> eval(p + <span class="number">1</span>, q - <span class="number">1</span>); </span><br><span class="line">    &#125;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">    &#123;<span class="comment">//基本操作，遍历一遍token，找到符合要求的那个op，然后两边裂开，递归求值</span></span><br><span class="line">                op = the position of dominant <span class="keyword">operator</span> in the token expression; </span><br><span class="line">          val1 = eval(p, op - <span class="number">1</span>);</span><br><span class="line">                val2 = eval(op + <span class="number">1</span>, q);</span><br><span class="line">                <span class="keyword">switch</span>(op_type) </span><br><span class="line">        &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>: <span class="keyword">return</span> val1 + val2; <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>: <span class="comment">/* ... */</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>: <span class="comment">/* ... */</span></span><br><span class="line">                <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>: <span class="comment">/* ... */</span></span><br><span class="line">                <span class="keyword">default</span>: assert(<span class="number">0</span>); </span><br><span class="line">        &#125;</span><br><span class="line">        &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重点是这个字符串中哪一个符号才是我们要找的op？</p><p>op有几个要求：</p><ul><li>op一定不在括号里面</li><li>op的运算符优先级最低</li><li>如果多个运算符优先级相同，取最右侧的为op</li><li>如果开头是负号、指针解引用，那么它就是op</li></ul><p>之后要做的，就是不断往上加操作了，从加减乘除开始，加入指针解引用，加入逻辑运算符，到最后加入负号名。</p><h1 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h1><p>pa2-1写了大量的指令，真真正正的让你理解每一条汇编指令的具体功能。</p><p>pa2-2步骤很少，为了让你理解程序的装载过程。</p><p>pa2-3督促你学习正则表达式，同时讲了一种求表达式结果的递归方法。</p><p>到这里，几乎可以说明白了pa实验的目的。</p><p>从整体看，有一台完好的操作系统，pa不断地拆下一块，拼上自己制作的那一块，一步步地朝着完全自主制造发展。</p><p>从细节看，每一个步骤都被老师简化了，实际要写的代码并不多，只是为了让你真正理解每一个过程。</p><p>这门实验是计算机系统基础的配套实验，理论课上听的迷迷糊糊，做完实验才仿佛有醍醐灌顶的感觉。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/">https://blog.shuifengche.top/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PA/">PA</a><a class="post-meta__tags" href="/tags/ELF/">ELF</a><a class="post-meta__tags" href="/tags/%E6%B1%87%E7%BC%96%E8%AF%AD%E8%A8%80/">汇编语言</a><a class="post-meta__tags" href="/tags/i386/">i386</a><a class="post-meta__tags" href="/tags/%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F/">正则表达式</a><a class="post-meta__tags" href="/tags/%E8%AF%8D%E6%B3%95%E5%88%86%E6%9E%90/">词法分析</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/i386.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/11/22/gitbook%E9%83%A8%E7%BD%B2%E5%88%B0%E6%9C%8D%E5%8A%A1%E5%99%A8/"><img class="prev-cover" src="http://cdn.shuifengche.top/gitbook.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">gitbook部署到服务器</div></div></a></div><div class="next-post pull-right"><a href="/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/"><img class="next-cover" src="http://cdn.shuifengche.top/PS2.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PS/2键盘接口</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/01/20/PA4-异常中断与IO/" title="PA4-异常中断与IO"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-20</div><div class="title">PA4-异常中断与IO</div></div></a></div><div><a href="/2019/09/21/PA1-数据的表示存取和运算/" title="PA1 数据的表示存取和运算"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-21</div><div class="title">PA1 数据的表示存取和运算</div></div></a></div><div><a href="/2020/01/20/PA3-存储管理/" title="PA3-存储管理"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-20</div><div class="title">PA3-存储管理</div></div></a></div><div><a href="/2019/09/23/Datalab-实验1/" title="Datalab 实验1"><img class="cover" src="http://cdn.shuifengche.top/csapp.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-23</div><div class="title">Datalab 实验1</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/index/"/>
    <url>/2021/01/10/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PS/2键盘接口 | 水风车的博客</title><meta name="keywords" content="PS/2,FPGA,Verilog HDL语言,数字电路,状态机"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="数字电路实验八"><meta property="og:type" content="article"><meta property="og:title" content="PS&#x2F;2键盘接口"><meta property="og:url" content="https://blog.shuifengche.top/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="数字电路实验八"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/PS2.jpeg"><meta property="article:published_time" content="2019-11-17T12:56:08.000Z"><meta property="article:modified_time" content="2019-12-12T06:32:33.072Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="PS&#x2F;2"><meta property="article:tag" content="FPGA"><meta property="article:tag" content="Verilog HDL语言"><meta property="article:tag" content="数字电路"><meta property="article:tag" content="状态机"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/PS2.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-12 14:32:33'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#PS-2%E6%8E%A5%E5%8F%A3"><span class="toc-number">1.</span> <span class="toc-text">PS&#x2F;2接口</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E4%BC%A0%E8%BE%93%E6%96%B9%E5%BC%8F"><span class="toc-number">1.2.</span> <span class="toc-text">数据传输方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Verilog%E8%AF%AD%E8%A8%80%E7%BC%96%E5%86%99%E7%A8%8B%E5%BA%8F%E6%8E%A5%E5%8F%97%E9%94%AE%E7%9B%98%E4%BF%A1%E5%8F%B7"><span class="toc-number">2.</span> <span class="toc-text">使用Verilog语言编写程序接受键盘信号</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%80%81%E5%B8%88%E6%8F%90%E4%BE%9B%E7%9A%84%E6%8E%A7%E5%88%B6%E5%99%A8%E4%BB%A3%E7%A0%81%EF%BC%9A"><span class="toc-number">2.1.</span> <span class="toc-text">老师提供的控制器代码：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E8%A1%8C%E5%AE%8C%E6%88%90%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%BB%A3%E7%A0%81%EF%BC%9A"><span class="toc-number">2.2.</span> <span class="toc-text">自行完成的数据处理代码：</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD%EF%BC%9A%E5%8D%95%E4%B8%AA%E6%8C%89%E9%94%AE"><span class="toc-number">2.2.1.</span> <span class="toc-text">基本功能：单个按键</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%8B%93%E5%B1%95%E5%8A%9F%E8%83%BD%EF%BC%9Ashift-amp-ctrl"><span class="toc-number">2.2.2.</span> <span class="toc-text">拓展功能：shift&amp;ctrl</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#caps-lock"><span class="toc-number">2.2.3.</span> <span class="toc-text">caps_lock</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8D%E6%80%9D"><span class="toc-number">3.</span> <span class="toc-text">反思</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/PS2.jpeg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">PS/2键盘接口</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-11-17T12:56:08.000Z" title="undefined 2019-11-17 20:56:08">2019-11-17</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E9%AA%8C/">实验</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>6分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="PS-2接口"><a href="#PS-2接口" class="headerlink" title="PS/2接口"></a>PS/2接口</h2><h3 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h3><p>PS/2是一种常见的键盘接口（快淘汰了），它使用两根信号线，一根传输时钟信号PS2_CLK，另一根传输数据PS2_DAT。PS2_CLK主要用于指示数据线上的比特位在什么时候是有效的。<br>键盘和主机之间可以进行双向的数据传递，本实验只讨论键盘向主机发送数据。</p><h3 id="数据传输方式"><a href="#数据传输方式" class="headerlink" title="数据传输方式"></a>数据传输方式</h3><p>当用户按键/松开时，键盘以每帧11位比特的格式串行传递数据给主机，同时在PS2_CLK时钟信号上传输对应的时钟。<br>这11位分别是：</p><ul><li><p>开始位0</p></li><li><p>8位数据位</p></li><li><p>1位奇偶校验位</p></li><li><p>停止位1</p></li></ul><p>键盘上每一个按键都有一个8位的“通码”（特殊的有16位），比如w的通码是“8’h1D”，当按下这个键时，键盘会向主机发送一个中间8位是“1D”的11位串数据，如果按下不松，键盘将一直不停地发送这个11位串。<br>每一个按键又都有一个“断码”，一般情况下，断码=F0+通码，比如W的断码是16位串“F01D”，当你松开w时，键盘向主机发送一个F0，之后发送一个1D，再之后就不发送数据了。<br>所以如果你按下W，保持一段时间，再松开，接收到数据串是这样的：”1D-1D-1D-1D-F0-1D”<br>当有多个按键被按下时，将逐个的传递数据，“按下”这个过程总是有先后的。<br>按下shift，开始传递12、12、12，再按下w，不再传递12，而是开始不断传递w的通码1D，当松开shift时，传递F012，再松开w，传递F01D。</p><h2 id="使用Verilog语言编写程序接受键盘信号"><a href="#使用Verilog语言编写程序接受键盘信号" class="headerlink" title="使用Verilog语言编写程序接受键盘信号"></a>使用Verilog语言编写程序接受键盘信号</h2><h3 id="老师提供的控制器代码："><a href="#老师提供的控制器代码：" class="headerlink" title="老师提供的控制器代码："></a>老师提供的控制器代码：</h3><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//键盘控制器</span></span><br><span class="line"><span class="keyword">module</span> ps2_keyboard(clk,clrn,ps2_clk,ps2_data,data,ready,nextdata_n,overflow); </span><br><span class="line">    <span class="keyword">input</span> clk,clrn,ps2_clk,ps2_data;</span><br><span class="line">    <span class="keyword">input</span> nextdata_n;</span><br><span class="line">    <span class="keyword">output</span> [<span class="number">7</span>:<span class="number">0</span>] data;</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> ready;</span><br><span class="line">    <span class="keyword">output</span> <span class="keyword">reg</span> overflow; <span class="comment">// fifo overflow </span></span><br><span class="line">  <span class="comment">// internal signal, for test</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">9</span>:<span class="number">0</span>] buffer; <span class="comment">// ps2_data bits </span></span><br><span class="line">  <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] fifo[<span class="number">7</span>:<span class="number">0</span>]; <span class="comment">// data fifo</span></span><br><span class="line">  <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] w_ptr,r_ptr; <span class="comment">// fifo write and read pointers </span></span><br><span class="line">  <span class="keyword">reg</span> [<span class="number">3</span>:<span class="number">0</span>] count; <span class="comment">// count ps2_data bits</span></span><br><span class="line">    <span class="comment">// detect falling edge of ps2_clk</span></span><br><span class="line">    <span class="keyword">reg</span> [<span class="number">2</span>:<span class="number">0</span>] ps2_clk_sync;</span><br><span class="line">    <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) </span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">            ps2_clk_sync &lt;= &#123;ps2_clk_sync[<span class="number">1</span>:<span class="number">0</span>],ps2_clk&#125;;</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">wire</span> sampling = ps2_clk_sync[<span class="number">2</span>] &amp; ~ps2_clk_sync[<span class="number">1</span>];</span><br><span class="line">  <span class="keyword">always</span> @(<span class="keyword">posedge</span> clk) </span><br><span class="line">    <span class="keyword">begin</span></span><br><span class="line">        <span class="keyword">if</span>(clrn == <span class="number">0</span>) </span><br><span class="line">          <span class="keyword">begin</span> <span class="comment">// reset</span></span><br><span class="line">                        count &lt;= <span class="number">0</span>; w_ptr &lt;= <span class="number">0</span>; r_ptr &lt;= <span class="number">0</span>; overflow &lt;= <span class="number">0</span>; ready&lt;= <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">          <span class="keyword">else</span> </span><br><span class="line">          <span class="keyword">begin</span></span><br><span class="line">            <span class="keyword">if</span>(ready)</span><br><span class="line">              <span class="keyword">begin</span> <span class="comment">// read to output next data </span></span><br><span class="line">                <span class="keyword">if</span>(nextdata_n == <span class="number">1&#x27;b0</span>) <span class="comment">//read next data begin</span></span><br><span class="line">                                    <span class="keyword">begin</span></span><br><span class="line">                      r_ptr &lt;= r_ptr + <span class="number">3&#x27;b1</span>; </span><br><span class="line">                        <span class="keyword">if</span>(w_ptr==(r_ptr+<span class="number">1&#x27;b1</span>)) <span class="comment">//empty</span></span><br><span class="line">                             ready &lt;= <span class="number">1&#x27;b0</span>;</span><br><span class="line">                      <span class="keyword">end</span></span><br><span class="line">                            <span class="keyword">end</span></span><br><span class="line">                        <span class="keyword">if</span>(sampling) </span><br><span class="line">              <span class="keyword">begin</span></span><br><span class="line">                               <span class="keyword">if</span>(count == <span class="number">4&#x27;d10</span>) </span><br><span class="line">                  <span class="keyword">begin</span></span><br><span class="line">                                        <span class="keyword">if</span>((buffer[<span class="number">0</span>] == <span class="number">0</span>) &amp;&amp; <span class="comment">// start bit</span></span><br><span class="line">                                            (ps2_data) &amp;&amp; <span class="comment">// stop bit </span></span><br><span class="line">                       (^buffer[<span class="number">9</span>:<span class="number">1</span>])) </span><br><span class="line">                      <span class="keyword">begin</span> <span class="comment">// odd parity </span></span><br><span class="line">                          fifo[w_ptr] &lt;= buffer[<span class="number">8</span>:<span class="number">1</span>]; <span class="comment">// kbd scan code</span></span><br><span class="line">                                                w_ptr &lt;= w_ptr+<span class="number">3&#x27;b1</span>;</span><br><span class="line">                        ready &lt;= <span class="number">1&#x27;b1</span>;</span><br><span class="line">                        overflow &lt;= overflow | (r_ptr == (w_ptr + <span class="number">3&#x27;b1</span>));<span class="comment">// for next</span></span><br><span class="line">                      <span class="keyword">end</span></span><br><span class="line">                    count &lt;= <span class="number">0</span>;</span><br><span class="line">                                    <span class="keyword">end</span> </span><br><span class="line">                <span class="keyword">else</span> </span><br><span class="line">                  <span class="keyword">begin</span></span><br><span class="line">                                        buffer[count] &lt;= ps2_data; <span class="comment">// store ps2_data</span></span><br><span class="line">                                    count &lt;= count + <span class="number">3&#x27;b1</span>;</span><br><span class="line">                                    <span class="keyword">end</span> </span><br><span class="line">                 <span class="keyword">end</span></span><br><span class="line">          <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">assign</span> data = fifo[r_ptr]; <span class="comment">//always set output data </span></span><br><span class="line"><span class="keyword">endmodule</span></span><br></pre></td></tr></table></figure><p>input clk：使用DE10开发板自带的CLOCK_50。</p><p>input clrn：使能端，接入SW[0]。</p><p>input ps2_clk：键盘时钟，使用DE10的PS2_CLK引脚。</p><p>input ps2_data：键盘数据，使用DE10的PS2_DAT引脚。</p><p>output data：键盘发来的11位串中的8位键码，在时钟信号附近短时间内有效。</p><p>output ready：当ready为1时，data有效，其他模块可以接收data。</p><p>input nextdata_n：当nextdata_n为0时，控制器模块继续读取下一个数据。为1时暂停读取。</p><p>注意：实验要求在自己的处理模块（下面的solve）中处理完一个数据后，将nextdata_n置为0，这样控制器模块才能继续读取并发送数据，且只能置空1个时钟周期。（否则，solve模块将有可能重复接收data）</p><p>overflow：其他模块处理数据太慢，控制器设置的队列溢出。</p><h3 id="自行完成的数据处理代码："><a href="#自行完成的数据处理代码：" class="headerlink" title="自行完成的数据处理代码："></a>自行完成的数据处理代码：</h3><h4 id="基本功能：单个按键"><a href="#基本功能：单个按键" class="headerlink" title="基本功能：单个按键"></a>基本功能：单个按键</h4><figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">module</span> <span class="keyword">solve</span>(clk,clrn,data,ready,nextdata_n,count,state,key_data,sig,sig_cap)</span><br><span class="line">    <span class="keyword">input</span> clk;<span class="comment">//CLOCK_50</span></span><br><span class="line">  <span class="keyword">input</span> clrn;<span class="comment">//使能端，SW[0]</span></span><br><span class="line">  <span class="keyword">input</span> [<span class="number">7</span>:<span class="number">0</span>] data;<span class="comment">//控制模块输出的8位键码</span></span><br><span class="line">  <span class="keyword">input</span> ready;<span class="comment">//控制模块给的是否能够读取的信号</span></span><br><span class="line">  <span class="keyword">output</span> <span class="keyword">reg</span> nextdata_n;<span class="comment">//本模块输出的信号，控制模块用它判断是否应该继续读数</span></span><br><span class="line">  <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] count;<span class="comment">//用于记录按键次数</span></span><br><span class="line">  <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">1</span>:<span class="number">0</span>] state;<span class="comment">//设置状态机</span></span><br><span class="line">  <span class="keyword">output</span> <span class="keyword">reg</span> [<span class="number">7</span>:<span class="number">0</span>] key_data;<span class="comment">//在data有效时，接收data</span></span><br><span class="line">  ……</span><br></pre></td></tr></table></figure><p>状态机设计：</p><p>00：初始化状态，数码管不显示。</p><p>01：一直按键状态，数码管持续显示键码和ASCII码。</p><p>10：按键松开状态，数码管不显示。</p><p>在00状态下，若遇到通码，则跳转01。</p><p>在01状态下，若接收通码，则仍然跳转01；若接收到F0（断码的前8位），则跳转10。</p><p>在10状态下，直接跳转至初始化状态00。</p><p>这样，就可以实现单个按键的信号接收过程了。</p><h4 id="拓展功能：shift-amp-ctrl"><a href="#拓展功能：shift-amp-ctrl" class="headerlink" title="拓展功能：shift&amp;ctrl"></a>拓展功能：shift&amp;ctrl</h4><p>要实现组合键，状态机就变得复杂了。</p><p>把上面基础功能的状态机当成一个三角形，那么这里组合键的出现将状态机升级为两个三角形衔接的组合。</p><p>总共有5个状态。</p><p>A：接收到通码就跳转B，记录下这个通码为f。</p><p>B：接收到F0就跳转E。如果f是12(shift)/14(ctrl)，接收到其他通码，就跳转C；否则，留在B。</p><p>C：若继续接收其他非12/14的通码，则留在C。若接收到F0，跳转D。</p><p>D：直接跳转回B。</p><p>E：直接跳转A。</p><h4 id="caps-lock"><a href="#caps-lock" class="headerlink" title="caps_lock"></a>caps_lock</h4><p>这个功能就比较简单了，接收到断码的时候，判断一下下一位是不是caps_lock的键码，是的话就把sig_cap取反。</p><p>最终输出的时候，根据sig_cap的值，判断是否输出大写。</p><h2 id="反思"><a href="#反思" class="headerlink" title="反思"></a>反思</h2><p>这次实验，老师已经提供了键盘控制器模块的代码，只需要自行完成状态机处理数据即可。主要是为了学习PS/2接口键盘的数据传输原理，而且还是只学了键盘到主机单向传值的原理。</p><p>之前的实验都是小实验，模块很少，这次最大的难度就在于，信号很多，变量很多，模块很多，模块与模块之前是有时序关系的，很难处理。</p><p>比如说，ps2_keyboard模块接收键盘的信号，同时提供数据data给solve模块，但却要根据solve模块输出的nextdata_n进行是否读数的判断。在solve模块处理完数据后，display模块要把处理的结果显示在数码管上，这两者是有先后顺序的，必须先处理，再显示。但solve模块是时序电路，用的是非阻塞语句。这样就会出现一个问题：在一个clk触发后，solve要处理数据key_data，要把它从A变成B，display则要显示数据B，这两个模块如果同时进行会怎样？display到底显示的是A还是B。就仿真结果来看，是B。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/">https://blog.shuifengche.top/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PS-2/">PS/2</a><a class="post-meta__tags" href="/tags/FPGA/">FPGA</a><a class="post-meta__tags" href="/tags/Verilog-HDL%E8%AF%AD%E8%A8%80/">Verilog HDL语言</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E5%AD%97%E7%94%B5%E8%B7%AF/">数字电路</a><a class="post-meta__tags" href="/tags/%E7%8A%B6%E6%80%81%E6%9C%BA/">状态机</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/PS2.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/11/19/PA2-%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C/"><img class="prev-cover" src="http://cdn.shuifengche.top/i386.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PA2 程序的执行</div></div></a></div><div class="next-post pull-right"><a href="/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/"><img class="next-cover" src="http://cdn.shuifengche.top/blog2.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">水风车的博客2.0</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/index/"/>
    <url>/2021/01/10/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>水风车的博客2.0 | 水风车的博客</title><meta name="keywords" content="git,博客,Hexo,云服务器,宝塔面板"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="博客2.0时代，基于hexo，部署于我的云服务器。"><meta property="og:type" content="article"><meta property="og:title" content="水风车的博客2.0"><meta property="og:url" content="https://blog.shuifengche.top/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="博客2.0时代，基于hexo，部署于我的云服务器。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/blog2.jpeg"><meta property="article:published_time" content="2019-10-15T05:06:43.000Z"><meta property="article:modified_time" content="2020-10-06T16:02:45.010Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="git"><meta property="article:tag" content="博客"><meta property="article:tag" content="Hexo"><meta property="article:tag" content="云服务器"><meta property="article:tag" content="宝塔面板"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/blog2.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2020-10-07 00:02:45'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0"><span class="toc-number">1.</span> <span class="toc-text">水风车的博客2.0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%9A%E5%AE%A22-0%E6%9B%B4%E6%96%B0%E8%AF%B4%E6%98%8E"><span class="toc-number">1.1.</span> <span class="toc-text">博客2.0更新说明</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%B0%E5%8D%9A%E5%AE%A2%E6%90%AD%E5%BB%BA%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">新博客搭建过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B4%AD%E4%B9%B0%E5%B9%B6%E9%85%8D%E7%BD%AE%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.1.</span> <span class="toc-text">购买并配置云服务器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BAECS%E5%AE%9E%E4%BE%8B"><span class="toc-number">2.1.1.</span> <span class="toc-text">创建ECS实例</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%AE%89%E5%85%A8%E7%BB%84"><span class="toc-number">2.1.2.</span> <span class="toc-text">设置安全组</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ssh%E5%B7%A5%E5%85%B7%E8%AE%BF%E9%97%AE"><span class="toc-number">2.1.3.</span> <span class="toc-text">ssh工具访问</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF%E7%9A%84%E5%AE%89%E8%A3%85"><span class="toc-number">2.1.4.</span> <span class="toc-text">宝塔面板的安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9C%AC%E5%9C%B0hexo%E5%AE%89%E8%A3%85"><span class="toc-number">2.1.5.</span> <span class="toc-text">本地hexo安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84git%E9%85%8D%E7%BD%AE"><span class="toc-number">2.1.6.</span> <span class="toc-text">云服务器的git配置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9B%9E%E5%88%B0%E6%9C%AC%E5%9C%B0"><span class="toc-number">2.1.7.</span> <span class="toc-text">回到本地</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">3.</span> <span class="toc-text">最后</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/blog2.jpeg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">水风车的博客2.0</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-10-15T05:06:43.000Z" title="undefined 2019-10-15 13:06:43">2019-10-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%98%E8%85%BE/">折腾</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>4分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="水风车的博客2-0"><a href="#水风车的博客2-0" class="headerlink" title="水风车的博客2.0"></a>水风车的博客2.0</h2><p>没错，距离我初次搭建博客不到3个月的现在，我又开始折腾了。<br>初次搭建博客时，无意中（看颜值）选择了<a target="_blank" rel="noopener" href="http://hexo.io/">hexo</a>框架的<a target="_blank" rel="noopener" href="https://github.com/blinkfox/ghost-matery">matery</a>主题，服务器直接采用github的免费仓库，绑定了自己的域名。奈何github的访问速度过于蜗牛，实在不能忍，同时我最近又频繁被“云服务器”诱惑，最终，迎来了这次的博客2.0时代。</p><h3 id="博客2-0更新说明"><a href="#博客2-0更新说明" class="headerlink" title="博客2.0更新说明"></a>博客2.0更新说明</h3><ol><li>将原有的<a target="_blank" rel="noopener" href="https://github.com/blinkfox/ghost-matery">matery</a>主题更换为<a target="_blank" rel="noopener" href="http://jerryc.me/posts/21cfbf15/">butterfly</a>主题。</li><li>将原有的<a target="_blank" rel="noopener" href="https://github.com/gitalk/gitalk">gitalk</a>更换为<a target="_blank" rel="noopener" href="https://valine.js.org/">valine</a>评论系统，因此原评论数据已备份，但不再显示。</li><li>博客服务器从Github Pages更换为阿里云<a target="_blank" rel="noopener" href="https://promotion.aliyun.com/ntms/act/campus2018.html?spm=a2c4g.11186623.2.10.5ef34e6baw55Qi">学生机</a>。</li><li>内容上增加了<a target="_blank" rel="noopener" href="https://github.com/mythsman/hexo-douban">hexo-douban</a>插件，在<a href="http://blog.shuifengche.top/books">/books</a>和<a href="http://blog.shuifengche.top/movies">/movies</a>页面可以显示我的豆瓣数据。</li></ol><h2 id="新博客搭建过程"><a href="#新博客搭建过程" class="headerlink" title="新博客搭建过程"></a>新博客搭建过程</h2><h3 id="购买并配置云服务器"><a href="#购买并配置云服务器" class="headerlink" title="购买并配置云服务器"></a>购买并配置云服务器</h3><p>谁不想拥有一台自己的云服务器呢？在被知乎问题<a target="_blank" rel="noopener" href="https://www.zhihu.com/question/40854395">自己拥有一台服务器可以做哪些很酷的事情？</a>洗脑之后，我终于购买了自己的第一台云服务器。<br>因为之前购买域名是在阿里云买的，所以这次的服务器依旧是选择了阿里云，学生机一年100多一点。<br>我选择的是ECS中的CentOS版本。<br>购买后进入控制台，按照说明文档对服务器进行配置，由于我对这方面完全不了解，说明文档看不懂，折腾了好久。</p><h4 id="创建ECS实例"><a href="#创建ECS实例" class="headerlink" title="创建ECS实例"></a>创建ECS实例</h4><p>购买后实例就已经创建了，只需要设置一下实例的名称，以及登陆密码。</p><h4 id="设置安全组"><a href="#设置安全组" class="headerlink" title="设置安全组"></a>设置安全组</h4><p>在创建ECS实例之后，你就能在该实例的信息中找到它的公网ip地址了，这个主机地址有很多端口，设置安全组的意思就是提前设置好哪些端口可以进，哪些端口可以出。<br>我现在设置的安全组规则：<br>入方向，8888、22、2289、8080、443、80，这里可以使用页面右上角的快速创建功能。</p><h4 id="ssh工具访问"><a href="#ssh工具访问" class="headerlink" title="ssh工具访问"></a>ssh工具访问</h4><p>我还不太懂ssh密钥访问的方式，但在创建ECS实例时我设置了用户名root和对应的密码。这样我就可以在任何一个SSH工具上直接访问我的远程服务器。<br>iOS、macOS、windows、Android上都有类似的ssh工具，这里我打开macOS的终端，输入：<br><code>ssh root@ip</code><br>root是我的用户名，ip时相应的地址。<br>接下来输入密码，就会看到：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Welcome to Alibaba Cloud Elastic Compute Service !</span><br></pre></td></tr></table></figure><p>这样就成功进入了这个centos系统了。<br>这是一个没有安装图形界面（我猜也没必要，或者安装了你也无法远程看到）的纯净的系统，如果你对linux命令行不熟悉，那我推荐你安装一个宝塔面板。</p><h4 id="宝塔面板的安装"><a href="#宝塔面板的安装" class="headerlink" title="宝塔面板的安装"></a>宝塔面板的安装</h4><p>在你的云服务器中安装宝塔面板后，就可以直接在web端进行ssh连接、安装软件、以图形界面管理文件、方便地上传下载文件……<br>具体安装方法见<a target="_blank" rel="noopener" href="https://www.bt.cn/bbs/thread-19376-1-1.html">宝塔安装文档</a>。<br>大概是需要远程ssh连接服务器后，安装一系列工具，记住宝塔面板的地址、账号、密码。</p><p>之后打开上面生成的地址，进入宝塔面板，按照提示，选择一键安装宝塔提供的软件服务。（后续需要使用其中的nginx工具）</p><h4 id="本地hexo安装"><a href="#本地hexo安装" class="headerlink" title="本地hexo安装"></a>本地hexo安装</h4><p>就是在自己的电脑上安装hexo工具，生成一个blog文件夹，前提是安装过git、node.js等等工具，这里可以看<a href="http://blog.shuifengche.top/2019/07/28/shui-feng-che-de-bo-ke-1.0">之前的文章</a>。</p><h4 id="云服务器的git配置"><a href="#云服务器的git配置" class="headerlink" title="云服务器的git配置"></a>云服务器的git配置</h4><blockquote><p>参考：<a target="_blank" rel="noopener" href="http://www.swiftyper.com/2016/04/17/deploy-hexo-with-git-hook/">swiftyper</a></p></blockquote><p>安装git</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install git</span><br></pre></td></tr></table></figure><p>选择一个合适的位置，创建git仓库</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git init --bare blog.git</span><br></pre></td></tr></table></figure><p>在<code>blog.git/hooks</code>文件夹中新建一个<code>post-receive</code>文件，并在该文件中填入</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#!&#x2F;bin&#x2F;bash</span><br><span class="line">git --work-tree&#x3D;&#x2F;home&#x2F;mylinux&#x2F;blog --git-dir&#x3D;&#x2F;home&#x2F;git&#x2F;blog.git checkout -f</span><br></pre></td></tr></table></figure><p>这里面的 <code>/home/mylinux/blog</code>是你想要部署的文件夹，目前是空的，<code>/home/git/blog/git</code>是上一步中新建的git仓库。</p><p>最后，设置该文件的权限：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chmod +x post-receive</span><br></pre></td></tr></table></figure><p>这样，</p><p>远程服务器端已经准备好了。</p><h4 id="回到本地"><a href="#回到本地" class="headerlink" title="回到本地"></a>回到本地</h4><p>将hexo根目录中的_config.yml文件的最下方设置成这样：</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">deploy</span></span><br><span class="line">  <span class="attr">type:</span> <span class="string">git</span></span><br><span class="line">  <span class="attr">repo:</span> <span class="string">username@ip:/home/git/blog.git</span></span><br><span class="line">  <span class="attr">branch:</span> <span class="string">master</span></span><br></pre></td></tr></table></figure><p><code>username</code>是你的云服务器系统的root账号，ip是ipv4的公网ip，<code>/home/git/blog/git</code>是云服务器中创建的git仓库的地址，此处不需要添加端口（我也不知道为啥）</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>感谢知乎/b站大佬<a target="_blank" rel="noopener" href="https://xiaoyou66.com/">小游</a>。</p><p>看了他的回答，我才下定决心买了自己的服务器。</p><p>接下来，我也要继续沿着大佬的脚步，图床、网盘、电子书库等等……</p><p>从直接使用别人的模板，然后慢慢地开始魔改模板，到最后自己创作模板，我的前端之旅还很遥远呢！</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/">https://blog.shuifengche.top/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/git/">git</a><a class="post-meta__tags" href="/tags/%E5%8D%9A%E5%AE%A2/">博客</a><a class="post-meta__tags" href="/tags/Hexo/">Hexo</a><a class="post-meta__tags" href="/tags/%E4%BA%91%E6%9C%8D%E5%8A%A1%E5%99%A8/">云服务器</a><a class="post-meta__tags" href="/tags/%E5%AE%9D%E5%A1%94%E9%9D%A2%E6%9D%BF/">宝塔面板</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/blog2.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/11/17/PS-2%E9%94%AE%E7%9B%98%E6%8E%A5%E5%8F%A3/"><img class="prev-cover" src="http://cdn.shuifengche.top/PS2.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PS/2键盘接口</div></div></a></div><div class="next-post pull-right"><a href="/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/"><img class="next-cover" src="http://cdn.shuifengche.top/jiafa.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">大数的加法与乘法</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/07/28/水风车的博客1-0/" title="水风车的博客1.0"><img class="cover" src="http://cdn.shuifengche.top/blog1.jpeg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-07-28</div><div class="title">水风车的博客1.0</div></div></a></div><div><a href="/2019/09/21/PA1-数据的表示存取和运算/" title="PA1 数据的表示存取和运算"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-21</div><div class="title">PA1 数据的表示存取和运算</div></div></a></div><div><a href="/2019/11/22/gitbook部署到服务器/" title="gitbook部署到服务器"><img class="cover" src="http://cdn.shuifengche.top/gitbook.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-22</div><div class="title">gitbook部署到服务器</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/index/"/>
    <url>/2021/01/10/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>大数的加法与乘法 | 水风车的博客</title><meta name="keywords" content="算法,数据结构,字符串"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="无限长的两个整数如何加乘？"><meta property="og:type" content="article"><meta property="og:title" content="大数的加法与乘法"><meta property="og:url" content="https://blog.shuifengche.top/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="无限长的两个整数如何加乘？"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/jiafa.png"><meta property="article:published_time" content="2019-10-03T15:00:32.000Z"><meta property="article:modified_time" content="2019-12-12T06:31:20.689Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="算法"><meta property="article:tag" content="数据结构"><meta property="article:tag" content="字符串"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/jiafa.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-12 14:31:20'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95"><span class="toc-number">1.</span> <span class="toc-text">两个大数的加法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E4%B8%A4%E4%B8%AA%E5%BF%85%E8%A6%81%E5%87%BD%E6%95%B0%E7%9A%84%E5%87%86%E5%A4%87"><span class="toc-number">1.1.</span> <span class="toc-text">1、两个必要函数的准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%B0%86%E4%B8%A4%E4%B8%AA%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E4%B8%BA%E9%80%86%E5%BA%8F%E7%9A%84%E6%95%B4%E5%9E%8B%E6%95%B0%E7%BB%84"><span class="toc-number">1.2.</span> <span class="toc-text">2、将两个字符数组转换为逆序的整型数组</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E4%B8%A4%E4%B8%AA%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84%E7%9B%B8%E5%8A%A0"><span class="toc-number">1.3.</span> <span class="toc-text">3、两个字符数组相加</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%B0%86%E9%80%86%E5%BA%8F%E6%95%B4%E5%9E%8B%E6%95%B0%E7%BB%84%E8%BD%AC%E6%8D%A2%E4%B8%BA%E5%AD%97%E7%AC%A6%E6%95%B0%E7%BB%84"><span class="toc-number">1.4.</span> <span class="toc-text">4、将逆序整型数组转换为字符数组</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%A4%E4%B8%AA%E5%A4%A7%E6%95%B0%E7%9A%84%E4%B9%98%E6%B3%95"><span class="toc-number">2.</span> <span class="toc-text">两个大数的乘法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BE%E4%BE%8B%E8%AF%B4%E6%98%8E%E6%88%91%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-number">2.1.</span> <span class="toc-text">举例说明我的方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81"><span class="toc-number">2.2.</span> <span class="toc-text">代码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">3.</span> <span class="toc-text">最后</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/jiafa.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">大数的加法与乘法</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-10-03T15:00:32.000Z" title="undefined 2019-10-03 23:00:32">2019-10-03</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/">编程</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">907</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>3分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote><p>“大数”的意思就是理论上可以无限长，只要字符串存储的下就可以，远超过int、long、long long可以表示的范围的数。 </p></blockquote><h2 id="两个大数的加法"><a href="#两个大数的加法" class="headerlink" title="两个大数的加法"></a>两个大数的加法</h2><p>基本思路：<br>两个大数用字符串的形式输入，将字符串对应修改为存放每一位数字的数组，注意是逆序的数组，方便后续进行加法操作。直接对所有位进行加法，然后遍历一遍，有超过9的数字就往前进1，最终再把数组逆序输出即可。</p><h3 id="1、两个必要函数的准备"><a href="#1、两个必要函数的准备" class="headerlink" title="1、两个必要函数的准备"></a>1、两个必要函数的准备</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">char</span> <span class="title">C1</span><span class="params">(<span class="keyword">int</span> x)</span></span>;<span class="comment">//把0到9转换为&#x27;0&#x27;到&#x27;9&#x27;。</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">C2</span><span class="params">(<span class="keyword">char</span> x)</span></span>;<span class="comment">//相反</span></span><br><span class="line"><span class="comment">//直接用switch就可以了</span></span><br></pre></td></tr></table></figure><h3 id="2、将两个字符数组转换为逆序的整型数组"><a href="#2、将两个字符数组转换为逆序的整型数组" class="headerlink" title="2、将两个字符数组转换为逆序的整型数组"></a>2、将两个字符数组转换为逆序的整型数组</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">char_to_int</span><span class="params">(<span class="keyword">int</span> *b,<span class="keyword">char</span> *a,<span class="keyword">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//把长度为t的字符数组a逆序存储在整型数组b中，其余项初始化为0</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;t;i++)</span><br><span class="line">        b[i]=C2(a[t<span class="number">-1</span>-i]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=t;i&lt;N;i++)</span><br><span class="line">        b[i]=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3、两个字符数组相加"><a href="#3、两个字符数组相加" class="headerlink" title="3、两个字符数组相加"></a>3、两个字符数组相加</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> *c,<span class="keyword">int</span> *a,<span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        c[i]=a[i]+b[i];</span><br><span class="line">    &#125;<span class="comment">//不考虑进位问题，全部加一遍</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(c[i]&gt;<span class="number">9</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i&gt;=N<span class="number">-2</span>)</span><br><span class="line">                <span class="built_in">cerr</span> &lt;&lt; <span class="string">&quot;int[N] overflow&quot;</span> &lt;&lt; <span class="built_in">endl</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;<span class="comment">//哪一位进位了就把上一位加一，遍历的顺序是细节问题</span></span><br><span class="line">                c[i+<span class="number">1</span>]++;</span><br><span class="line">                c[i]-=<span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4、将逆序整型数组转换为字符数组"><a href="#4、将逆序整型数组转换为字符数组" class="headerlink" title="4、将逆序整型数组转换为字符数组"></a>4、将逆序整型数组转换为字符数组</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">int_to_char</span><span class="params">(<span class="keyword">char</span> *b,<span class="keyword">int</span> *a)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> t=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=N<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i]!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            t=i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;t;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        b[i]=C1(a[t<span class="number">-1</span>-i]);</span><br><span class="line">    &#125;</span><br><span class="line">    b[t]=<span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="两个大数的乘法"><a href="#两个大数的乘法" class="headerlink" title="两个大数的乘法"></a>两个大数的乘法</h2><p>乘法的本质就是对加法的简化表达，那我们就把它“复杂”回去！</p><p>加法写了那么多代码，不能浪费嘛。</p><h3 id="举例说明我的方法"><a href="#举例说明我的方法" class="headerlink" title="举例说明我的方法"></a>举例说明我的方法</h3><blockquote><p>987654321 * 12345</p></blockquote><p>我们先计算，987654321 * 5，然后计算9876543210 * 4，然后是98765432100 * 3……</p><p>这个时候就会发现，计算大数加法的时候的逆序数组真是方便啊！</p><p>把数组”右移一位“就多了个零。</p><p>而这个乘以5、乘以4、乘以3…我们直接用循环几次的”大数加法“就行。</p><h3 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">mul</span><span class="params">(<span class="keyword">int</span> *c,<span class="keyword">int</span> *a,<span class="keyword">int</span> *b)</span></span></span><br><span class="line"><span class="function"></span>&#123;<span class="comment">//a乘以b，存储在c里面</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;N;i++)</span><br><span class="line">        c[i]=<span class="number">0</span>;<span class="comment">//初始化，很重要！不然就会出现一堆莫名其妙的数字。</span></span><br><span class="line">    <span class="keyword">int</span> size=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=N<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">    &#123;<span class="comment">//计算一下这个b有多长，长度是size</span></span><br><span class="line">        <span class="keyword">if</span>(b[i]!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            size=i+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;size;i++)</span><br><span class="line">    &#123;<span class="comment">//外面的大循环，把b分成一位一位的，分别去乘以a</span></span><br><span class="line">        <span class="keyword">int</span> *aa=<span class="keyword">new</span> <span class="keyword">int</span>[N];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)</span><br><span class="line">            aa[j]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;N;j++)</span><br><span class="line">            aa[j]=a[j-i];</span><br><span class="line">          <span class="comment">//这两个循环是把a”右移“，就是在a的低位增加几个零，具体个数要看下面要乘的是b的哪一位</span></span><br><span class="line">      </span><br><span class="line">        <span class="keyword">int</span> x=b[i];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;x;j++)</span><br><span class="line">        &#123;<span class="comment">//直接调用大数的加法，省事</span></span><br><span class="line">            add(c,c,aa);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">free</span>(aa);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>减法与加法几乎是一样的，就不细说了。</p><p>大数的除法，我目前还不会，想一想感觉是比较麻烦的，因为”大数的乘法“我是想到了乘法与加法的关系才弄出来的，但除法的话感觉规律我还不懂，有机会我要学习一下，然后再水一篇文章（误）。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/">https://blog.shuifengche.top/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%AE%97%E6%B3%95/">算法</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a><a class="post-meta__tags" href="/tags/%E5%AD%97%E7%AC%A6%E4%B8%B2/">字符串</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/jiafa.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/10/15/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A22-0/"><img class="prev-cover" src="http://cdn.shuifengche.top/blog2.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">水风车的博客2.0</div></div></a></div><div class="next-post pull-right"><a href="/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/"><img class="next-cover" src="http://cdn.shuifengche.top/katelan.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">卡特兰数</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/05/30/P-NP和NPC问题/" title="P、NP与NPC问题的一些思考"><img class="cover" src="http://cdn.shuifengche.top/pnp.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-30</div><div class="title">P、NP与NPC问题的一些思考</div></div></a></div><div><a href="/2019/09/28/卡特兰数/" title="卡特兰数"><img class="cover" src="http://cdn.shuifengche.top/katelan.jpg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-28</div><div class="title">卡特兰数</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/index/"/>
    <url>/2021/01/10/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>卡特兰数 | 水风车的博客</title><meta name="keywords" content="卡特兰数,组合数学,递推问题,数据结构"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="我遇到了卡特兰数这个“难题”。"><meta property="og:type" content="article"><meta property="og:title" content="卡特兰数"><meta property="og:url" content="https://blog.shuifengche.top/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="我遇到了卡特兰数这个“难题”。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/katelan.jpg"><meta property="article:published_time" content="2019-09-28T03:56:56.000Z"><meta property="article:modified_time" content="2019-12-12T06:32:02.370Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="卡特兰数"><meta property="article:tag" content="组合数学"><meta property="article:tag" content="递推问题"><meta property="article:tag" content="数据结构"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/katelan.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-12 14:32:02'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%B7%E5%9B%A0"><span class="toc-number">1.</span> <span class="toc-text">起因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0%E7%9A%84%E4%BB%8B%E7%BB%8D"><span class="toc-number">2.</span> <span class="toc-text">卡特兰数的介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%92%E6%8E%A8%E5%85%AC%E5%BC%8F"><span class="toc-number">2.1.</span> <span class="toc-text">递推公式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0%E7%9A%84%E5%BA%94%E7%94%A8"><span class="toc-number">3.</span> <span class="toc-text">卡特兰数的应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BA%E6%A0%88%E5%BA%8F%E5%88%97%E7%9A%84%E7%A7%8D%E7%B1%BB"><span class="toc-number">3.1.</span> <span class="toc-text">出栈序列的种类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%B8%E5%A4%9A%E8%BE%B9%E5%BD%A2%E5%88%86%E5%89%B2%E6%88%90%E4%B8%89%E8%A7%92%E5%BD%A2"><span class="toc-number">3.2.</span> <span class="toc-text">凸多边形分割成三角形</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8A%82%E7%82%B9%E7%BB%84%E6%88%90%E4%BA%8C%E5%8F%89%E6%A0%91"><span class="toc-number">3.3.</span> <span class="toc-text">节点组成二叉树</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%A7%92%E7%BA%BF%E8%A1%8C%E8%B5%B0%E8%B7%AF%E7%BA%BF"><span class="toc-number">3.4.</span> <span class="toc-text">对角线行走路线</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E7%94%B3%EF%BC%9A%E6%B1%89%E5%85%8B%E5%B0%94%E7%9F%A9%E9%98%B5"><span class="toc-number">4.</span> <span class="toc-text">引申：汉克尔矩阵</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0%E7%9A%84%E6%9C%AC%E8%B4%A8%E6%8E%A2%E7%A9%B6"><span class="toc-number">5.</span> <span class="toc-text">卡特兰数的本质探究</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">6.</span> <span class="toc-text">最后</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/katelan.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">卡特兰数</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-09-28T03:56:56.000Z" title="undefined 2019-09-28 11:56:56">2019-09-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>5分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><blockquote><p>我又双叒叕碰到卡特兰数啦！</p></blockquote><p>本篇文章说一说我遇到的卡特兰数。</p><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>在数据结构的作业中遇到了一道“求出栈序列的个数”的题目，穷举的话会很可怕，想了好久也没弄出来。在网上一查，嗯，确实是递推的问题，只是递推公式比较复杂。我仔细一瞧，嘿！这结果居然是卡特兰数！正巧最近没啥想法，不如趁机整理一下这方面的题目吧 ！</p><h2 id="卡特兰数的介绍"><a href="#卡特兰数的介绍" class="headerlink" title="卡特兰数的介绍"></a>卡特兰数的介绍</h2><p>首先放一张卡特兰数规律的表格。</p><table><thead><tr><th></th><th></th><th></th><th></th><th></th><th>42</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td><td>14</td><td>42</td></tr><tr><td></td><td></td><td></td><td>5</td><td>14</td><td>28</td></tr><tr><td></td><td></td><td>2</td><td>5</td><td>9</td><td>14</td></tr><tr><td></td><td>1</td><td>2</td><td>3</td><td>4</td><td>5</td></tr><tr><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td><td>1</td></tr></tbody></table><p>在对角线上的就是卡特兰数，1、1、2、5、14、42……（第零项第一项都是1）</p><p>这个玩意儿是组合数学中的一个经典的数列，很重要，我一个学CS的都已经第二次遇到它了，<del>而且每次都没做出来</del></p><h3 id="递推公式"><a href="#递推公式" class="headerlink" title="递推公式"></a>递推公式</h3><p>$$<br>C_{n+1}=C_0C_n+C_1C_{n-1}+…+C_nC_0<br>$$</p><p>这个是最基本的递推关系，但有些复杂，下面是简化后的版本，但不太容易理解：<br>$$<br>C_n=C_n(4*n-2)/(n+1)<br>$$<br>解出来的结果是：<br>$$<br>C_n=C(2n,n)/(n+1)<br>$$</p><h2 id="卡特兰数的应用"><a href="#卡特兰数的应用" class="headerlink" title="卡特兰数的应用"></a>卡特兰数的应用</h2><h3 id="出栈序列的种类"><a href="#出栈序列的种类" class="headerlink" title="出栈序列的种类"></a>出栈序列的种类</h3><p>一道数据结构的作业题，好难……</p><blockquote><p>栈结构，后进先出，1到n共n个数进出栈，问有多少种出栈的顺序？</p></blockquote><p>当时题目设置n为6，结果是132，穷举的话很难准确完成。</p><p>所以这里面一定有什么规律，或者说一定是有递推关系的。</p><p>我们要思考的是如何把“大问题”分解成一个个“小问题”。</p><ul><li>n=1，1种。</li><li>n=2，2种；</li><li>n=3，5种。</li></ul><p>从n=4开始，我们可以分析递推关系了。</p><p>两个方向：</p><ul><li>按照1的出栈位次分类</li><li>按照第一个出栈的数分类</li></ul><p>我毫不犹豫的选了第二种，然后什么关系也没弄出来。</p><p>下面对于n=4按照第一种方法分类：</p><p>如果1第一个出来，那么剩余3个数，f(3)。</p><p>如果1最后一个出来，那么前三个已经出来了，f(3)。</p><p>如果1第二个出来，那么前面那个先出来，f(1)，后面还有两个，f(2)，所以是f(1)*f(2)。（这里我们可能会忽略f(1)这一个因子，不过如果再分析一下n=5的情况就明白这里应该是f(1)了。）</p><p>如果1第三个出来，那么前面f(2)，后面f(1)。</p><p>再对n=5一分析就能发现规律了！</p><p>得到的就是卡特兰数的基本递推公式。</p><h3 id="凸多边形分割成三角形"><a href="#凸多边形分割成三角形" class="headerlink" title="凸多边形分割成三角形"></a>凸多边形分割成三角形</h3><blockquote><p>将一个n条边的凸多边形区域分成三角形区域的方法数？</p></blockquote><p>n条边，砍一刀，变成一个i+1条边，一个n-i+1条边。<br>$$<br>f(n)=f(3)*f(n-1)+f(4)*f(n-2)+f(5)*f(n-3)+…+f(n-1)*f(3)<br>$$</p><h3 id="节点组成二叉树"><a href="#节点组成二叉树" class="headerlink" title="节点组成二叉树"></a>节点组成二叉树</h3><blockquote><p>给定n个节点，能构成多少种不同的二叉树？</p></blockquote><h3 id="对角线行走路线"><a href="#对角线行走路线" class="headerlink" title="对角线行走路线"></a>对角线行走路线</h3><blockquote><p>想象一张正方形格子地图，从左下角走到右上角，不”穿过“这条对角线的行走方式有多少种？</p></blockquote><p>这个是我刚才突然看到的熟悉的问题。</p><p>这应该是我第一次遇到卡特兰数的地方，在我高三做的排列组合题目时遇到的问题，当时在答案解析上看到”卡特兰数“这个名字，就觉得很厉害。</p><h2 id="引申：汉克尔矩阵"><a href="#引申：汉克尔矩阵" class="headerlink" title="引申：汉克尔矩阵"></a>引申：汉克尔矩阵</h2><p>n=4的汉克尔矩阵</p><table><thead><tr><th>1</th><th>1</th><th>2</th><th>5</th></tr></thead><tbody><tr><td>1</td><td>2</td><td>5</td><td>14</td></tr><tr><td>2</td><td>5</td><td>14</td><td>42</td></tr><tr><td>5</td><td>14</td><td>42</td><td>132</td></tr></tbody></table><p>无论n取多少，这个矩阵的行列式的值都为1。</p><p>进一步，移动一下。</p><p>n=4</p><table><thead><tr><th>1</th><th>2</th><th>5</th><th>14</th></tr></thead><tbody><tr><td>2</td><td>5</td><td>14</td><td>42</td></tr><tr><td>5</td><td>14</td><td>42</td><td>132</td></tr><tr><td>14</td><td>42</td><td>132</td><td>429</td></tr></tbody></table><p>它的行列式的值也是1。</p><p>很神奇吧！</p><h2 id="卡特兰数的本质探究"><a href="#卡特兰数的本质探究" class="headerlink" title="卡特兰数的本质探究"></a>卡特兰数的本质探究</h2><blockquote><p>Catalan 数出现在很多看似完全不同的计数问题中，证明方法亦有多种不同的角度。比如买票找零问题、格路径问题等多以通项公式证明，二叉树问题、凸多边形三角划分问题等多以递推公式证明等。————《卡特兰数的一种同构证明》上海机电学院 赵小玲</p></blockquote><p>网上有大量的文章整理收集卡特兰数的应用，我就只提了四种，不充当分母了。</p><p>这里有一篇论文，<a target="_blank" rel="noopener" href="http://www.cnki.com.cn/Article/CJFDTotal-FYJY201608155.htm">卡特兰数的一种同构证明</a>，我“摘录”其中的重要定理作为笔记。</p><ul><li>定理</li></ul><p>n个+1和n个-1组成的2n项的序列<br>$$<br>a_1、a_2、a_3…a_{2n}<br>$$<br>若其部分和满足<br>$$<br>a_1+a_2+a_3…+a_k&gt;=0<br>$$<br>则称之为可接受序列，则次序列的个数等于第n个卡特兰数。</p><p>（一针见血的指出了一部分问题的本质！）</p><p>格路径问题的证明：</p><blockquote><p> 非负整数n，从(0,0)到(n,n)的下对角线矩形格路径的条数等于第n个卡特兰数。</p></blockquote><p>把向上设为+1，向右设为-1，于是问题巧妙转化为可接受序列的问题了。</p><p>借书还书问题：</p><blockquote><p>图书馆排队，n人还同一本书，n人都要借同样的同一本书，整个过程图书馆没有缺书，问排队方式的种类？</p></blockquote><p>还书+1，借书-1，于是问题又巧妙地……</p><p>进栈出栈问题：</p><p>进栈+1，出栈-1，出栈顺序等价于可接受序列的种类。</p><p>卖东西找零问题：</p><blockquote><p>阿里有道题目，一个商品5元，8个人分别拿5元来买，又有8个人分别拿10元买1个，如果不出现无法找零的情况，有多少种排队方式？</p></blockquote><p>别看5和10不相等，其实本质还是一样的。</p><p>5元就是+1，10元就要找零，就是-1。</p><p>所以这里也是同样的思路。</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>看似毫不相关的几个问题，居然都指向了卡特兰数，数学是如此奇妙！</p><p>但深入讨论后不难发现，卡特兰数问题的本质便是“可接受序列的种类”的问题。</p><p>不要强行记忆那么多应用，而要找到本质，共同点，然后才能解决新问题。</p><p>最后，感谢<a target="_blank" rel="noopener" href="http://www.cnki.com.cn/Article/CJFDTotal-FYJY201608155.htm">这篇论文</a>的作者，让我更加深入的理解卡特兰数。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/">https://blog.shuifengche.top/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/">卡特兰数</a><a class="post-meta__tags" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/">组合数学</a><a class="post-meta__tags" href="/tags/%E9%80%92%E6%8E%A8%E9%97%AE%E9%A2%98/">递推问题</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/">数据结构</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/katelan.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/10/03/%E5%A4%A7%E6%95%B0%E7%9A%84%E5%8A%A0%E6%B3%95%E4%B8%8E%E4%B9%98%E6%B3%95/"><img class="prev-cover" src="http://cdn.shuifengche.top/jiafa.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">大数的加法与乘法</div></div></a></div><div class="next-post pull-right"><a href="/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/"><img class="next-cover" src="http://cdn.shuifengche.top/csapp.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Datalab 实验1</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/10/03/大数的加法与乘法/" title="大数的加法与乘法"><img class="cover" src="http://cdn.shuifengche.top/jiafa.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-10-03</div><div class="title">大数的加法与乘法</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/index/"/>
    <url>/2021/01/10/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Datalab 实验1 | 水风车的博客</title><meta name="keywords" content="PA,Datalab,CSAPP"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="计算机系统基础课程的datalab实验1记录。"><meta property="og:type" content="article"><meta property="og:title" content="Datalab 实验1"><meta property="og:url" content="https://blog.shuifengche.top/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="计算机系统基础课程的datalab实验1记录。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/csapp.png"><meta property="article:published_time" content="2019-09-23T08:42:38.000Z"><meta property="article:modified_time" content="2019-12-12T06:31:49.423Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="PA"><meta property="article:tag" content="Datalab"><meta property="article:tag" content="CSAPP"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/csapp.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-12 14:31:49'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%8B%E7%BB%8D"><span class="toc-number">1.</span> <span class="toc-text">介绍</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E4%B8%AA%E8%BF%87%E7%A8%8B"><span class="toc-number">2.</span> <span class="toc-text">整个过程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#bitAnd-int-a-int-b-1%E2%80%99"><span class="toc-number">2.1.</span> <span class="toc-text">bitAnd(int a,int b) 1’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#tmax-tmin-1%E2%80%99"><span class="toc-number">2.2.</span> <span class="toc-text">tmax&#x2F;tmin() 1’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#negate-int-x-2%E2%80%99"><span class="toc-number">2.3.</span> <span class="toc-text">negate(int x) 2’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#divpwr2-int-x-int-n-2%E2%80%99"><span class="toc-number">2.4.</span> <span class="toc-text">divpwr2(int x,int n) 2’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#byteSwap-int-x-int-n-int-m-2%E2%80%99"><span class="toc-number">2.5.</span> <span class="toc-text">byteSwap(int x,int n,int m) 2’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#replaceByte-int-x-int-n-int-c-3%E2%80%99"><span class="toc-number">2.6.</span> <span class="toc-text">replaceByte(int x,int n,int c) 3’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isLess-int-x-int-y-3%E2%80%99"><span class="toc-number">2.7.</span> <span class="toc-text">isLess(int x,int y) 3’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#rotateleft%EF%BC%88int-x-int-n"><span class="toc-number">2.8.</span> <span class="toc-text">rotateleft（int x,int n)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bang-int-x-4%E2%80%99"><span class="toc-number">2.9.</span> <span class="toc-text">bang(int x) 4’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#isPower2-int-x-4%E2%80%99"><span class="toc-number">2.10.</span> <span class="toc-text">isPower2(int x) 4’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#float-f2i-unsigned-uf-4%E2%80%99"><span class="toc-number">2.11.</span> <span class="toc-text">float_f2i(unsigned uf) 4’</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#float-half-unsigned-uf-4%E2%80%99"><span class="toc-number">2.12.</span> <span class="toc-text">float_half(unsigned uf) 4’</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">3.</span> <span class="toc-text">最后</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/csapp.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Datalab 实验1</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-09-23T08:42:38.000Z" title="undefined 2019-09-23 16:42:38">2019-09-23</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E9%AA%8C/">实验</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>我以为这门课的PA项目就已经足够了，没想到吧，中间又穿插着lab实验。</p><p>（每次做lab实验都像是在解谜，上一次做的是二进制炸弹，完成的不是很好，有时间重新做一下，再整理成文章发出来）</p><h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>实验1主要是在有限制的条件下编写所需要的功能函数，总计12个小函数。</p><p>限制条件包括但不限于：</p><p>操作限制：不得使用减法等</p><p>代码限制：不得使用循环、条件等</p><p>数据限制：仅能使用int和unsigned，并且大小限制在0-256之间。</p><p>操作数限制：每个函数最多使用特定的操作数个数，超过就不能编译。</p><p>……</p><h2 id="整个过程"><a href="#整个过程" class="headerlink" title="整个过程"></a>整个过程</h2><p>先挑简单的下手……</p><h3 id="bitAnd-int-a-int-b-1’"><a href="#bitAnd-int-a-int-b-1’" class="headerlink" title="bitAnd(int a,int b) 1’"></a>bitAnd(int a,int b) 1’</h3><p>用~和|实现&amp;。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m = ~(~(a)|(~b));</span><br></pre></td></tr></table></figure><h3 id="tmax-tmin-1’"><a href="#tmax-tmin-1’" class="headerlink" title="tmax/tmin() 1’"></a>tmax/tmin() 1’</h3><p>返回最大/最小的二进制补码整数</p><p>分别是0x7fffffff和0x8fffffff。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//最小值可以移位得到</span></span><br><span class="line">min = <span class="number">1</span> &lt;&lt; <span class="number">31</span>;</span><br><span class="line"><span class="comment">//最大值就是最小值取反</span></span><br><span class="line">max = ~(<span class="number">1</span> &lt;&lt; <span class="number">31</span>);</span><br></pre></td></tr></table></figure><p>注意：此次实验右移都是算术右移。</p><p>两个一分题解决了，下面来两分的！</p><h3 id="negate-int-x-2’"><a href="#negate-int-x-2’" class="headerlink" title="negate(int x) 2’"></a>negate(int x) 2’</h3><p>返回负的值，直接取反加一。</p><p>最小的负数没法弄，不过参数不应该是这个数，就不管了。</p><h3 id="divpwr2-int-x-int-n-2’"><a href="#divpwr2-int-x-int-n-2’" class="headerlink" title="divpwr2(int x,int n) 2’"></a>divpwr2(int x,int n) 2’</h3><blockquote><p>参考一篇文章：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/tlz888/p/9185403.html">为什么整数中负数的除法和右移不是一回事？</a></p></blockquote><p>计算x/2^n</p><p>==下面全都是错误示例，正确示例请看上面的文章==</p><p>我原本想着直接右移就行了，结果答案不正确，这才发现负数的右移结果并不等于它除以2，一直以来我竟然都没有在意过这个细节，今天遇上了。</p><p>负数右移，相当于负数+1后再除以2。</p><p>对于正数，我们直接右移。</p><p>对于负数，我们可以先取反加一，右移，再取反加一。</p><p>首先，如何判断正负？</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取符号位</span></span><br><span class="line"><span class="keyword">int</span> s = (x &gt;&gt; <span class="number">31</span>) &amp; <span class="number">0x1</span>;</span><br></pre></td></tr></table></figure><p>s==1时，取反加一移位再取反加一。</p><p>s==0时，移位。</p><p>但是，重点是，在条件语句不能使用的情况下，这样的分类能够实现吗？</p><p>我觉得很难。</p><p>没有条件语句的帮助，我们必须把这两种情况弄成完全一样的步骤，只能在其中的细节上有数值上的不同。</p><p>正数是直接右移n位，我们能不能把负数变一变，变成另一个数，这个数右移n位正好是要的结果呢？</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//对于负数</span></span><br><span class="line">result = ~((~x+<span class="number">1</span>)&gt;&gt;n)+<span class="number">1</span>;</span><br><span class="line"><span class="comment">//取反加一，右移n位，再取反加一</span></span><br><span class="line"><span class="comment">//好像“取反”和“右移”是可以交换的？？？确实是的！</span></span><br><span class="line">result = ~(~x+<span class="number">1</span>)&gt;&gt;n+<span class="number">1</span>;<span class="comment">//负数</span></span><br><span class="line">result = x&gt;&gt;n;<span class="comment">//正数</span></span><br><span class="line">result = ~(~x+<span class="number">0</span>)&gt;&gt;n+<span class="number">0</span>;<span class="comment">//正数</span></span><br></pre></td></tr></table></figure><p>看上面这两行代码，正数和负数的结果就只差了一个1，这个1不就是之前获取的符号位s吗？</p><p>所以我们有：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = ~(~x + s) &gt;&gt; n + s;</span><br></pre></td></tr></table></figure><p>别急！</p><p>我以为完美了，没想到一个测试用例n=0，出现了！</p><p>好，你厉害！我改还不行吗？</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = ~(~x + (s&amp;n)) &gt;&gt; n + (s&amp;n);</span><br></pre></td></tr></table></figure><p>我又以为没毛病了，又来了一个测试用例：x是最小的负数。</p><p>取反加一溢出了！！！</p><blockquote><p>注：补码表示法中，负数比正数多1个</p></blockquote><p>后果就是：</p><p>上面我说的一大堆“取反加一”的方法完全失效！</p><p>最后乖乖地选择了主流的“偏置法”了……</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = (x + <span class="number">2</span>^n - <span class="number">1</span>) &gt;&gt; n;</span><br></pre></td></tr></table></figure><h3 id="byteSwap-int-x-int-n-int-m-2’"><a href="#byteSwap-int-x-int-n-int-m-2’" class="headerlink" title="byteSwap(int x,int n,int m) 2’"></a>byteSwap(int x,int n,int m) 2’</h3><p>交换第n个和第m个“字节”，注意是字节，一个字节有8位二进制码。</p><p>比如交换0x12345678的第一位和第3位，得到0x56341278</p><p>下面是我的思路</p><p>总体目标是得到下面两个中间值：</p><p>0x00340078：把要交换的两项清空。</p><p>0x56001200：抠出这两项，并交换位置放置。</p><p>第一步：右移，抠出要交换的两小节放在末尾，得到0x12和0x56。</p> <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = <span class="number">0xff</span> &amp; (x &gt;&gt; (<span class="number">8</span>*n));</span><br><span class="line"><span class="keyword">int</span> b = <span class="number">0xff</span> &amp; (x &gt;&gt; (<span class="number">8</span>*m));</span><br></pre></td></tr></table></figure><p>第二步，按照对方的右移位数，再左移回去，并得到0x56001200。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">a = a &lt;&lt; (<span class="number">8</span>*m);</span><br><span class="line">b = b &lt;&lt; (<span class="number">8</span>*n);</span><br><span class="line">a = a ^ b;<span class="comment">//合并</span></span><br></pre></td></tr></table></figure><p>第三步，在x中把要交换的两项清空，得到0x00340078。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> c = <span class="number">0xff</span> &lt;&lt; (<span class="number">8</span>*n);</span><br><span class="line"><span class="keyword">int</span> d = <span class="number">0xff</span> &lt;&lt; (<span class="number">8</span>*m);</span><br><span class="line">c = c ^ d;<span class="comment">//合并得到0xff00ff00</span></span><br><span class="line">c = ~c;<span class="comment">//取反更方便后续操作0x00ff00ff</span></span><br></pre></td></tr></table></figure><p>第四步，组合在一起，得到结果。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = (x &amp; c) ^ a;</span><br></pre></td></tr></table></figure><p>到这里，两分的题目都完成了，大部分时间都在弄那个divpwr2，因为边界条件的问题。而且我很怀疑它可能只有唯一解。</p><h3 id="replaceByte-int-x-int-n-int-c-3’"><a href="#replaceByte-int-x-int-n-int-c-3’" class="headerlink" title="replaceByte(int x,int n,int c) 3’"></a>replaceByte(int x,int n,int c) 3’</h3><p>把x的第n个字节换成c，这就是上面那个交换函数的一部分。不说了，上代码。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> n_8 = n &lt;&lt; <span class="number">3</span>;</span><br><span class="line"><span class="keyword">int</span> a = <span class="number">0xff</span> &lt;&lt; n_8;</span><br><span class="line">a = ~a;</span><br><span class="line">x = x &amp; a;</span><br><span class="line">x = x ^ (c &lt;&lt; n_8);</span><br></pre></td></tr></table></figure><h3 id="isLess-int-x-int-y-3’"><a href="#isLess-int-x-int-y-3’" class="headerlink" title="isLess(int x,int y) 3’"></a>isLess(int x,int y) 3’</h3><p>这个很难，折磨了我好长时间，找了各种教程都说的不是很清楚。</p><p>我今天非要给它弄懂并讲明白。</p><p>第一步就可以分类为同号和异号两种情况。</p><p>异号的话直接就是正数大。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//获取两个符号</span></span><br><span class="line"><span class="keyword">int</span> s1 = <span class="number">0x1</span> &amp; (x &gt;&gt; <span class="number">31</span>);</span><br><span class="line"><span class="keyword">int</span> s2 = <span class="number">0x1</span> &amp; (y &gt;&gt; <span class="number">31</span>);</span><br><span class="line">result = (s1 ^ s2) &amp; s1;</span><br><span class="line"><span class="comment">//s1 ^ s2，两者异或，判断是否相等。</span></span><br><span class="line"><span class="comment">//相等则同号，不等则异号，异号了之后结果与s1相同。</span></span><br></pre></td></tr></table></figure><p> 下面看同号，这个最麻烦，要作差，就x-y吧。</p><p>不让用减号，那就补码加吧。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> z = x + ~y + <span class="number">1</span>;</span><br></pre></td></tr></table></figure><p>这里开始出现问题了，由于负数比正数多一个（没错，又是它，总是隔一段时间出来恶心我一下），如果对最小的负数进行取反加一，那么就会溢出，得到错误结果。</p><p>我在网上查这道题，没找到一个具体讨论这个恶心的情况的文章。但都通过了？结论就是我因为一些细节没注意到，结果被边界值卡住了。</p><p>下面给代码。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">isLess</span><span class="params">(<span class="keyword">int</span> x,<span class="keyword">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"><span class="keyword">int</span> s1 = <span class="number">0x1</span> &amp; (x &gt;&gt; <span class="number">31</span>);</span><br><span class="line"><span class="keyword">int</span> s2 = <span class="number">0x1</span> &amp; (y &gt;&gt; <span class="number">31</span>);</span><br><span class="line"><span class="keyword">int</span> s = s1 ^ s2;<span class="comment">//判断二者是否相等</span></span><br><span class="line">  <span class="keyword">int</span> z = x + ~y + <span class="number">1</span>;<span class="comment">//作差</span></span><br><span class="line">  <span class="keyword">int</span> r = (s &amp; s1) | ((!s) &amp; (<span class="number">0x1</span> &amp; (z &gt;&gt; <span class="number">31</span>)));</span><br><span class="line">  <span class="keyword">return</span> r; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>所以，虽然0x80000000取反加一后会溢出，但实际上，溢出后还是0x80000000，完全不影响作差的计算，下面说原因。</p><p>如果x是0x80000000，y是一个比x大一点的负数，那么作差之后是负数。</p><p>如果y是0x80000000，x是一个比y大一点的负数，y取反加一后还是本身，相当于x加上0x80000000，一个负数加上一个负数，结果溢出变成了正数，符号位是0，而x也确实比y大。</p><p>综上，取反加一时恶心人的0x80000000根本不影响此题的结果。</p><p>那我为什么在这上面耗了大量时间，因为我之前的算法就是错的，同时测试用例都是一些边界值，让我误以为“我算法没问题，就差边界情况没考虑了”。</p><p>记住这个教训吧……</p><h3 id="rotateleft（int-x-int-n"><a href="#rotateleft（int-x-int-n" class="headerlink" title="rotateleft（int x,int n)"></a>rotateleft（int x,int n)</h3><p>循环左移。</p><p>这个貌似也和上面的交换差不多。</p><p>举例说明我的思路：</p><p>0x12345678，左移8位。</p><p>目标是得到一个0x34567800和一个0x00000012。</p><p>前者直接由原数左移n位得到。</p><p>后者应该：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> a = (~<span class="number">0</span>) &lt;&lt; n;<span class="comment">//生成0x11111100</span></span><br><span class="line"><span class="keyword">int</span> b = ~a;<span class="comment">//变成0x00000011</span></span><br><span class="line"><span class="keyword">int</span> c = b &lt;&lt; (<span class="number">32</span> + ~n + <span class="number">1</span>);<span class="comment">//左移到高位</span></span><br><span class="line"><span class="keyword">int</span> d = c &amp; x;<span class="comment">//把高n位拷贝下来</span></span><br><span class="line"><span class="keyword">int</span> e = d &gt;&gt; (<span class="number">32</span> + ~n + <span class="number">1</span>);<span class="comment">//右移回低位</span></span><br><span class="line"><span class="comment">//注意：c语言对于带符号整数只进行算数右移</span></span><br><span class="line"><span class="keyword">int</span> f = e &amp; b;<span class="comment">//把可能出现的高的符号位截掉</span></span><br></pre></td></tr></table></figure><p>然后两个数进行 按位或 就行了就可以了。</p><p>写到这里我才发现应该使用按位或，而我之前的操作一直把按位异或和按位或搞混了，居然没出现问题。</p><p>原因是在这些情况下这两种操作的结果相同，或者说在截断、拼接、拷贝二进制数串时的很多操作的异或、或的效果相同。</p><p>以后一定要注意这个细节，更清楚明白到底选哪一种。</p><p>三分的题目结束，冲向最后四道题！</p><h3 id="bang-int-x-4’"><a href="#bang-int-x-4’" class="headerlink" title="bang(int x) 4’"></a>bang(int x) 4’</h3><p>compute !x without using !</p><p>想一想，结果返回的只能是1或0，我们猜测在这之前一定有截断操作，即&amp;0x1。</p><p>然后想一想，哪一位上的数字能区分0和其他？</p><p>不是最后一位，是最高位，因为任何一个数取反加一后最高位都会发生改变，除了0和0x80000000。</p><p>0：从0到0</p><p>0x80000000：从1到1</p><p>其他：从0到1，或从1到0</p><p>由此我们可以用“|”操作解决这个问题。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">result = (~((~x + <span class="number">1</span>) | x) &gt;&gt; <span class="number">31</span>) &amp; <span class="number">0x1</span>;</span><br></pre></td></tr></table></figure><h3 id="isPower2-int-x-4’"><a href="#isPower2-int-x-4’" class="headerlink" title="isPower2(int x) 4’"></a>isPower2(int x) 4’</h3><p>如果是2的幂次，就返回1，否则返回0。</p><p>即x的各位数字中1的个数为1或0时，返回1，否则返回0。</p><p>2的倍数有个特点，只有一位是1，如何利用这个特点呢？</p><p>我没想出来。</p><p>网上给出的办法：</p><p>x &amp; x-1 == 0</p><p>然后接下来就用上面bang的方法了。</p><p>另外，还要要求这个数大于0，可以提前判断一下。</p><p>所以代码是：</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> s = <span class="number">0x1</span> &amp; (x &gt;&gt; <span class="number">31</span>);</span><br><span class="line"><span class="keyword">int</span> a = x + ~<span class="number">1</span> + <span class="number">1</span>;</span><br><span class="line"><span class="keyword">int</span> b = a <span class="number">7</span> x;</span><br><span class="line"><span class="keyword">int</span> r = (~((~b + <span class="number">1</span>) | b) &gt;&gt; <span class="number">31</span>) &amp; <span class="number">0x1</span>;</span><br><span class="line">r = (!s) &amp; r &amp; (!!x);</span><br><span class="line"><span class="keyword">return</span> r;</span><br></pre></td></tr></table></figure><h3 id="float-f2i-unsigned-uf-4’"><a href="#float-f2i-unsigned-uf-4’" class="headerlink" title="float_f2i(unsigned uf) 4’"></a>float_f2i(unsigned uf) 4’</h3><p>这个函数是把一个32位无符号数看做单精度浮点数，返回它对应的int的值。</p><p>第一步，取出浮点数的三个部分。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> sign = <span class="number">0x1</span> &amp; (uf &gt;&gt; <span class="number">31</span>);</span><br><span class="line"><span class="keyword">int</span> <span class="built_in">exp</span> = <span class="number">0xff</span> &amp; (uf &gt;&gt; <span class="number">23</span>);</span><br><span class="line"><span class="keyword">int</span> frac = (uf &amp; <span class="number">0x007fffff</span>) ^ <span class="number">0x00800000</span>;</span><br><span class="line"><span class="comment">//补上隐藏位1，隐藏位是0的浮点数都太小了，直接返回0</span></span><br></pre></td></tr></table></figure><p>第二步，判断边界。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">exp</span> &lt; <span class="number">127</span>)</span><br><span class="line"><span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(<span class="built_in">exp</span> &gt; <span class="number">127</span> + <span class="number">31</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0x80000000</span>u;</span><br></pre></td></tr></table></figure><p>第三步，剩下的按照符号位正负分类。</p><p>正数直接移动移动(exp-150)位，正则左，负则右。</p><p>负数在移动后，还要取反加一变成补码形式。</p><h3 id="float-half-unsigned-uf-4’"><a href="#float-half-unsigned-uf-4’" class="headerlink" title="float_half(unsigned uf) 4’"></a>float_half(unsigned uf) 4’</h3><p>参数是一个无符号类型的单精度浮点数，要求求出它的实际值的一半并仍然按照无符号类型的单精度浮点数返回。</p><p>只要熟悉符号位、阶码、尾数，并了解非规格化与规格化浮点数的定义和区别即可。</p><p>第一步，取出浮点数的三个部分。</p><p>同上。不放代码了。这次先不补隐藏位。</p><p>第二步，分类讨论。</p><ul><li>exp==0</li></ul><p>要变为实际值的一半，直接把尾数右移一位即可，不过要注意一个问题，就是舍入。对浮点数的尾数进行右移操作时，要遵循一个原则，如果最后两位是01，舍去，11，则保留，如果是10就要考虑凑偶数。</p><p>即末尾110，移位后要进一位，末尾010，移位后则不进一。</p><p>这个细节是在我失败多次后才意识到的，所以做实验前一定要好好看书。</p><ul><li>exp!=0</li></ul><p>规格化数，变为一半，就把阶码减一。</p><p>减一之后就要考虑一个问题了，减一之后变成零的话，就不是规格化数了。</p><p>如果exp减去1变成零，需要把尾数右归（同时考虑舍入），并且添加隐藏位。</p><p>否则，不做其他操作。</p><p>结束。</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>这个实验，12道题，我从早上做到晚上，花费了很长时间，有些问题也确实是绞尽脑汁后去查了网上的答案。</p><p>但这不重要，我觉得这个实验的目的值得思考。</p><p>和PA的大项目一样，这些实验都是给了你一个完整地框架，然后让你从一些细节开始，一步步完善这个框架，每写完一部分，你对整个框架的理解就会越来越清晰，PA1结束后，你会有一种感觉，“我居然编写了一个ALU！”。</p><p>这次的lab实验也是这样，每个函数都在考察一些小细节，每一点你都要注意到，最终一步步完成任务。就像开头说的，lab实验又像是在解密，努力通关，生命无限次。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/">https://blog.shuifengche.top/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PA/">PA</a><a class="post-meta__tags" href="/tags/Datalab/">Datalab</a><a class="post-meta__tags" href="/tags/CSAPP/">CSAPP</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/csapp.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/09/28/%E5%8D%A1%E7%89%B9%E5%85%B0%E6%95%B0/"><img class="prev-cover" src="http://cdn.shuifengche.top/katelan.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">卡特兰数</div></div></a></div><div class="next-post pull-right"><a href="/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/"><img class="next-cover" src="http://cdn.shuifengche.top/i386.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">PA1 数据的表示存取和运算</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/09/21/PA1-数据的表示存取和运算/" title="PA1 数据的表示存取和运算"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-21</div><div class="title">PA1 数据的表示存取和运算</div></div></a></div><div><a href="/2019/11/19/PA2-程序的执行/" title="PA2 程序的执行"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-19</div><div class="title">PA2 程序的执行</div></div></a></div><div><a href="/2020/01/20/PA3-存储管理/" title="PA3-存储管理"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-20</div><div class="title">PA3-存储管理</div></div></a></div><div><a href="/2020/01/20/PA4-异常中断与IO/" title="PA4-异常中断与IO"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-20</div><div class="title">PA4-异常中断与IO</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/index/"/>
    <url>/2021/01/10/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>PA1 数据的表示存取和运算 | 水风车的博客</title><meta name="keywords" content="PA,CPU,ALU,FPU,git"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="PA 2019秋季实验系列之PA 1"><meta property="og:type" content="article"><meta property="og:title" content="PA1 数据的表示存取和运算"><meta property="og:url" content="https://blog.shuifengche.top/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="PA 2019秋季实验系列之PA 1"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/i386.png"><meta property="article:published_time" content="2019-09-21T03:13:35.000Z"><meta property="article:modified_time" content="2020-01-20T14:54:42.274Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="PA"><meta property="article:tag" content="CPU"><meta property="article:tag" content="ALU"><meta property="article:tag" content="FPU"><meta property="article:tag" content="git"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/i386.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2020-01-20 22:54:42'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#PA0-%E9%85%8D%E7%BD%AEDebian%E7%8E%AF%E5%A2%83"><span class="toc-number">1.</span> <span class="toc-text">PA0 配置Debian环境</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B0%86%E7%94%A8%E6%88%B7%E5%8A%A0%E5%85%A5sudo%E5%88%97%E8%A1%A8"><span class="toc-number">1.1.</span> <span class="toc-text">将用户加入sudo列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%BF%85%E8%A6%81%E7%9A%84%E5%B7%A5%E5%85%B7"><span class="toc-number">1.2.</span> <span class="toc-text">安装必要的工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96PA%E9%A1%B9%E7%9B%AE%E7%9A%84%E4%BB%A3%E7%A0%81%E6%A1%86%E6%9E%B6"><span class="toc-number">1.3.</span> <span class="toc-text">获取PA项目的代码框架</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PA1-1-%E6%95%B0%E6%8D%AE%E5%9C%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%86%85%E7%9A%84%E5%AD%98%E5%82%A8"><span class="toc-number">2.</span> <span class="toc-text">PA1-1 数据在计算机内的存储</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%84%E5%AD%98%E5%99%A8%E7%9A%84%E6%A8%A1%E6%8B%9F"><span class="toc-number">2.1.</span> <span class="toc-text">寄存器的模拟</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%AD%98%E7%9A%84%E6%A8%A1%E6%8B%9F"><span class="toc-number">2.2.</span> <span class="toc-text">主存的模拟</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PA1-2-%E6%95%B4%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA%E3%80%81%E5%AD%98%E5%82%A8%E5%92%8C%E8%BF%90%E7%AE%97"><span class="toc-number">3.</span> <span class="toc-text">PA1-2 整数的表示、存储和运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%A0%E7%A7%8D%E6%A0%87%E5%BF%97%E4%BD%8D"><span class="toc-number">3.1.</span> <span class="toc-text">几种标志位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8A%A0%E5%87%8F"><span class="toc-number">3.2.</span> <span class="toc-text">加减</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A7%BB%E4%BD%8D"><span class="toc-number">3.3.</span> <span class="toc-text">移位</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%BB%E8%BE%91"><span class="toc-number">3.4.</span> <span class="toc-text">逻辑</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B9%98%E9%99%A4"><span class="toc-number">3.5.</span> <span class="toc-text">乘除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PA1-3-%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%92%8C%E8%BF%90%E7%AE%97"><span class="toc-number">4.</span> <span class="toc-text">PA1-3 浮点数的表示和运算</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E8%A1%A8%E7%A4%BA"><span class="toc-number">4.1.</span> <span class="toc-text">浮点数的表示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E5%8A%A0%E5%87%8F%E4%B9%98%E9%99%A4"><span class="toc-number">4.2.</span> <span class="toc-text">浮点数的加减乘除</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">5.</span> <span class="toc-text">最后</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/i386.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">PA1 数据的表示存取和运算</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-09-21T03:13:35.000Z" title="undefined 2019-09-21 11:13:35">2019-09-21</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E9%AA%8C/">实验</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">3.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>10分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>PA是我们学校计算机系大二年级的一门硬核实验课，由四个主要部分组成，分别是：</p><ul><li>PA 1 数据的表示、存取和运算</li><li>PA 2 程序的执行</li><li>PA 3 存储管理</li><li>PA 4 异常、中断与I/O</li></ul><p>这四个阶段大致对应模拟器中对CPU、MMU和Device的模拟。</p><p>该实验主要是作为《计算机系统基础》这门课的辅助性课程。</p><p>老师提供了实验手册以及已经很完善的程序代码框架，我们要做的只是按照实验手册的要求，去特定的文件中编写一些关键的函数。</p><p>这次的博客系列文章主要用于记录我的PA实验过程，一方面想要记录下自己在这些方面做过的第一个实验，另一方面也希望通过记录的过程去复习、巩固以及加深对相关知识的理解。</p><p>那么我们开始吧！</p><h2 id="PA0-配置Debian环境"><a href="#PA0-配置Debian环境" class="headerlink" title="PA0 配置Debian环境"></a>PA0 配置Debian环境</h2><p>安装Debian虚拟机，方法与我之前的一篇文章“linux虚拟机安装”类似。</p><p>选择Debian 10的i386版本，在虚拟机软件vmware/virtual box的辅助下完成Debian虚拟机的创建。</p><h3 id="将用户加入sudo列表"><a href="#将用户加入sudo列表" class="headerlink" title="将用户加入sudo列表"></a>将用户加入sudo列表</h3><p>在终端输入以下指令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">su -root</span><br><span class="line">&#x2F;&#x2F;input your password</span><br><span class="line">adduser your_username sudo</span><br><span class="line">exit</span><br></pre></td></tr></table></figure><p>然后注销用户，重新登录用户，就成功将该用户加入sudo列表了。</p><h3 id="安装必要的工具"><a href="#安装必要的工具" class="headerlink" title="安装必要的工具"></a>安装必要的工具</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential libreadline-dev libsdl1.2-dev vim git tmux dialog python python-rsa openssl</span><br></pre></td></tr></table></figure><p>复制粘贴等一等就完事了。</p><h3 id="获取PA项目的代码框架"><a href="#获取PA项目的代码框架" class="headerlink" title="获取PA项目的代码框架"></a>获取PA项目的代码框架</h3><p>老师使用了Gitlab网站来管理，使用下来感觉和GitHub区别不大。</p><p>弄好仓库，配置SSH keys，然后完成一项任务就push下就OK了。</p><h2 id="PA1-1-数据在计算机内的存储"><a href="#PA1-1-数据在计算机内的存储" class="headerlink" title="PA1-1 数据在计算机内的存储"></a>PA1-1 数据在计算机内的存储</h2><p>这一节的内容主要是模拟寄存器和主存。</p><h3 id="寄存器的模拟"><a href="#寄存器的模拟" class="headerlink" title="寄存器的模拟"></a>寄存器的模拟</h3><p>我们的实验模拟的是i386体系结构，这里需要8个32位寄存器。</p><p>首先我们定义了一个全局的结构变量CPU_STATUS，并实体化为cpu，目标是：可以用cpu.eax访问寄存器%eax，并且可以用cpu.gpr[0]._16访问到cpu.eax的低16位，用cpu.gpr[0]._8[0]访问cpu.eax的低8位。</p><p>为了实现用不同的访问方式访问同一变量以及该变量的部分内容，我们选择了union。</p><p>对比一下struct与union</p><ul><li>struct：内部各个变量的存储相互独立</li><li>union：各变量共同拥有同一个空间，但只占用自身大小</li></ul><p>下面是结构CPU_STATUS的定义。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">union</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">union</span></span><br><span class="line">    &#123;</span><br><span class="line">      uint32_t_32;</span><br><span class="line">      uint16_t_16;</span><br><span class="line">      uint8_t_8[<span class="number">2</span>];</span><br><span class="line">&#125;;</span><br><span class="line">    <span class="keyword">uint32_t</span> val;</span><br><span class="line">&#125;;</span><br><span class="line">  gpr[<span class="number">8</span>];</span><br><span class="line">  <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">  &#123;</span></span><br><span class="line">    <span class="keyword">uint32_t</span> eax,ecx,edx,ebx,esp,ebp,esi,edi;</span><br><span class="line">&#125;;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="主存的模拟"><a href="#主存的模拟" class="headerlink" title="主存的模拟"></a>主存的模拟</h3><p>约定我们的NEMU拥有128MB字节的内存，我们可以定义一个这么大的数组。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MEM_SIZE_B 128*1024*1024</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">uint8_t</span> hw_mem[MEM_SIZE_B];</span><br></pre></td></tr></table></figure><p>这样主存的物理空间就模拟好了，我们还需要定义一些函数用于对主存的读写操作。</p><p>主要有物理地址读写、线性地址读写和虚拟地址读写三类函数，但项目说明中提到“在NEMU工作模式下，这三种地址相同”，所以简化了这些函数的构造。这些东西将会在后续实验中再次出现。</p><h2 id="PA1-2-整数的表示、存储和运算"><a href="#PA1-2-整数的表示、存储和运算" class="headerlink" title="PA1-2 整数的表示、存储和运算"></a>PA1-2 整数的表示、存储和运算</h2><p>这一节我们要用C语言实现32位无符号整数、有符号整数的加减、乘除、移位、逻辑运算，这中间需要我们自己设置EFLAGS标志位——ZF\CF\OF\SF\PF等等。</p><h3 id="几种标志位"><a href="#几种标志位" class="headerlink" title="几种标志位"></a>几种标志位</h3><p>ZF：结果为0时ZF为1，否则ZF为0。</p><p>PF：结果的低八位中1的个数的奇偶性，偶1奇0。</p><p>SF：即结果的符号位。</p><p>以上三种标志位对于本节的大部分函数是通用的。</p><p>CF与OF：</p><p>这两个要特别说一下。</p><p>计算CF时，要把两个操作数的机器码视作无符号整数，在此情况下考虑是否溢出；计算OF时，要把两个操作数的机器码视作带符号整数，然后去看是否溢出。</p><p>当然，上面的说法不是他们的本质（CF的C是carry，OF的O是overflow），但这样的解释能让我更容易计算CF和OF的值。</p><p>一般情况下，机器并不知道你的操作数是否带符号，所以它不得不按照无符号、带符号两种方式都判断一下，提供给调用者两个结果，让调用者自己选择。</p><h3 id="加减"><a href="#加减" class="headerlink" title="加减"></a>加减</h3><p>本来我们应该分别实现无符号数的加减法以及带符号数的加减法，但在采用了补码表示法之后，带符号与无符号的整数加减法可以统一使用无符号整数的加减法来执行，因此我们只需实现无符号数的加减法操作即可。</p><p>主要涉及add、adc、sub、sbb四种指令。</p><p>add是dest+src，adc则是dest+src+CF，多加了一个CF位；同样，sbb比sub多减了一个CF。因此，计算CF的值时，adc比add要多考虑一种特殊情况。但OF的计算，则完全一样。</p><p>以sbb函数为例大概说一下。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">uint32_t</span> <span class="title">alu_adc</span><span class="params">(<span class="keyword">uint32_t</span> src,<span class="keyword">uint32_t</span> dest,<span class="keyword">size_t</span> data_size)</span></span></span><br></pre></td></tr></table></figure><p>参数是两个32位的无符号整数src、dest和具体的操作数长度data_size（8、16或32）。</p><p>OF的设置：</p><p>考虑OF时把dest、src视为带符号数，正数减正数、负数减负数都不会溢出，只有负数减正数或者正数减负数会溢出，而且结果应该和被减数不同号。</p><p>此处忽略sbb比sub多减了CF这个细节。（具体原因我暂时不懂）</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">OF = (sign(dest)!=sign(src)) &amp;&amp; (sign(result)==sign(src)); </span><br></pre></td></tr></table></figure><p>CF的设置：</p><p>考虑CF时把dest、src视为无符号数，两个无符号数相减，再减去一个CF，如果CF==0，那么和sub一样，否则就会出现一种特殊情况：</p><p>设32位无符号整数能表示的最大值是max，若src==max-1，则dest - src - CF == dest，这一种溢出的情况也要考虑到。</p><h3 id="移位"><a href="#移位" class="headerlink" title="移位"></a>移位</h3><p>我们的代码都是用C语言编写的。</p><p>C语言中对于无符号、带符号整数的移位采用相同的符号、不同的操作。</p><p>如果对无符号整数进行“&lt;&lt;”操作，就是逻辑左移；如果对带符号整数进行“&lt;&lt;”，则是算术右移。</p><p>这个实验给我们提供的参数是一个32位的无符号整数dest，要实现对它的逻辑左右移和算术左右移。</p><p>逻辑右/算术右：直接对dest进行”&gt;&gt;”即可。</p><p>逻辑左：dest是无符号数，直接对其“&lt;&lt;”即可。</p><p>算术右：</p><p>这里需要把dest强制类型转换为带符号整数，而且，dest是一个32位的无符参数，但它的实际位数是data_size，所以如果我们直接”&lt;&lt;”，系统会认为它的符号位是第31位，而实际上可能是第7位或者第15位。</p><p>因此整个过程是，先强制类型转换变成带符号数，然后把这个32位数截断成它自身的长度，进行左移完成后，再扩展回原来的32位。</p><h3 id="逻辑"><a href="#逻辑" class="headerlink" title="逻辑"></a>逻辑</h3><p>and、or、not、xor</p><p>比较简单，不再细说。</p><h3 id="乘除"><a href="#乘除" class="headerlink" title="乘除"></a>乘除</h3><p>无符号乘法、带符号乘法、无符号除法、带符号除法，以及额外添加的无符号模和带符号模运算。</p><p>i386手册中对于带符号乘法的标志位设置比较模糊，所以就不做设置了。</p><p>除法、模运算也不用设置标志位，所以没啥说的了。</p><p>强制类型转换就完事了。</p><h2 id="PA1-3-浮点数的表示和运算"><a href="#PA1-3-浮点数的表示和运算" class="headerlink" title="PA1-3 浮点数的表示和运算"></a>PA1-3 浮点数的表示和运算</h2><p>这次实验要实现的是单精度浮点数Float的加减乘除运算，整个过程中禁止使用类型转换，禁止使用C语言中对浮点数的操作，必须在机器码的状态下实现浮点数的四则运算。</p><h3 id="浮点数的表示"><a href="#浮点数的表示" class="headerlink" title="浮点数的表示"></a>浮点数的表示</h3><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">union</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">    &#123;</span></span><br><span class="line">        <span class="keyword">uint32_t</span> fraction : <span class="number">23</span>;</span><br><span class="line">        <span class="keyword">uint32_t</span> exponent : <span class="number">8</span>;</span><br><span class="line">        <span class="keyword">uint32_t</span> sign : <span class="number">1</span>;</span><br><span class="line">  &#125;;</span><br><span class="line">  <span class="keyword">float</span> fval;</span><br><span class="line">  <span class="keyword">uint32_t</span> val;</span><br><span class="line">&#125;FLOAT;</span><br></pre></td></tr></table></figure><p>此处有一个C语言的知识点叫“位域”。</p><p>比如exponent这个变量，虽然它是uint32_t类型的，但我只需要8个字节的空间，就可以这样来写。</p><p>总体来看，struct的总空间依旧是32位，由于外部是union类型，所以可以直接通过变量val访问struct的32位机器码（用于做实验），还可以通过fval直接访问该浮点数（用于测试）。</p><h3 id="浮点数的加减乘除"><a href="#浮点数的加减乘除" class="headerlink" title="浮点数的加减乘除"></a>浮点数的加减乘除</h3><p>实验指导中非常详细的介绍了，我就大概讲一下我的理解吧。</p><p>两个单精度浮点数相加</p><p>变量a：1、8、23</p><p>变量b：1、8、23</p><p>第一步，排除掉特殊情况。比如说其中一个数是正负零，或者正负无穷，或者NaN（非数值）。这些情况可以直接得出结果了。</p><p>第二步，提取尾数。把变量的尾数23位提取出来（存储在uint32_t变量中），把隐藏位添加上去，非规格化数隐藏位是0，规格化数隐藏位是1。</p><p>第三步，阶码对齐。加法的话，谁的阶码大，谁的值就大，要把阶码小的变量的尾数变小，阶码变大，一直到对齐。</p><p>第四步，确保精度。上一步要求移动尾数，这样会丢弃末尾的一部分数据，为了保证计算的精度，我们在变量的尾数后再添加3个字节位，也参与运算，已增加加法的精度。（如何添加3位？可以左移三位，这样尾部就空出来3位了）这三位是G、R、S位，S位又叫做“粘滞位”，只要S位变为1，它就一直是1了。（原理我还不懂，但感觉为了计算的精度，这样做也挺有道理的）</p><p>第五步，尾数相加，并规格化。我们为什么要规格化？尾数相加之后，可能出现进位，导致尾数超出或者少于23+3位（grs三位），这样的话我们就该把它移回去，同时要修改exp的值，在修改的过程中就会出现exp溢出、exp等于0的特殊情况。在这中间，要经常性地去考虑这个浮点数是否是变成了非规格化数。</p><p>下面是“规格化”整个过程的伪代码，适用于加减乘除。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">inline</span> <span class="keyword">uint32_t</span> <span class="title">internal_normalize</span><span class="params">(<span class="keyword">uint32_t</span> sign,<span class="keyword">int32_t</span> <span class="built_in">exp</span>,<span class="keyword">uint64_t</span> sig_grs)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="comment">/*需要右规*/</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">while</span>(<span class="comment">/*需要右规 且 没有发生上溢出*/</span>)</span><br><span class="line">        &#123;</span><br><span class="line">          <span class="comment">/*右规一次*/</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(<span class="comment">/*阶码上溢出*/</span>)</span><br><span class="line">        &#123;</span><br><span class="line">        <span class="comment">/*结果置为正负无穷*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="comment">/*阶码全0，变成了非规格化数*/</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/*右移一次变成非规格化数*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="comment">/*阶码仍然小于0，阶码下溢出*/</span>)</span><br><span class="line">&#123;</span><br><span class="line"><span class="comment">/*浮点数太小，无法表示，置为正负零*/</span></span><br><span class="line">&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="comment">/*需要左规 且 阶码大于0*/</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="keyword">while</span>(<span class="comment">/*需要左规 且 阶码大于0*/</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="comment">/*左规一次*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="comment">/*阶码==*/</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="comment">/*右移一次变为非规格化数*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(<span class="comment">/*两个规格化数运算后得到了非规格化数*/</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="built_in">exp</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="comment">/*未发生溢出*/</span>)</span><br><span class="line">    &#123;</span><br><span class="line">    <span class="comment">/*最后三位（grs）采用就近舍入到偶数的方式*/</span></span><br><span class="line">    <span class="comment">/*移除最后三位*/</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="comment">/*进位导致了规格化被迫坏*/</span>)</span><br><span class="line">    <span class="comment">/*再判断并规格化*/</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/*规格化数删除隐藏位*/</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>对于减法：把操作数换成补码之后，和加法一样。</p><p>乘法：</p><p>可以免去阶码对齐的过程，用uint64_t表示更加方便。</p><p>除法：</p><p>尾数相除，为了提高精度，可以把被除数使劲放大（左移到底），除数使劲缩小（右移到底），这样得到的结果再移回原有的位置，精度更高。</p><p>最后的阶码如何设定呢？我们加入了GRS bits后，相当于约定中间结果fraction是26位数，但是我们用23位乘以23位得到的是46位，因此46-26=20，这个20需要阶码来处理。最终的阶码就是fa.exponent + fb.exponent - 127 - 20。这一部分比较难以理解。</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>PA 1结束了。</p><p>这一部分我们设计了寄存器、主存以及标志位的模拟，定义了浮点数类型变量，同时也编写了定点数、浮点数的一些常用的运算操作，称为“数据的表示、存取和运算”。</p><p>要开始“程序的执行”了。</p><p>下次见。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/">https://blog.shuifengche.top/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/PA/">PA</a><a class="post-meta__tags" href="/tags/CPU/">CPU</a><a class="post-meta__tags" href="/tags/ALU/">ALU</a><a class="post-meta__tags" href="/tags/FPU/">FPU</a><a class="post-meta__tags" href="/tags/git/">git</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/i386.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/09/23/Datalab-%E5%AE%9E%E9%AA%8C1/"><img class="prev-cover" src="http://cdn.shuifengche.top/csapp.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Datalab 实验1</div></div></a></div><div class="next-post pull-right"><a href="/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/"><img class="next-cover" src="http://cdn.shuifengche.top/ubuntu.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">linux虚拟机安装</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/11/19/PA2-程序的执行/" title="PA2 程序的执行"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-19</div><div class="title">PA2 程序的执行</div></div></a></div><div><a href="/2020/01/20/PA3-存储管理/" title="PA3-存储管理"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-20</div><div class="title">PA3-存储管理</div></div></a></div><div><a href="/2020/01/20/PA4-异常中断与IO/" title="PA4-异常中断与IO"><img class="cover" src="http://cdn.shuifengche.top/i386.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-01-20</div><div class="title">PA4-异常中断与IO</div></div></a></div><div><a href="/2019/09/23/Datalab-实验1/" title="Datalab 实验1"><img class="cover" src="http://cdn.shuifengche.top/csapp.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-09-23</div><div class="title">Datalab 实验1</div></div></a></div><div><a href="/2019/11/22/gitbook部署到服务器/" title="gitbook部署到服务器"><img class="cover" src="http://cdn.shuifengche.top/gitbook.png"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-11-22</div><div class="title">gitbook部署到服务器</div></div></a></div><div><a href="/2019/10/15/水风车的博客2-0/" title="水风车的博客2.0"><img class="cover" src="http://cdn.shuifengche.top/blog2.jpeg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-10-15</div><div class="title">水风车的博客2.0</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/index/"/>
    <url>/2021/01/10/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>linux虚拟机安装 | 水风车的博客</title><meta name="keywords" content="linux,虚拟机"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="程序员离不开linux"><meta property="og:type" content="article"><meta property="og:title" content="linux虚拟机安装"><meta property="og:url" content="https://blog.shuifengche.top/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="程序员离不开linux"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/ubuntu.png"><meta property="article:published_time" content="2019-09-16T09:15:40.000Z"><meta property="article:modified_time" content="2019-12-12T06:31:58.675Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="linux"><meta property="article:tag" content="虚拟机"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/ubuntu.png"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-12 14:31:58'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%91%E4%B8%BA%E4%BB%80%E4%B9%88%E8%A3%85linux%E8%99%9A%E6%8B%9F%E6%9C%BA"><span class="toc-number">1.</span> <span class="toc-text">我为什么装linux虚拟机</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%86%E5%A4%87%E5%B7%A5%E5%85%B7"><span class="toc-number">2.</span> <span class="toc-text">准备工具</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E8%BF%87%E7%A8%8B"><span class="toc-number">3.</span> <span class="toc-text">安装过程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">4.</span> <span class="toc-text">最后</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/ubuntu.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">linux虚拟机安装</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-09-16T09:15:40.000Z" title="undefined 2019-09-16 17:15:40">2019-09-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%98%E8%85%BE/">折腾</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">672</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>2分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><p>适用于Debian、Ubuntu等大部分linux操作系统。</p><h2 id="我为什么装linux虚拟机"><a href="#我为什么装linux虚拟机" class="headerlink" title="我为什么装linux虚拟机"></a>我为什么装linux虚拟机</h2><p>第一点，上学期学汇编语言，linux系统下面能够更加直观地体验从c到o再到s最后生成可执行文件的过程，其中s是汇编文件，我们学习的要求是看懂汇编文件。同类的macOS的终端能够做到相同的效果，但Windows下不太一样。所以，学汇编必须用Linux。<br>这一次我安装的是Ubuntu 16.4的32位版本，虽然64位很普及了，但我们的教材学的还是32位。<br>第二点，这学期有一门大实验，叫PA，按照我的理解，这门课的目标是用C语言完整地模拟出一个CPU，可能还有一个操作系统？（暂时刚开始这门课，持续记录进度，另开文章）<br>这门课要求使用Debian10 的32位机器，老师提供一个几乎完整的框架，需要你从寄存器、ALU开始，操作一个个地用C语言写出来。很硬核，正在肝。</p><h2 id="准备工具"><a href="#准备工具" class="headerlink" title="准备工具"></a>准备工具</h2><p>1、一个linux系统的ISO镜像文件，这个一般存在于国内各大镜像网站上，比如科大镜像、南大镜像等等，选择距离较近的镜像网站下载速度或许会快一点？（瞎猜）<br>2、虚拟机软件，这个东西大概是模拟环境？windows、macOS下面都有类似的软件，windows下面推荐vmware player，macOS推荐vmware、parallel，当然，有一个叫virtual box的免费软件也不错。</p><h2 id="安装过程"><a href="#安装过程" class="headerlink" title="安装过程"></a>安装过程</h2><p>1、点开虚拟机软件，找到创建新的虚拟机，把之前下载的ISO文件拖进去，走一走流程，给它多分配点空间，比如说20个G+500M，以免内存不够安装失败。<br>2、然后就进入linux的初始安装界面了，在网上查一查对应版本的安装步骤，以免有些选项没选影响使用。Debian的初始化时中间有一步是选择图形界面，推荐mate，简洁、高效，（但不是那么美观）。<br>3、没了。进入桌面了。剩下的就要在终端下安装一大堆工具，什么gcc、g++呀，还有vim编辑器呀之类的，安装什么主要看你用Linux的目的了。</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>没怎么说就结束了，看来安装linux也没那么难嘛（瞎说，当时明明装了一个下午菜弄成的，后续还因为终端不熟练装错了东西、重装了好几次虚拟机呢）<br>就这样，这学期结束的时候可以聊聊大项目————PA。听说又硬核又好玩。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/">https://blog.shuifengche.top/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/linux/">linux</a><a class="post-meta__tags" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/ubuntu.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/09/21/PA1-%E6%95%B0%E6%8D%AE%E7%9A%84%E8%A1%A8%E7%A4%BA%E5%AD%98%E5%8F%96%E5%92%8C%E8%BF%90%E7%AE%97/"><img class="prev-cover" src="http://cdn.shuifengche.top/i386.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">PA1 数据的表示存取和运算</div></div></a></div><div class="next-post pull-right"><a href="/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/"><img class="next-cover" src="http://cdn.shuifengche.top/wintogo.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Win to go踩坑之旅</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/index/"/>
    <url>/2021/01/10/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Win to go踩坑之旅 | 水风车的博客</title><meta name="keywords" content="系统,Windows,macOS"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="一个固态硬盘&#x3D;&#x3D;随身携带的windows"><meta property="og:type" content="article"><meta property="og:title" content="Win to go踩坑之旅"><meta property="og:url" content="https://blog.shuifengche.top/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="一个固态硬盘&#x3D;&#x3D;随身携带的windows"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/wintogo.jpeg"><meta property="article:published_time" content="2019-09-07T04:18:17.000Z"><meta property="article:modified_time" content="2019-12-12T06:32:42.964Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="系统"><meta property="article:tag" content="Windows"><meta property="article:tag" content="macOS"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/wintogo.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-12 14:32:42'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFwin-to-go"><span class="toc-number">1.</span> <span class="toc-text">什么是win to go</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%B7%E5%9B%A0"><span class="toc-number">2.</span> <span class="toc-text">起因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#wintogo-%E8%99%9A%E6%8B%9F%E6%9C%BA-%E5%8F%8C%E7%B3%BB%E7%BB%9F%EF%BC%9F"><span class="toc-number">3.</span> <span class="toc-text">wintogo&#x2F;虚拟机&#x2F;双系统？</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E7%A1%AC%E7%9B%98%EF%BC%9A"><span class="toc-number">3.1.</span> <span class="toc-text">一个硬盘：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#win10%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6%EF%BC%9A"><span class="toc-number">3.2.</span> <span class="toc-text">win10镜像文件：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#wintogo%E5%B7%A5%E5%85%B7%EF%BC%8BWindows%E7%94%B5%E8%84%91%E4%B8%80%E5%8F%B0"><span class="toc-number">3.3.</span> <span class="toc-text">wintogo工具＋Windows电脑一台</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9D%82%E9%A1%B9"><span class="toc-number">3.4.</span> <span class="toc-text">杂项</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B4%E4%B8%AA%E6%B5%81%E7%A8%8B%E4%BB%A5%E5%8F%8A%E5%9D%91"><span class="toc-number">4.</span> <span class="toc-text">整个流程以及坑</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E"><span class="toc-number">5.</span> <span class="toc-text">最后</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/wintogo.jpeg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Win to go踩坑之旅</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-09-07T04:18:17.000Z" title="undefined 2019-09-07 12:18:17">2019-09-07</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%98%E8%85%BE/">折腾</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>3分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="什么是win-to-go"><a href="#什么是win-to-go" class="headerlink" title="什么是win to go"></a>什么是win to go</h2><p>我的理解是，原有计算机设备内置了存储设备——硬盘，系统（Mac OS或者Windows）存储在里面，现在我想把系统存储在外接硬盘中，我随身携带这个硬盘，相当于随身携带一个系统，到任何地方，插上就能用，这就是win to go。</p><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>我使用的是MacBook，但由于数字电路课程需要使用Windows上独占的一些verilog开发语言，因此必须使用安装Windows系统。</p><h2 id="wintogo-虚拟机-双系统？"><a href="#wintogo-虚拟机-双系统？" class="headerlink" title="wintogo/虚拟机/双系统？"></a>wintogo/虚拟机/双系统？</h2><p>这三者我都使用过。<br>体验上：双系统＝wintogo&gt;虚拟机<br>虚拟机：在mac系统中通过软件来模拟一个Windows环境，耗电严重，好处是切换方便。<br>双系统和wintogo都需要关机切换，但苦于我的乞丐版MacBook Pro只有256G，我实在没有能力给Windows再开空间了。<br>所以我选择wintogo。<br>##准备工具总结</p><h3 id="一个硬盘："><a href="#一个硬盘：" class="headerlink" title="一个硬盘："></a>一个硬盘：</h3><p>空间足够，至少64G吧；读写速度要快，尽量选择固态硬盘。<br>我使用的是三星T5的500G版本前两天买的，大小差不多一张名片，某东价格只有六百多了，听说发售时一千五？强烈推荐。<br>不建议使用U盘状闪存，我猜测那种玩意儿发热很严重。</p><h3 id="win10镜像文件："><a href="#win10镜像文件：" class="headerlink" title="win10镜像文件："></a>win10镜像文件：</h3><p>为了找它我费了好大劲，中途遭遇某雷、某盘的限速降维打击。<br>建议选择</p><p><a target="_blank" rel="noopener" href="http://msdn.itellyou.cn/" title="Itellyou">Msdn itellyou</a></p><p>我每次下Windows镜像都在这里，获取一个ed2k链接，然后使用迅雷（迫不得已）等下载工具即可。</p><h3 id="wintogo工具＋Windows电脑一台"><a href="#wintogo工具＋Windows电脑一台" class="headerlink" title="wintogo工具＋Windows电脑一台"></a>wintogo工具＋Windows电脑一台</h3><p>来自萝卜头社区的wintogo生成工具，</p><p><a target="_blank" rel="noopener" href="https://bbs.luobotou.org/thread-761-1-1.html" title="wintogo工具">wintogo工具</a></p><p>需要安装在Windows系统中使用。</p><h3 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h3><p>Windows支持软件：<br>这个是mac笔记本安装wintogo时的驱动，需要在mac系统中的boot camp中下载下来，并且通过云盘（因为u盘无法拷贝这个文件夹）存储下来，以备后续安装驱动。<br>如果你不打算在mac中使用，可以忽略。</p><p>Windows有线鼠标一根：<br>借别人的鼠标用一下吧，靠它度过艰难的几分钟。</p><h2 id="整个流程以及坑"><a href="#整个流程以及坑" class="headerlink" title="整个流程以及坑"></a>整个流程以及坑</h2><p>购买硬盘，等快递。<br>带着MacBook、硬盘、U盘（非刚需）、各种转接头，去机房找一台Windows电脑。<br>在Windows电脑上下载一个win10企业版的ISO镜像。<br>再下载一个萝卜头社区的wintogo工具。<br>插上硬盘，打开wintogo工具。<br>把ISO添加进去，格式化硬盘，安装工具的引导完成wintogo硬盘的生成。<br>拔掉硬盘插在mac上，开机长按option，选择efi boot盘，然后发现打不开。<br>原来是mac的安全设置没关闭。重启，按住command＋R进入奇怪的模式，在最上面的设置里找到什么安全性开关，然后允许外接硬盘就行了。<br>重启、option、efi boot，成功进入Windows系统设置。<br>然而因为这个Windows系统中没有mac笔记本对应的驱动，导致键盘鼠标触摸板蓝牙网络什么都没有。<br>这时候你需要一个Windows有线鼠标，我是碰巧在机房找到一根。<br>用这个鼠标设置Windows的注册过程，键盘无法使用但是有虚拟键盘呀！<br>（当然也可以直接连在机房的PC上进行注册，那玩意不需要驱动，鼠标键盘啥都能用！<br>不过麻烦的是需要在网上查一查如何用u盘启动，要设置BIOS以及开机默认启动设备。）<br>然后在mac电脑上打开Windows系统，这时只有你的Windows鼠标有效，键盘触摸板不能用，把Windows支持软件拷贝进去，用这个鼠标点击里面的setup，等一会儿各种驱动就安装好了，键盘、扬声器、蓝牙、触摸板、wifi等等就正常了。<br>到此也就结束了。</p><h2 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h2><p>估计我还得找个有效的激活工具，装个VS，装数字电路课的软件，然后费好大劲尝试将电脑与什么DE10器件连接。<br>想想都复杂。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/">https://blog.shuifengche.top/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E7%B3%BB%E7%BB%9F/">系统</a><a class="post-meta__tags" href="/tags/Windows/">Windows</a><a class="post-meta__tags" href="/tags/macOS/">macOS</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/wintogo.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/09/16/linux%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AE%89%E8%A3%85/"><img class="prev-cover" src="http://cdn.shuifengche.top/ubuntu.png" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">linux虚拟机安装</div></div></a></div><div class="next-post pull-right"><a href="/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/"><img class="next-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">大一暑假我想说</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/07/04/全平台同步，很难吗？/" title="全平台同步，很难吗？"><img class="cover" src="http://cdn.shuifengche.top/timg.jpeg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-04</div><div class="title">全平台同步，很难吗？</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/index/"/>
    <url>/2021/01/10/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>水风车的博客1.0 | 水风车的博客</title><meta name="keywords" content="博客,Hexo,GitHub"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="这是我搭建的第一个博客，基于hexo，托管于GitHub Pages。"><meta property="og:type" content="article"><meta property="og:title" content="水风车的博客1.0"><meta property="og:url" content="https://blog.shuifengche.top/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="这是我搭建的第一个博客，基于hexo，托管于GitHub Pages。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="http://cdn.shuifengche.top/blog1.jpeg"><meta property="article:published_time" content="2019-07-28T06:33:16.000Z"><meta property="article:modified_time" content="2019-12-12T06:30:58.814Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="博客"><meta property="article:tag" content="Hexo"><meta property="article:tag" content="GitHub"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://cdn.shuifengche.top/blog1.jpeg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-12 14:30:58'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B5%B7%E5%9B%A0"><span class="toc-number">1.</span> <span class="toc-text">起因</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%8C%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%E3%80%82"><span class="toc-number">2.</span> <span class="toc-text">第一步，准备工作。</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%B7%B1%E8%B4%AD%E4%B9%B0%E7%9A%84%E5%9F%9F%E5%90%8D"><span class="toc-number">2.1.</span> <span class="toc-text">自己购买的域名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E4%B8%80%E7%A7%8D%E5%8D%9A%E5%AE%A2%E5%BB%BA%E7%AB%99%E5%B7%A5%E5%85%B7"><span class="toc-number">2.2.</span> <span class="toc-text">选择一种博客建站工具</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8hexo%E7%9A%84%E5%89%8D%E6%8F%90%E6%9D%A1%E4%BB%B6"><span class="toc-number">2.3.</span> <span class="toc-text">使用hexo的前提条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E5%8F%B0%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">2.4.</span> <span class="toc-text">一台服务器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%8C%E6%95%B4%E4%B8%AA%E8%BF%87%E7%A8%8B%E3%80%82"><span class="toc-number">3.</span> <span class="toc-text">第二步，整个过程。</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#hexo-init"><span class="toc-number">3.1.</span> <span class="toc-text">hexo init</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#config-yml"><span class="toc-number">3.2.</span> <span class="toc-text">_config.yml</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#themes"><span class="toc-number">3.3.</span> <span class="toc-text">themes</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hexo-deployer-git"><span class="toc-number">3.4.</span> <span class="toc-text">hexo-deployer-git</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E5%B0%8F%E9%97%AE%E9%A2%98"><span class="toc-number">3.5.</span> <span class="toc-text">遇到的小问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E6%89%98%E7%AE%A1"><span class="toc-number">3.6.</span> <span class="toc-text">代码托管</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9C%80%E5%90%8E%E6%83%B3%E8%AF%B4"><span class="toc-number">4.</span> <span class="toc-text">最后想说</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(http://cdn.shuifengche.top/blog1.jpeg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">水风车的博客1.0</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-07-28T06:33:16.000Z" title="undefined 2019-07-28 14:33:16">2019-07-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%8A%98%E8%85%BE/">折腾</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>3分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="起因"><a href="#起因" class="headerlink" title="起因"></a>起因</h2><p>今年上半年我开始着手自己的个人博客建设，当时什么都不懂，也没有自己的域名，照着教程弄了个简单的博客，甚至连git都不会用，结果就是我一直纠结于如何看懂本地文件（现在想想简直是痴心妄想），最后连文章都添加不上去，索性放弃了。</p><p>这个暑假一开始，我就又考虑这件事了。一冲动就买了个自己的域名，就是这个<a target="_blank" rel="noopener" href="https://shuifengche.top/" title="我的博客">www.shuifengche.top</a>，买了域名之后我才开始考虑怎么搭建这个博客。</p><p>在刷b站的时候，看到了up主程序羊发的hexo无坑教学视频，我立马就跟着做了起来，评论区有人交作业，我顺着某个人的网站就找到了这个hexo-theme-matery主题，很符合我的“直男审美”。</p><p>前前后后折腾了好久，大概从早上起床到晚上睡觉才把他弄好。原因是不知道及时保存，而且对一些操作不解，总是某一步做完之后，hexo操作就疯狂报错，自己也不知道哪里错了，更不知道怎么改回去，又没有保存，就把辛辛苦苦弄好的blog文件夹删掉重来。大概重来了四五次了……</p><p>不过总算弄好了，下面就说说我理解中的建站过程（包含自定义域名的）</p><h2 id="第一步，准备工作。"><a href="#第一步，准备工作。" class="headerlink" title="第一步，准备工作。"></a>第一步，准备工作。</h2><h3 id="自己购买的域名"><a href="#自己购买的域名" class="headerlink" title="自己购买的域名"></a>自己购买的域名</h3><p>我是在阿里的万网上买的，top顶级域名比较便宜，我觉得个人博客的话就没必要用com、cn那种域名了吧，划不来……</p><h3 id="选择一种博客建站工具"><a href="#选择一种博客建站工具" class="headerlink" title="选择一种博客建站工具"></a>选择一种博客建站工具</h3><p>我使用的是hexo，跟着up主的教程跑下来感觉不是很难，操作比较容易，主题也比较多，<del>遇到的困难也比较多</del>，同类的还有jekyll，听说有点难弄。</p><h3 id="使用hexo的前提条件"><a href="#使用hexo的前提条件" class="headerlink" title="使用hexo的前提条件"></a>使用hexo的前提条件</h3><p>git、node.js（包含npm），这些工具在建站过程中都是要用到的（虽然我不怎么会用），还有就是npm速度极慢，最好要使用淘宝的镜像cnpm。</p><h3 id="一台服务器"><a href="#一台服务器" class="headerlink" title="一台服务器"></a>一台服务器</h3><p>或者说，选择一个合适的代码托管平台，我使用的是GitHub的静态页面托管，我还尝试过coding（太卡了，有时候完全打不开网页）、gitee（自定义域名要交钱），尽管GitHub依旧很慢，但我还是只能选它了，以后有机会的话，还是要自己买服务器的。</p><h2 id="第二步，整个过程。"><a href="#第二步，整个过程。" class="headerlink" title="第二步，整个过程。"></a>第二步，整个过程。</h2><p>（由于失败次数过多，我都记得差不多了，这里简要记录一下）</p><h3 id="hexo-init"><a href="#hexo-init" class="headerlink" title="hexo init"></a>hexo init</h3><p>建一个文件夹blog，终端进入这里，指令 hexo init，初始的blog就建成了。</p><h3 id="config-yml"><a href="#config-yml" class="headerlink" title="_config.yml"></a>_config.yml</h3><p>在blog目录里面有一个config.yml 文件，里面可以设置网站标题、作者，想要安装其他插件就在这里面加插件代码，结尾处可以设置git，repo填一个git地址。哦对了，还可以设置主题。</p><h3 id="themes"><a href="#themes" class="headerlink" title="themes"></a>themes</h3><p>themes文件夹里面存放各种主题，可以clone或者直接下载下来放里面。</p><h3 id="hexo-deployer-git"><a href="#hexo-deployer-git" class="headerlink" title="hexo-deployer-git"></a>hexo-deployer-git</h3><p>git成功的关键一步，cnpm install —save hexo-deployer-git，然后才能够hexo d</p><p>hexo的指令：clean、g、s、d。</p><p>剩下的照着主题说明做就可以了。</p><h3 id="遇到的小问题"><a href="#遇到的小问题" class="headerlink" title="遇到的小问题"></a>遇到的小问题</h3><p>4000网络端口被占用，那就hexo s -p 5000，没过多久，5000也被占用了，那就换3000……</p><h3 id="代码托管"><a href="#代码托管" class="headerlink" title="代码托管"></a>代码托管</h3><p>git弄完，要去GitHub pages页面设置一下自己的域名，然后在自己的域名服务商（阿里云）解析域名，一个A类型的记录ip地址（GitHub服务器有四个ip地址，都给装上），一个CNAME类型的记录跳转域名（shuifengche.github.io），哦对了，blog文件里面需要弄一个名叫CNAME的文件，里面就放一个shuifengche.top。</p><p>弄完之后就差不多了，可以写博客啦。</p><p>提醒，每做一步就备个份，惨痛教训。</p><h2 id="最后想说"><a href="#最后想说" class="headerlink" title="最后想说"></a>最后想说</h2><p>balabala……</p><p>想说的有好多，写了一大堆，删了删了，开下一篇。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/">https://blog.shuifengche.top/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E5%8D%9A%E5%AE%A2/">博客</a><a class="post-meta__tags" href="/tags/Hexo/">Hexo</a><a class="post-meta__tags" href="/tags/GitHub/">GitHub</a></div><div class="post_share"><div class="social-share" data-image="http://cdn.shuifengche.top/blog1.jpeg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-full"><a href="/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/"><img class="prev-cover" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">大一暑假我想说</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2019/10/15/水风车的博客2-0/" title="水风车的博客2.0"><img class="cover" src="http://cdn.shuifengche.top/blog2.jpeg"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2019-10-15</div><div class="title">水风车的博客2.0</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title></title>
    <link href="/2021/01/10/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/index/"/>
    <url>/2021/01/10/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/index/</url>
    
    <content type="html"><![CDATA[<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>大一暑假我想说 | 水风车的博客</title><meta name="keywords" content="暑假,生活"><meta name="author" content="水风车"><meta name="copyright" content="水风车"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="这个暑假已经过去一半了，我想说些什么。"><meta property="og:type" content="article"><meta property="og:title" content="大一暑假我想说"><meta property="og:url" content="https://blog.shuifengche.top/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/index.html"><meta property="og:site_name" content="水风车的博客"><meta property="og:description" content="这个暑假已经过去一半了，我想说些什么。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><meta property="article:published_time" content="2019-07-28T07:13:16.000Z"><meta property="article:modified_time" content="2019-12-14T15:42:49.409Z"><meta property="article:author" content="水风车"><meta property="article:tag" content="暑假"><meta property="article:tag" content="生活"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://blog.shuifengche.top/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css"><script>var GLOBAL_CONFIG = {   root: '/',  hexoversion: '5.2.0',  algolia: undefined,  localSearch: undefined,  translate: undefined,  noticeOutdate: undefined,  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},  copy: {    success: '复制成功',    error: '复制错误',    noSupport: '浏览器不支持'  },  relativeDate: {    homepage: false,    post: false  },  runtime: '天',  date_suffix: {    just: '刚刚',    min: '分钟前',    hour: '小时前',    day: '天前',    month: '个月前'  },  copyright: undefined,  ClickShowText: undefined,  lightbox: 'fancybox',  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#49b1f5","bgDark":"#121212","position":"bottom-left"},  justifiedGallery: {    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'  },  isPhotoFigcaption: true,  islazyload: false,  isanchor: true};var saveToLocal = {  set: function setWithExpiry(key, value, ttl) {    const now = new Date()    const expiryDay = ttl * 86400000    const item = {      value: value,      expiry: now.getTime() + expiryDay,    }    localStorage.setItem(key, JSON.stringify(item))  },  get: function getWithExpiry(key) {    const itemStr = localStorage.getItem(key)    if (!itemStr) {      return undefined    }    const item = JSON.parse(itemStr)    const now = new Date()    if (now.getTime() > item.expiry) {      localStorage.removeItem(key)      return undefined    }    return item.value  }}</script><script id="config_change">var GLOBAL_CONFIG_SITE = {   isPost: true,  isHome: false,  isHighlightShrink: false,  isSidebar: true,  postUpdate: '2019-12-14 23:42:49'}</script><noscript><style type="text/css">  #nav {    opacity: 1  }  .justified-gallery img {    opacity: 1  }  #recent-posts time,  #post-meta time {    display: inline !important  }</style></noscript><script>(function () {  window.activateDarkMode = function () {    document.documentElement.setAttribute('data-theme', 'dark')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')    }  }  window.activateLightMode = function () {    document.documentElement.setAttribute('data-theme', 'light')    if (document.querySelector('meta[name="theme-color"]') !== null) {      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')    }  }  const autoChangeMode = 'false'  const t = saveToLocal.get('theme')  if (autoChangeMode === '1') {    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified    if (t === undefined) {      if (isLightMode) activateLightMode()      else if (isDarkMode) activateDarkMode()      else if (isNotSpecified || hasNoSupport) {        const now = new Date()        const hour = now.getHours()        const isNight = hour <= 6 || hour >= 18        isNight ? activateDarkMode() : activateLightMode()      }      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {        if (saveToLocal.get('theme') === undefined) {          e.matches ? activateDarkMode() : activateLightMode()        }      })    } else if (t === 'light') activateLightMode()    else activateDarkMode()  } else if (autoChangeMode === '2') {    const now = new Date()    const hour = now.getHours()    const isNight = hour <= 6 || hour >= 18    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()    else if (t === 'light') activateLightMode()    else activateDarkMode()  } else {    if (t === 'dark') activateDarkMode()    else if (t === 'light') activateLightMode()  }})()</script><style type="text/css">#toggle-sidebar {bottom: 80px}</style><meta name="generator" content="Hexo 5.2.0"><link rel="alternate" href="/rss.xml" title="水风车的博客" type="application/atom+xml"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">18</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">51</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%88%E8%AF%B4%E8%AF%B4%E5%92%8C%E4%B8%93%E4%B8%9A%E7%9B%B8%E5%85%B3%E7%9A%84"><span class="toc-number">1.</span> <span class="toc-text">先说说和专业相关的</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#markdown"><span class="toc-number">1.1.</span> <span class="toc-text">markdown</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#hexo"><span class="toc-number">1.2.</span> <span class="toc-text">hexo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8C%E6%8B%BC"><span class="toc-number">1.3.</span> <span class="toc-text">双拼</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%8D%E8%AF%B4%E7%82%B9%E5%85%B6%E4%BB%96%E7%9A%84%E4%BA%8B"><span class="toc-number">2.</span> <span class="toc-text">再说点其他的事</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%99%E4%B8%AA%E6%9A%91%E5%81%87"><span class="toc-number">3.</span> <span class="toc-text">这个暑假</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">水风车的博客</a></span><span id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" target="_blank" rel="noopener" href="https://www.yuque.com/shuifengche"><i class="fa-fw fas fa-book"></i><span> 文档</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E5%AE%9E%E9%AA%8C/"><i class="fa-fw fas fa-flask"></i><span> 实验</span></a></li><li><a class="site-page" href="/categories/%E6%8A%98%E8%85%BE/"><i class="fa-fw fas fa-rocket"></i><span> 折腾</span></a></li><li><a class="site-page" href="/categories/%E6%95%B0%E5%AD%A6/"><i class="fa-fw fas fa-subscript"></i><span> 数学</span></a></li><li><a class="site-page" href="/categories/%E7%BC%96%E7%A8%8B/"><i class="fa-fw fas fa-bug"></i><span> 编程</span></a></li><li><a class="site-page" href="/categories/%E9%9A%8F%E7%AC%94/"><i class="fa-fw fas fa-edit"></i><span> 随笔</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 清单</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/books/"><i class="fa-fw fas fa-book"></i><span> 阅读</span></a></li><li><a class="site-page" href="/movies/"><i class="fa-fw fas fa-film"></i><span> 观影</span></a></li><li><a class="site-page" href="/bangumis/"><i class="fa-fw fas fa-utensils"></i><span> 追番</span></a></li><li><a class="site-page" href="/gallery/"><i class="fa-fw fas fa-camera-retro"></i><span> 相册</span></a></li><li><a class="site-page" href="/games/"><i class="fa-fw fas fa-gamepad"></i><span> 游戏</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fas fa-address-book"></i><span> 其他</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></li><li><a class="site-page" href="/artitalk/"><i class="fa-fw fas fa-comment"></i><span> 说说</span></a></li><li><a class="site-page" href="/message/"><i class="fa-fw fas fa-coffee"></i><span> 留言</span></a></li><li><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">大一暑假我想说</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2019-07-28T07:13:16.000Z" title="undefined 2019-07-28 15:13:16">2019-07-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E9%9A%8F%E7%AC%94/">随笔</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>2分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-separator">|</span><span class="post-meta-commentcount"><i class="far fa-comments fa-fw post-meta-icon"></i><span class="post-meta-label">评论数:</span><a href="/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/#post-comment" itemprop="discussionUrl"><span class="valine-comment-count comment-count" data-xid="/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/" itemprop="commentCount"></span></a></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h2 id="先说说和专业相关的"><a href="#先说说和专业相关的" class="headerlink" title="先说说和专业相关的"></a>先说说和专业相关的</h2><h3 id="markdown"><a href="#markdown" class="headerlink" title="markdown"></a>markdown</h3><p>去年底我开始接触并坚持使用markdown，最初只是觉得它很牛逼，现在看来，markdown真的是很方便很普及了，我现在这篇文章的初稿就是在锤子便签的markdown模式下写的，而后接力至typora上做些修改，最后才粘贴至hexo博客文件中的。</p><h3 id="hexo"><a href="#hexo" class="headerlink" title="hexo"></a>hexo</h3><p>今年上半年，我接触了这种静态网页工具，hexo、jekyll、还有什么gohugo（正在尝试搞懂它）。</p><h3 id="双拼"><a href="#双拼" class="headerlink" title="双拼"></a>双拼</h3><p>同样是上半年，我开始学习并使用双拼输入法，已经坚持使用三四个月了，现在比较熟练了，将来也可能会尝试五笔，不过应该不会再回去用拼音了。</p><p>仔细想想，这一年我在课堂上也学过不少东西，但好像没有什么令我印象深刻的知识、技能，反而课下自己学的东西总在嘴边。可能是因为课下学的东西我更感兴趣吧。</p><h2 id="再说点其他的事"><a href="#再说点其他的事" class="headerlink" title="再说点其他的事"></a>再说点其他的事</h2><p>大一上学期我学得比较认真，作业也不拖，平时喜欢宅在宿舍，也不怎么与别人打交道，绩点也挺高。大一下学期就很不一样了，上课瞌睡、下课玩，作业拖到ddl，周六出去参加社团活动，空闲时间唱唱歌，追追剧，最后成绩很差。</p><p>怎么说呢，总觉得这两个学期是两个极端，上学期是宅与学习，下学期玩和放弃。就过程来说，我当然喜欢多外出游玩多，但就结果而言，我更喜欢高绩点。</p><p>所以我希望下个学期我能很好的做出平衡，能把刷QQ刷知乎刷微博刷b站的时间匀给外出旅游，同时又不影响学习的时间。</p><h2 id="这个暑假"><a href="#这个暑假" class="headerlink" title="这个暑假"></a>这个暑假</h2><p>暑假过去一半时间了，我主要经历了三个阶段。</p><p>第一阶段，早睡早起，认真学习，外出学车，拿到驾照。</p><p>第二阶段，吃坏肚子，生病吃药，打针输液，卧病在床。</p><p>第三阶段，疾病痊愈，开始变宅，晚睡晚起，整天哔哩。</p><p>我明明对第三阶段很厌恶，却无法从中逃脱。今天写的这两篇文章可能是我半个月来唯一的一次学习？</p><p>一个月前的考试周时就是这样，明明考试即将来临，明明知识点学的不怎么牢固，我还是控制不住自己娱乐的欲望。也许从入手iPad开始之后，我以“尝试新鲜事物”为幌子，又是玩游戏，又是关注新的up主的。大量的时间浪费在了知乎、bilibili、qq空间、微博等等上面。这样真的好吗？我知道不好。</p><p>如何控制住自己的欲望？</p><p>我身边就有这样优秀的同学，他们能够控制自己，能够确保买的iPad只用来学习，时间到了能够立刻放下手机去学习。</p><p>而我呢？对比来看，我感觉自己都不配来到这里学习。</p><p>就在几分钟前，我发现一个博客，<a target="_blank" rel="noopener" href="https://blog.dandyweng.com/" title="翁天信">翁天信的博客</a>，这个人很厉害。</p><p>他比我大不了几岁。一开始我只是被他的博客页面效果给震撼到了，慢慢地点开一个个页面，我才发现他的不一般。遍及世界各地的摄影作品，首页显示出的一大堆我现在还未接触的计算机学术名词，自己开发的app，吸引人的博客。我确实被吸引了，有一种“捡到宝”的感觉。上一次有这种感觉是在我发现了b站up主何同学，再上一次是我发现了博客matrix67。</p><p>我也喜欢旅行、编程、摄影、设计。但似乎都只是皮毛，都不精通，甚至说还没有入门。</p><p>我向往他的生活。也许我也能做到。</p><p>那应该怎样做到呢？</p><p>我想我知道。</p></div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">水风车</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.shuifengche.top/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/">https://blog.shuifengche.top/2019/07/28/%E5%A4%A7%E4%B8%80%E6%9A%91%E5%81%87%E6%88%91%E6%83%B3%E8%AF%B4/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.shuifengche.top" target="_blank">水风车的博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9A%91%E5%81%87/">暑假</a><a class="post-meta__tags" href="/tags/%E7%94%9F%E6%B4%BB/">生活</a></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/img/default.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2019/09/07/Win-to-go%E8%B8%A9%E5%9D%91%E4%B9%8B%E6%97%85/"><img class="prev-cover" src="http://cdn.shuifengche.top/wintogo.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Win to go踩坑之旅</div></div></a></div><div class="next-post pull-right"><a href="/2019/07/28/%E6%B0%B4%E9%A3%8E%E8%BD%A6%E7%9A%84%E5%8D%9A%E5%AE%A21-0/"><img class="next-cover" src="http://cdn.shuifengche.top/blog1.jpeg" onerror="onerror=null;src='/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">水风车的博客1.0</div></div></a></div></nav><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2019 - 2020 By 水风车</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="icp"><a target="_blank" rel="noopener" href="http://www.beian.miit.gov.cn"><img class="icp-icon" src="/img/icp.png"/><span>豫ICP备19037780号-1</span></a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><div class="js-pjax"><script>function loadValine () {  function initValine () {    const initData = {      el: '#vcomment',      appId: 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',      appKey: '5fbPEnx748koRv3ImvFyk4BC',      placeholder: '请留下你的足迹吧Y(^o^)Y网址记得添加http哟！',      avatar: 'monsterid',      meta: 'nick,mail,link'.split(','),      pageSize: '10',      lang: 'zh-CN',      recordIP: false,      serverURLs: '',      emojiCDN: '',      emojiMaps: "",      enableQQ: false,      path: window.location.pathname,    }    if (true) {       initData.requiredFields= ('nick,mail'.split(','))    }    const valine = new Valine(initData)  }  if (typeof Valine === 'function') initValine()   else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)}if ('Valine' === 'Valine' || !false) {  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)  else setTimeout(() => loadValine(), 0)} else {  function loadOtherComment () {    loadValine()  }}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.17.0/js/md5.min.js"></script><script>window.addEventListener('load', () => {  const changeContent = (content) => {    if (content === '') return content    content = content.replace(/<[^>]+>/g,"") // remove html tag    content = content.replace(/(http(s?):)([/|.|\w|\s|-])*\.(?:jpg|jpeg|gif|png|webp)/g, '') // remove image link    content = content.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/gi, '') // remove url    if (content.length > 150) {      content = content.substring(0,150) + '...'    }    return content  }  const getIcon = (icon, mail) => {    if (icon) return icon     let defaultIcon = '?d=monsterid'    let iconUrl = `https://gravatar.loli.net/avatar/${md5(mail.toLowerCase()) + defaultIcon}`    return iconUrl  }  const generateHtml = array => {    let result = ''    for (let i = 0; i < array.length; i++) {      result += '<div class=\'aside-list-item\'>'      if (true) {        result += `<a href='${array[i].url}' class="thumbnail"><img src='${getIcon(array[i].avatar, array[i].mail)}' alt='${array[i].nick}'></a>`      }      result += `<div class='content'>      <a class='comment' href='${array[i].url}'>${array[i].content}</a>      <div class='name'><span>${array[i].nick}</span><time> / ${btf.diffDate(array[i].date, true)}</time></div>      </div></div>`    }    let $dom = document.querySelector('#card-newest-comments .aside-list')    $dom.innerHTML= result    window.pjax && window.pjax.refresh($dom)  }  const getValineData = () => {      let serverURL = ''      if (true) {        serverURL = 'https://ktb0hiwh.lc-cn-n1-shared.com'      } else {        serverURL = 'https://KTB0hIwh.api.lncldglobal.com'      }    var settings = {      "url": `${serverURL}/1.1/classes/Comment?limit=6&order=-createdAt`,      "method": "GET",      "timeout": 0,      "headers": {        "X-LC-Id": 'KTB0hIwhRrytkSkUDbJY36n7-gzGzoHsz',        "X-LC-Key": '5fbPEnx748koRv3ImvFyk4BC',        "Content-Type": "application/json"      },    }    $.ajax(settings).done((response) => {      var valineArray = []      response.results.forEach((e)=>{        valineArray.push({          'avatar': e.QQAvatar,          'content': changeContent(e.comment),          'mail': e.mail,          'nick': e.nick,          'url': e.url,          'date': e.createdAt,        })      })            saveToLocal.set('leancloud-newest-comments', JSON.stringify(valineArray), 10/(60*24))      generateHtml(valineArray)    }).fail(()=>{      const $dom = document.querySelector('#card-newest-comments .aside-list')      $dom.innerHTML= "无法获取资料，请确认相关配置是否正确"    })  }  const newestCommentInit = () => {    if (document.querySelector('#card-newest-comments .aside-list')) {      const data = saveToLocal.get('leancloud-newest-comments')      if (data) {        generateHtml(JSON.parse(data))      } else {        getValineData()      }    }  }  newestCommentInit()  document.addEventListener('pjax:complete', newestCommentInit)})</script><div class="aplayer no-destroy" data-id="7741023236" data-server="tencent" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = [  'title',  '#config_change',  '#body-wrap',  '#rightside-config-hide',  '#rightside-config-show',  '.js-pjax']if (false) {  pjaxSelectors.unshift('meta[property="og:image"]', 'meta[property="og:title"]', 'meta[property="og:url"]')}var pjax = new Pjax({  elements: 'a:not([target="_blank"])',  selectors: pjaxSelectors,  cacheBust: false,  analytics: false,  scrollRestoration: false})document.addEventListener('pjax:complete', function () {  window.refreshFn()  $('script[data-pjax]').each(function () {    $(this).parent().append($(this).remove())  })  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()  typeof chatBtnFn === 'function' && chatBtnFn()  typeof panguInit === 'function' && panguInit()  if (typeof gtag === 'function') {    gtag('config', '', {'page_path': window.location.pathname});  }  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()  // Analytics  if (false) {    MtaH5.pgv()  }  // prismjs  typeof Prism === 'object' && Prism.highlightAll()  typeof preloader === 'object' && preloader.endLoading()})document.addEventListener('pjax:send', function () {  typeof preloader === 'object' && preloader.initLoading()    if (window.aplayers) {    for (let i = 0; i < window.aplayers.length; i++) {      if (!window.aplayers[i].options.fixed) {        window.aplayers[i].destroy()      }    }  }  typeof typed === 'object' && typed.destroy()  $(window).off('scroll')  //reset readmode  $('body').hasClass('read-mode') && $('body').removeClass('read-mode')})</script></div></body></html>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>我对自己的认识</title>
    <link href="/2021/01/03/%E6%88%91%E5%AF%B9%E8%87%AA%E5%B7%B1%E7%9A%84%E8%AE%A4%E8%AF%86/"/>
    <url>/2021/01/03/%E6%88%91%E5%AF%B9%E8%87%AA%E5%B7%B1%E7%9A%84%E8%AE%A4%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<p>总觉得自己是一个无趣且内向的人。好像从小到大身边的所有人都在告诉我，你要学会变得活泼开朗，多说话，脚下的路才会特别好走。</p><p>小时候和家人出门，路上碰见熟人，我不知道该怎么开口打招呼，也分不清该叫什么敬称，逢年过节时也不知道怎么开口说些祝福的话。<br>于是被家人视为不懂事的孩子，总是被说，看别人家的孩子嘴那么甜，多讨人欢心。后来慢慢长大，到了中学，班级里的各种聚餐活动也都通通避之。<br>中学是开始学习编程，每天早上都看一两眼书，有异性坐到了自己身侧，于是一直头死死的盯着窗外，根本不敢看对方一眼。<br>这种内向浸透到我身体里的每一个角落，只喜欢下班后自己一个人待着，无趣的重复着每天的。。<br>生活。也曾尝试着让自己去适应去改变，每次很不情愿地交流后，都会觉得难受无比，也很疲惫，总是在进退两难中纠结，本来就很不开心，慢慢变得更不开心了。<br>你快乐吗，长大后与这个世界的诸多交手。或许大部分人的答案都是否定的吧。<br>我们原本想要更加痛快地生活，可那股杀<br>伐决断的勇气去哪了，被生活消磨殆尽了吗<br>很遗憾，我们终究没有为更自由的未来，冲锋陷阵过。<br>就像我们期待遇见鲸鱼，却从没有出海，甚至没有涉足野生的湖泊<br>周围人的人都在笑，他们始终不相信语言能杀人，用冰冷的语言戳别人的痛处来取乐<br>这些都像一些玻璃渣子，支离破碎，句句伤人<br>也不是每一个家庭都是避风港，我羡慕在温室里的孩子，他们骨子里发出来的自信，是我这辈子学不来的<br>我的父亲没有散文集，他的日记本里，只有给别人干活的日期<br>我的母亲脸上手上已经有了许多皱印<br>从前不理解父亲，为什么不能赚大钱，为什么不能让一家人过上更好的日子，长大后才明白为了我已经拼尽全力了<br>同级的同学不断地秀着爸妈的转账纪律和高端生活，我承认我羡慕了，但我忘不了我之前的时候恨过我父亲没有钱<br>我认为我这个15岁出头的人，应当谦卑一些，<br>每当想要评价什么人的时候切记这个世界上的人并非都具备你禀有的条件。</p><p>以上纯属我一个15岁的孩子个人主观认为，有问题也很正常，毕竟我只有这么大，对于社会经验和家庭问题所能理解的非常有限</p>]]></content>
    
    
    
    <tags>
      
      <tag>情感诉讼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>关于父母</title>
    <link href="/2021/01/03/%E5%85%B3%E4%BA%8E%E7%88%B6%E6%AF%8D/"/>
    <url>/2021/01/03/%E5%85%B3%E4%BA%8E%E7%88%B6%E6%AF%8D/</url>
    
    <content type="html"><![CDATA[<p>匿名用户</p><p>434 人赞同了该回答</p><p>好讨厌这样的自己，我也是有时候对着父母莫名其妙的控制不住情绪，知道父母很爱自己，但是聊着天就会加重语气，甚至因为很小的事情争吵，其实我觉得基本上每次都是我的错的，所以事后心里超后悔。</p><p>有次我生日，爸爸打电话跟我说：生日快乐，等下发个红包给你贺贺。</p><p>我一口就说不用了，不知道是出于什么心态，可能是想着能不向父母要钱就不要伸手拿钱（但是天知道我现在的一切都是父母给我的）</p><p>我爸爸一听，声音低下去了，他说：要的，你在外面读书过生日发个红包也是要有的。</p><p>然后我就开始控制不住自己的情绪，很急躁的回答：都说不用就不用了啦，没空了，我先挂了。</p><p>其实我觉得这个时候的我是个人渣，电话打通还不够30秒我就挂电话了，而且电话那头的人还是我爸爸在跟我说生日快乐。我一挂完电话我就开始懊恼，我为什么这么过分，明明是家人的一片心意却被我这样糟蹋，越想越后悔，我就赶紧回拨给爸爸，但是我觉得我是一个表面很冷但是内心有点感性的人（就像我对着父母说不出我爱你这几个字），所以我假装刚忙完再打电话回去给他的，然而电话正在通话中，我就想我肯定是伤到老爸的心了，所以我爸可能打电话给我大姐倾诉了（我爸爸对于我们姐妹对他的态度那些觉得有什么委屈或者烦恼的都会跟我大姐倾诉，比如经常打电话给手机调静音的我，由于经常没人接，所以很少打电话给我这些），</p><p>然后我再次回拨老爸电话时，通了，这个时候手机收到了几条信息，但是我没来得及看，就继续跟我爸说：不要发红包给我了，今天有同学已经发过红包给我了，你先把钱留着，我没钱用了再找你，</p><p>我爸坚持要发，说：这是心意，生日总要有生日的样子嘛，接受心意是种礼貌，</p><p>然后我就不想推脱了，说好吧，我爸就挂了电话急忙要发红包给我，</p><p>这时候我一打开手机看到了几个二姐发来的红包，我瞬间泪崩了，这时候我觉得我是个恶魔，因为我二姐是不记得我的生日的，每年都是我爸爸提醒她们才记得的，所以也就是说在我跟我爸通了第一通不够30秒的电话被我挂了电话的情况下，我爸爸接着打电话告诉我二姐我今天生日，不管我的语气多恶劣，爸爸好像完全忘记了我刚刚所做的那些过分的事情一样，还是继续付出着他对我的好，而我却这样子对待父母对女儿的心意，糟蹋了这些，我真的瞬间觉得用恶魔来形容我都是糟蹋了恶魔这个词了，</p><p>接着我爸爸跟我妈妈都发了一个红包给我，因为他们不会打字，但是还是一个字一个字地写了一大段祝福我的话发给我，好像希望最好的都可以加在我身上一样，那一刻我真的是无比懊悔，懊悔到想死，我是多人渣才能对父母的爱做出如此回应，我不知道我要做多少才能弥补我对父母的爱，但是我觉得我不能这样对待自己的父母，这样的我才是真正的恶魔。</p><p>我想改变，我想控制自己的情绪去对待生活中爱自己的每个人，愿他们开开心心健健康康地陪伴在自己身边。</p><p>知乎首答，忏悔和想改变。</p><p>以上来自知乎，如有侵权请联系站长</p>]]></content>
    
    
    
    <tags>
      
      <tag>情感诉讼</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>个人matter优化</title>
    <link href="/2021/01/03/%E4%B8%AA%E4%BA%BAmatter%E4%BC%98%E5%8C%96/"/>
    <url>/2021/01/03/%E4%B8%AA%E4%BA%BAmatter%E4%BC%98%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<p>hexo-theme-matery 是一个采用 Material Design 和响应式设计的 Hexo 博客主题，点击 这里 可以查看示例效果。点击 这里 下载 master 分支的最新稳定版的代码，解压缩后，将 hexo-theme-matery 的文件夹复制到 Hexo 的 themes 文件夹中即可。</p><p>切换主题<br>修改 Hexo 根目录下的 _config.yml 的 theme 的值：theme: hexo-theme-matery</p><p>_config.yml 文件的其它修改建议:<br>请修改 _config.yml 的 url 的值为你的网站主 URL（如：<a href="http://xxx.github.io)./">http://xxx.github.io）。</a><br>建议修改两个 per_page 的分页条数值为 6 的倍数，如：12、18 等，这样文章列表在各个屏幕下都能较好的显示。<br>如果是中文用户，则建议修改 language 的值为 zh-CN。<br>新建分类 categories 页<br>categories 页是用来展示所有分类的页面，如果 source 目录下还没有 categories/index.md 文件，那么就需要新建一个，命令如下：</p><p>hexo new page “categories”<br>1<br>编辑你刚刚新建的页面文件 /source/categories/index.md，至少需要以下内容：</p><hr><p>title: categories<br>date: 2018-09-30 17:25:30<br>type: “categories”<br>layout: “categories”</p><hr><p>1<br>2<br>3<br>4<br>5<br>6<br>新建标签 tags 页<br>tags 页是用来展示所有标签的页面，如果 source 目录下还没有 tags/index.md 文件，那么就需要新建一个，命令如下：</p><p>hexo new page “tags”<br>1<br>编辑刚刚新建的页面文件 /source/tags/index.md，至少需要以下内容：</p><hr><p>title: tags<br>date: 2018-09-30 18:23:38<br>type: “tags”<br>layout: “tags”</p><hr><p>1<br>2<br>3<br>4<br>5<br>6<br>新建关于我 about 页<br>about 页是用来展示关于我和我的博客信息的页面，如果 source 目录下还没有 about/index.md 文件，那么就需要新建一个，命令如下：</p><p>hexo new page “about”<br>1<br>编辑刚刚新建的页面文件 /source/about/index.md，至少需要以下内容：</p><hr><p>title: about<br>date: 2018-09-30 17:25:30<br>type: “about”<br>layout: “about”</p><hr><p>新建友情连接 friends 页（可选的）<br>friends 页是用来展示友情连接信息的页面，如果 source 目录下还没有 friends/index.md 文件，那么就需要新建一个，命令如下：</p><p>hexo new page “friends”<br>1<br>编辑刚刚新建的页面文件 /source/friends/index.md，至少需要以下内容：</p><hr><p>title: friends<br>date: 2018-12-12 21:25:30<br>type: “friends”<br>layout: “friends”</p><hr><p>同时，在 source 目录下新建 _data 目录，在 _data 目录中新建 friends.json 文件，文件内容如下所示：</p><p>[{<br>    “avatar”: “<a href="https://www.lixl.cn/medias/avatar.jpg&quot;">https://www.lixl.cn/medias/avatar.jpg&quot;</a>,<br>    “name”: “悟尘记”,<br>    “introduction”: “人生就是一场修行，上善若水，厚德载物。”,<br>    “url”: “<a href="https://www.lixl.cn/&quot;">https://www.lixl.cn/&quot;</a>,<br>    “title”: “前去参观”<br>}, {<br>    “avatar”: “<a href="https://wiki.hyperledger.org/download/attachments/2392069/fabric?version=1&amp;modificationDate=1540928132000&amp;api=v2&quot;">https://wiki.hyperledger.org/download/attachments/2392069/fabric?version=1&amp;modificationDate=1540928132000&amp;api=v2&quot;</a>,<br>    “name”: “Fabric”,<br>    “introduction”: “A Blockchain Platform for the Enterprise”,<br>    “url”: “<a href="https://hyperledger-fabric.readthedocs.io/en/master/&quot;">https://hyperledger-fabric.readthedocs.io/en/master/&quot;</a>,<br>    “title”: “前去学习”<br>}, {<br>    “avatar”: “<a href="https://www.bootcdn.cn/assets/img/maoyun.svg&quot;">https://www.bootcdn.cn/assets/img/maoyun.svg&quot;</a>,<br>    “name”: “BootCDN”,<br>    “introduction”: “稳定、快速、免费的前端开源项目 CDN 加速服务。”,<br>    “url”: “<a href="https://www.bootcdn.cn/&quot;">https://www.bootcdn.cn/&quot;</a>,<br>    “title”: “前去加速”<br>}]</p><p>代码高亮<br>由于 Hexo 自带的代码高亮主题显示不好看，所以主题中使用到了 hexo-prism-plugin 的 Hexo 插件来做代码高亮，安装命令如下：</p><p>npm i -S hexo-prism-plugin<br>1<br>然后，修改 Hexo 根目录下 _config.yml 文件中 highlight.enable 的值为 false，并新增 prism 插件相关的配置，主要配置如下：</p><p>highlight:<br>  enable: false</p><p>prism_plugin:<br>  mode: ‘preprocess’    # realtime/preprocess<br>  theme: ‘tomorrow’<br>  line_number: false    # default false<br>  custom_css:<br>搜索<br>本主题中还使用到了 hexo-generator-search 的 Hexo 插件来做内容搜索，安装命令如下：</p><p>npm install hexo-generator-search –save<br>1<br>在 Hexo 根目录下的 _config.yml 文件中，新增以下的配置项：</p><p>search:<br>  path: search.xml<br>  field: post<br>1<br>2<br>3<br>修改页脚<br>页脚信息可能需要做定制化修改，而且它不便于做成配置信息，所以可能需要你自己去再修改和加工。修改的地方在主题文件的 /layout/_partial/footer.ejs 文件中，包括站点、使用的主题、访问量等。</p><p>修改社交链接<br>在主题的 _config.yml 文件中，默认支持 QQ、GitHub 和邮箱的配置，可以在主题文件的 /layout/_partial/social-link.ejs 文件中，新增、修改需要的社交链接地址，增加链接可参考如下代码：</p><a href="https://github.com/blinkfox" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">    <i class="fa fa-github"></i></a>123其中，社交图标（如：fa-github）可以在 Font Awesome 中搜索找到。以下是常用社交图标的标识，供参考：<p>Facebook: fa-facebook<br>Twitter: fa-twitter<br>Google-plus: fa-google-plus<br>Linkedin: fa-linkedin<br>Tumblr: fa-tumblr<br>Medium: fa-medium<br>Slack: fa-slack<br>新浪微博: fa-weibo<br>微信: fa-wechat<br>QQ: fa-qq<br>修改打赏的二维码图片<br>在主题文件的 source/medias/reward 文件中，可以替换成你的的微信和支付宝的打赏二维码图片。</p><p>一键部署<br>通过 hexo-deployer-git 插件可以实现一键将博客同时部署到多个git仓库中。如同时发布到github及gitee提供的pages服务。安装：</p><p>npm install hexo-deployer-git –save<br>1<br>修改 Hexo 根目录下的 _config.yml 文件中的如下内容:</p><h2 id="Docs-https-hexo-io-docs-deployment-html"><a href="#Docs-https-hexo-io-docs-deployment-html" class="headerlink" title="Docs: https://hexo.io/docs/deployment.html"></a>Docs: <a href="https://hexo.io/docs/deployment.html">https://hexo.io/docs/deployment.html</a></h2><p>deploy:</p><ul><li>type: git<br>repo: <a href="https://github.com/lxl80/blog.git">https://github.com/lxl80/blog.git</a><br>branch: gh-pages<br>ignore_hidden: false</li><li>type: git<br>repo: <a href="https://gitee.com/lxl80/lxl80.git">https://gitee.com/lxl80/lxl80.git</a><br>branch: master<br>ignore_hidden: false<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>也可以如本站一样，采用 hexo-deployer-cos-enhanced 插件将静态内容部署到腾讯云对象存储服务中，在DNS配置中将境内线路解析到腾讯云CDN地址，实现加速。部署完成后会自动刷新被更新文件的CDN缓存。</li></ul><p>安装：</p><p>npm install hexo-deployer-cos-enhanced –save<br>1<br>_config.yml 配置如下:</p><p>deploy:</p><ul><li>type: git<br>repo: <a href="https://github.com/lxl80/blog.git">https://github.com/lxl80/blog.git</a><br>branch: gh-pages<br>ignore_hidden: false</li><li>type: cos<br>bucket: lxl80-130****<br>region: ap-beijing<br>secretId: AKIDh9**<strong>F8FvL<br>secretKey: Z3IGiur**</strong>QZR3PgjXmlVg<br>cdnConfig:<br>  enable: true<br>  cdnUrl: <a href="https://static.lixl.cn/">https://static.lixl.cn</a><br>  bucket: static-130****<br>  region: ap-beijing<br>  folder: static<br>  secretId: AKIDh9**<strong>F8FvL<br>  secretKey: Z3IGiur**</strong>QZR3PgjXmlVg<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>18<br>然后通过 hexo g -d 即可实现一键发布，并更新CDN缓存。</li></ul><p>文章链接转静态短地址（建议安装）<br>如果文章名称是中文的，那么 Hexo 默认生成的永久链接也会有中文，这样不利于 SEO，且 gitment 评论对中文链接也不支持。我们可以用 hexo-permalink-pinyin Hexo 插件生成文章时生成中文拼音的永久链接，或者用hexo-abbrlink 生成静态文章链接。以下结合hexo-abbrlink生成类似 /yyyy/mmdd+随机数.html 的文章链接地址。</p><p>安装命令如下：</p><p>npm install hexo-abbrlink –save<br>1<br>在 Hexo 根目录下的 _config.yml 文件中，修改 permalink: ，并在文件末尾新增 abbrlink:配置项：</p><p>permalink: :year/:month:day:abbrlink.html</p><p>abbrlink:<br>  alg: crc16 #算法选项：crc16丨crc32<br>  rep: dec #输出进制：dec为十进制，hex为十六进制<br>1<br>2<br>3<br>4<br>5<br>CND加速（建议启用）<br>放在Github的资源在国内加载速度比较慢，因此需要使用CDN加速来优化网站打开速度，jsDelivr + Github便是免费且好用的CDN，非常适合博客网站使用。也可以选择主流云服务商提供的对象存储+CDN来获得更快速及稳定的访问效果，费用低到几乎可忽略。</p><p>用法：</p><p><a href="https://cdn.jsdelivr.net/gh/%E4%BD%A0%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D/%E4%BD%A0%E7%9A%84%E4%BB%93%E5%BA%93%E5%90%8D@%E5%8F%91%E5%B8%83%E7%9A%84%E7%89%88%E6%9C%AC%E5%8F%B7/%E6%96%87%E4%BB%B6%E8%B7%AF%E5%BE%84">https://cdn.jsdelivr.net/gh/你的用户名/你的仓库名@发布的版本号/文件路径</a><br>1<br>例如：</p><p><a href="https://cdn.jsdelivr.net/gh/lxl80/blog@gh-pages/medias/banner/1.jpg">https://cdn.jsdelivr.net/gh/lxl80/blog@gh-pages/medias/banner/1.jpg</a><br>1<br>注意：版本号不是必需的，是为了区分新旧资源，如果不使用版本号，将会直接引用最新资源。</p><p>还可以配合 PicGo图床上传工具的自定义域名前缀来上传图片，使用极其方便。具体使用方法可参见我的另一篇文章: 使用Typora+iPic/PicGo图床+CDN实现高效Markdown创作</p><p>文章字数统计插件（可选的）<br>如果你想要在文章中显示文章字数、阅读时长信息，可以安装 hexo-wordcount插件。</p><p>安装命令如下：</p><p>npm i –save hexo-wordcount<br>1<br>然后只需在本主题下的 _config.yml 文件中，激活以下配置项即可：</p><p>wordCount:<br>  enable: false # 将这个值设置为 true 即可.<br>  postWordCount: true<br>  min2read: true<br>  totalCount: true<br>1<br>2<br>3<br>4<br>5<br>添加 RSS 订阅支持（可选的）<br>本主题中还使用到了 hexo-generator-feed 的 Hexo 插件来做 RSS，安装命令如下：</p><p>npm install hexo-generator-feed –save<br>1<br>在 Hexo 根目录下的 _config.yml 文件中，新增以下的配置项：</p><p>feed:<br>  type: atom<br>  path: atom.xml<br>  limit: 20<br>  hub:<br>  content:<br>  content_limit: 140<br>  content_limit_delim: ‘ ‘<br>  order_by: -date<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>执行 hexo clean &amp;&amp; hexo g 重新生成博客文件，然后在 public 文件夹中即可看到 atom.xml 文件，说明已经安装成功了。</p><p>自定制修改<br>在本主题的 _config.yml 中可以修改部分自定义信息，有以下几个部分：</p><p>菜单<br>我的梦想<br>首页的音乐播放器和视频播放器配置<br>是否显示推荐文章名称和按钮配置<br>favicon 和 Logo<br>个人信息<br>TOC 目录<br>文章打赏信息<br>复制文章内容时追加版权信息<br>MathJax<br>文章字数统计、阅读时长<br>点击页面的’爱心’效果<br>我的项目<br>我的技能<br>我的相册<br>Gitalk、Gitment、Valine 和 disqus 评论配置<br>不蒜子统计和谷歌分析（Google Analytics）<br>默认特色图的集合。当文章没有设置特色图时，本主题会根据文章标题的 hashcode 值取余，来选择展示对应的特色图<br>如果本主题中的诸多功能和主题色彩你不满意，可以在主题中自定义修改，很多更自由的功能和细节点的修改难以在主题的 _config.yml 中完成，需要修改源代码才来完成。以下列出了可能有用的地方：</p><p>修改主题颜色<br>在主题文件的 /source/css/matery.css 文件中，搜索 .bg-color 来修改背景颜色：</p><p>/* 整体背景颜色，包括导航、移动端的导航、页尾、标签页等的背景颜色. */<br>.bg-color {<br>    background-image: linear-gradient(to right, #4cbf30 0%, #0f9d58 100%);<br>}</p><p>@-webkit-keyframes rainbow {<br>   /* 动态切换背景颜色. */<br>}</p><p>@keyframes rainbow {<br>    /* 动态切换背景颜色. */<br>}<br>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>修改 banner 图和文章特色图<br>可以直接在 /source/medias/banner 文件夹中更换喜欢的 banner 图片，主题代码中是每天动态切换一张，只需 7 张即可。如果会 JavaScript 代码，可以修改成自己喜欢切换逻辑，如：随机切换等，banner 切换的代码位置在 /layout/_partial/bg-cover-content.ejs 文件的 <script></script> 代码中：</p><p>$(‘.bg-cover’).css(‘background-image’, ‘url(/medias/banner/‘ + new Date().getDay() + ‘.jpg)’);<br>1<br>在 /source/medias/featureimages 文件夹中默认有 24 张特色图片，你可以再增加或者减少，并需要在 _config.yml 做同步修改。</p><p>文章 Front-matter 介绍<br>Front-matter 选项详解<br>Front-matter 选项中的所有内容均为非必填的。但仍然建议至少填写 title 和 date 的值。</p><p>配置选项    默认值    描述<br>title    Markdown 的文件标题    文章标题，强烈建议填写此选项<br>date    文件创建时的日期时间    发布时间，强烈建议填写此选项，且最好保证全局唯一<br>author    根 _config.yml 中的 author    文章作者<br>img    featureImages 中的某个值    文章特征图<br>top    true    推荐文章（文章是否置顶），如果 top 值为 true，则会作为首页推荐文章<br>cover    false    表示该文章是否需要加入到首页轮播封面中<br>coverImg    无    表示该文章在首页轮播封面需要显示的图片路径，如果没有，则默认使用文章的特色图片<br>password    无    文章阅读密码，如果要对文章设置阅读验证密码的话，就可以设置 password 的值，该值必须是用 SHA256 加密后的密码，防止被他人识破。前提是在主题的 config.yml 中激活了 verifyPassword 选项<br>toc    true    是否开启 TOC，可以针对某篇文章单独关闭 TOC 的功能。前提是在主题的 config.yml 中激活了 toc 选项<br>mathjax    false    是否开启数学公式支持 ，本文章是否开启 mathjax，且需要在主题的 _config.yml 文件中也需要开启才行<br>summary    无    文章摘要，自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要<br>categories    无    文章分类，本主题的分类表示宏观上大的分类，只建议一篇文章一个分类<br>tags    无    文章标签，一篇文章可以多个标签<br>注意:</p><p>如果 img 属性不填写的话，文章特色图会根据文章标题的 hashcode 的值取余，然后选取主题中对应的特色图片，从而达到让所有文章都的特色图各有特色。<br>date 的值尽量保证每篇文章是唯一的，因为本主题中 Gitalk 和 Gitment 识别 id 是通过 date 的值来作为唯一标识的。<br>如果要对文章设置阅读验证密码的功能，不仅要在 Front-matter 中设置采用了 SHA256 加密的 password 的值，还需要在主题的 _config.yml 中激活了配置。有些在线的 SHA256 加密的地址，可供使用：开源中国在线工具、chahuo、站长工具。<br>以下为文章的 Front-matter 示例。</p><h2 id="最简示例"><a href="#最简示例" class="headerlink" title="最简示例"></a>最简示例</h2><p>title: 基于Hexo的hexo-theme-matery主题搭建博客并优化<br>date: 2019-10-03 14:25:00</p><hr><p>1<br>2<br>3<br>4<br>最全示例</p><hr><p>title: 基于Hexo的hexo-theme-matery主题搭建博客并优化<br>date: 2019-10-03 14:25:00<br>author: 悟尘<br>img: /source/images/xxx.jpg<br>top: true<br>cover: true<br>coverImg: /images/1.jpg<br>password: 8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92<br>toc: false<br>mathjax: false<br>summary: 这是你自定义的文章摘要内容，如果这个属性有值，文章卡片摘要就显示这段文字，否则程序会自动截取文章的部分内容作为摘要<br>categories: 工具<br>tags:</p><ul><li>blog</li><li>hexo</li></ul><hr><p>1<br>2<br>3<br>4<br>5<br>6<br>7<br>8<br>9<br>10<br>11<br>12<br>13<br>14<br>15<br>16<br>17<br>SEO优化<br>搜索引擎优化，又称为SEO，即Search Engine Optimization，它是一种通过分析搜索引擎的排名规律，了解各种搜索引擎怎样进行搜索、怎样抓取互联网页面、怎样确定特定关键词的搜索结果排名的技术。Google自动收录效果还不错，百度就差得远了（GitHub不允许百度的Spider爬取GitHub上的内容）。</p><p>百度优化<br>登录百度搜索资源平台， 登录成功之后在 用户中心 –&gt; 站点管理 页面中点击添加网站，按提示操作。</p><p>![](<a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGl4bC5jbi8yMDIwLzIwMjAwMTI5MjEzMzAyLnBuZy93MTI4MA?x-oss-process=image/format,png">https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGl4bC5jbi8yMDIwLzIwMjAwMTI5MjEzMzAyLnBuZy93MTI4MA?x-oss-process=image/format,png</a> =50)</p><p>提示：由于百度的spider是爬取不到GitHub的内容的，所以在第三步验证网站的时候，建议选择CNAME验证的方式。</p><p>经过以上步骤，百度已经知道有我们网站的存在了，但是百度还不知道我们的网站上有什么内容，所以要向百度推送我们的内容。hexo-theme-matery主题已经内置了 自动推送 的方式， 检查 themes/hexo-theme-matery/_config.yml 文件中如下配置:</p><h1 id="百度搜索资源平台提交链接"><a href="#百度搜索资源平台提交链接" class="headerlink" title="百度搜索资源平台提交链接"></a>百度搜索资源平台提交链接</h1><p>baiduPush: true<br>1<br>2<br>自动推送的JS代码部署在站点的每一个页面源代码中，当页面在每次被浏览时，链接就会被自动推送给百度。</p><p>谷歌优化<br>登录 Google Search Console，点击添加资源，输入自己的域名，按提示操作。</p><p>提示：需要进行DNS验证，进入DNS域名解析设置页面，按提示增加TXT记录，如下图:</p><p>验证成功后，需要提交站点地图。通过安装sitemap插件生成站点地图文件:</p><p>npm install hexo-generator-sitemap –save<br>npm install hexo-generator-baidu-sitemap –save  #百度专用，可选<br>1<br>2<br>安装后直接执行 hexo cl&amp;&amp;hexo g -d 命令，就会在网站根目录生成 sitemap.xml 文件。参照下图提交，等待收录。</p><p>注意：hexo配置文件中的url一定要输入正确的域名，插件是根据url生成站点地图的。</p><p>常用命令<br>指令说明<br>hexo server #启动本地服务器，用于预览主题。Hexo 会监视文件变动并自动更新，除修改站点配置文件外,无须重启服务器,直接刷新网页即可生效。</p><p>hexo server -s #以静态模式启动</p><p>hexo server -p 5000 #更改访问端口 (默认端口为4000，’ctrl + c’关闭server)</p><p>hexo server -i IP地址 #自定义 IP</p><p>hexo clean #清除缓存 ,网页正常情况下可以忽略此条命令,执行该指令后,会删掉站点根目录下的public文件夹</p><p>hexo g #生成静态网页 (执行 $ hexo g后会在站点根目录下生成public文件夹, hexo会将”/blog/source/“ 下面的.md后缀的文件编译为.html后缀的文件,存放在”/blog/public/ “ 路径下)</p><p>hexo d #自动生成网站静态文件，并将本地数据部署到设定的仓库(如github)</p><p>hexo init 文件夹名称 #初始化XX文件夹名称</p><p>npm update hexo -g#升级</p><p>npm install hexo -g #安装</p><p>node-v #查看node.js版本号</p><p>npm -v #查看npm版本号</p><p>git –version #查看git版本号</p><p>hexo -v #查看hexo版本号</p><p>简写指令<br>hexo n “我的第一篇文章” 等价于 hexo new “我的第一篇文章” 还等价于 hexo new post “我的第一篇文章”</p><p>hexo p 等价于 hexo publish</p><p>hexo g 等价于 hexo generate</p><p>hexo s等价于 hexo server</p><p>hexo d 等价于 hexo deploy</p><p>hexo g -d等价于hexo generate –deploy</p><p>注: hexo clean 没有 简写, git –version 没有简写</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>利用github搭建静态网站</title>
    <link href="/2021/01/02/%E5%88%A9%E7%94%A8github%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99/"/>
    <url>/2021/01/02/%E5%88%A9%E7%94%A8github%E6%90%AD%E5%BB%BA%E9%9D%99%E6%80%81%E7%BD%91%E7%AB%99/</url>
    
    <content type="html"><![CDATA[<p>1.nodejs，Git环境搭建：nodejs搭建教程:注意了，像Git这种服务器在国外的东西，它的官网下载这个软件会非常慢，建议直接在百度上搜索git下载与安装，各种软件园都能直接快速下载，留一下版本最好不要太旧就行。git搭建教程：补充参考文档（可能你会用到）：配置淘宝云<br>2.注册GitHub账号并创建仓库1. 注册就不用我说了，创建仓库视频里有，然后这个也很简单，不会就百度（应该没人去百度的，太简单了）2. 格式要求：xxx.github.io<br>3. 下面两个东西选其一我在里面没有演示，因为我早已经弄好了，你们看着弄。<br>4. 参考文档（可能用到）——GitHub的ssh密匙添加：<br>5. 参考文档（可能用到）——Gitee的ssh密匙添加：<br>3.快速利用hexo搭建博客：1. 脚本教程2. matery主题安装及优化matery主题官网：博客搭建完成我的博客工具自行下载vs code</p><p>另外检测 node hoxe 代码奉上<br>source install.sh test_node<br>如果出现了如图的情况证明环境变量是配置成功的<br>(出现了版本号和成功的提示信息代表配置成功)<br>source install.sh test_git<br> 一般情况下安装git工具后git环境是会自动配置的,可以无需检测git环境.此脚本可以用于linux系统,出现版本号信息则配置为成功.<br>source install.sh hexo_win<br> 提示:此时你可以去来一杯卡布奇诺,大约两分钟的时间,博客即可自动安装完成,如图:<br> 当您看到出现<code>Please run hexo s to check it out!</code>的提示,证明您已经安装成功,此时你可以运行hexo s 然后查看你的博客<br> cd hexoblog<br>hexo s<br>注意:要先cd到hexoblog目录哦!执行以上命令即可<br>可以看到出现了一段地址:<a href="http://localhost:4000/">http://localhost:4000</a><br>在浏览器访问:<a href="http://localhost:4000/">http://localhost:4000</a> ,你就可以在本地预览了<br>一键生成SSH秘钥<br>部署hexo博客的必要之物<br>git_ssh的使用<br>您需要在存放install.sh脚本的目录中,右键打开git bash运行以下命令:</p><p>./install.sh git_ssh<br>可以看到会有四条可执行命令,输入对应数字可以执行对应的命令<br>1)Key<br>2)SSH<br>3)Verify-github<br>4)Verify-coding<br>1)Key 执行1后可以一键生成秘钥<br>如果你的电脑已经存在秘钥,程序将会自动退出<br>2)SSH 执行2后可以查看你电脑中已生成的秘钥]<br>3)Verify-github 执行3后可以检查秘钥是否配置github成功<br>4)Verify-coding 执行4后可以检查秘钥是否配置coding成功<br>生成秘钥后别忘记将秘钥添加到账号里,否则秘钥不会配置成功</p><p>最后配置及部署<br>deploy:<br>  type: git<br>  repo: 这里填你的仓库地址,建议使用SSH地址,它是以git开头的<br>  branch: master<br>在1.3版本的[heox-script]后你无需自己安装上传插件,但如果报出了not found git的错误证明上传插件没有安装成功,你需要执行以下命令<br>cnpm install hexo-deployer-git –save<br>或者是npm install hexo-deployer-git –save<br>hexo g<br>就可以看到您的博客了最后关于博客主题问题<br>我会斟酌以后出一个优化教程<br>seaQQ：2021672898</p>]]></content>
    
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>����github���̬��վ</title>
    <link href="/2021/01/02/%E5%85%B3%E4%BA%8E%E7%88%B1%E4%B8%80%E4%B8%AA%E4%BA%BA/"/>
    <url>/2021/01/02/%E5%85%B3%E4%BA%8E%E7%88%B1%E4%B8%80%E4%B8%AA%E4%BA%BA/</url>
    
    <content type="html"><![CDATA[<p>��ȷʵ����Ҫ��ȥѧϰ�ģ�������������Ǽ���ʹ��ġ��ܶ�������Զѧ����ģ���Ϊ��ֻ������һ���������úܳ�����Ȼ��һ����������̣����������Լ��ܲ�������ࡣ</p><p>��Ҫѧ�ᰮ���ͱ���֪������ʲô�������������ҪѧӢ�ѧ����ѧС����һ���ģ����Ƕ�֪����Щ����ʲô���ӣ�ѧ������һ��ʲô���ĸ��</p><p>���ǰ����������������˵�����̫��������ˣ����һ���˲���֪������ʲô���������԰���������ȫ�������壬��ô����ν�İ����ˣ���νѧϰ��ô����Ҳ���Ǵ��ű��������ġ�</p><p>������Ҫѧ��ȥ������ô����Ҫ������Ϊ��׼��Ȼ���ð��ı�׼ȥ�������ǵ������ֹ��˼ά��ʽ��������Щ��Ϊ��˼ά���ǰ�Ӧ���еı��֣����Ǿ���Ҫȥ˼�������������Ҫ��Ҫ���������뷨Ҫ��Ҫ���ڡ�</p><p>����������У����ǻ������ܶ��ʹ������飬��ǡǡ�������������ѵ�ĥ���£����Ƕ�û�ж�ҡ�����ᶨ���԰��ı�׼Ҫ�����Լ������ǲſ���ѧ�ᰮ��</p><p>����һ����������һ��죬����Ҫͨ������˼����ѧϰ�Ķ�������ʵ˵������ĺܼ򵥣���������ѧ��Ӿ��ѧ����һ������������Ҫ����սʤ�Լ���һֱ����һ��Ŀ�겻����ǰ�����ܿ˷����Ѻ�����Ĺ��̡�</p><p>����Ȼ��һ�����������벻�������ǿ����Լ����ҿ��ģ����밮�㣬�Ҳ����ģ��Ҳ��밮�㣬��Ư���Ұ��㣬�㲻Ư����Ҳ���԰��㡣�Ҷ�֪����һ˵���㲻Ư����Ҳ���԰��㣬���Ͼͻ������룺�⻰���Ƿ�ƨ��</p><p>�ҿ���ȥ��һ����Ư����Ů�ˣ��ҿ��ܲ��������һ��Ҫ���ף�Ҫ��������Ϊ�Ҳ�ϲ��������Ϊ�Ҷ������ҿ��԰�������Ҳ���Լ���</p>]]></content>
    
    
    
    <tags>
      
      <tag>��</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2020/12/20/hello-world/"/>
    <url>/2020/12/20/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
